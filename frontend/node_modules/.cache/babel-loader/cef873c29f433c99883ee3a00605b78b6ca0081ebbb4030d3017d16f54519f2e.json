{"ast":null,"code":"// frontend/src/index.js\nimport React,{useEffect}from'react';import ReactDOM from'react-dom/client';import{BrowserRouter,useNavigate}from'react-router-dom';import{App as CapacitorApp}from'@capacitor/app';import App from'./App';import'./index.css';// === إضافة الـ CSS للـ Toast مرة واحدة فقط ===\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const injectToastStyles=()=>{if(document.getElementById('toast-styles'))return;const style=document.createElement('style');style.id='toast-styles';style.textContent=\"\\n    @keyframes toastFade {\\n      0%, 100% { opacity: 0; transform: translateX(-50%) translateY(10px); }\\n      15%, 85% { opacity: 1; transform: translateX(-50%) translateY(0); }\\n    }\\n  \";document.head.appendChild(style);};injectToastStyles();// === دالة عرض Toast (نظيفة وآمنة) ===\nconst showToast=message=>{// إزالة أي Toast قديم\nconst oldToast=document.getElementById('app-toast');if(oldToast)oldToast.remove();const toast=document.createElement('div');toast.id='app-toast';toast.textContent=message;toast.style.cssText=\"\\n    position: fixed;\\n    bottom: 60px;\\n    left: 50%;\\n    transform: translateX(-50%);\\n    background: rgba(0, 0, 0, 0.85);\\n    color: white;\\n    padding: 12px 24px;\\n    border-radius: 8px;\\n    font-size: 14px;\\n    z-index: 10000;\\n    animation: toastFade 2s ease-in-out forwards;\\n    pointer-events: none;\\n  \";document.body.appendChild(toast);// إزالة بعد 2 ثانية\nsetTimeout(()=>{if(toast.parentNode){toast.style.opacity='0';setTimeout(()=>toast.remove(),300);}},2000);};// === مكون التحكم في زر الـ Back ===\nconst BackButtonHandler=()=>{const navigate=useNavigate();useEffect(()=>{let lastBackPress=0;let backListener=null;const handleBackButton=async()=>{try{var _CapacitorApp$canGoBa;const canGoBack=await((_CapacitorApp$canGoBa=CapacitorApp.canGoBack)===null||_CapacitorApp$canGoBa===void 0?void 0:_CapacitorApp$canGoBa.call(CapacitorApp));const currentPath=window.location.pathname;// لو في الصفحة الرئيسية أو تسجيل الدخول → خروج بضغطتين\nif(['/','/login'].includes(currentPath)){const now=Date.now();if(now-lastBackPress<2000){CapacitorApp.exitApp();}else{lastBackPress=now;showToast('اضغط مرة أخرى للخروج');}return;}// لو فيه تاريخ → ارجع خطوة واحدة\nif(canGoBack){navigate(-1);}else{// لو مفيش تاريخ (نادر) → ارجع للرئيسية\nnavigate('/',{replace:true});}}catch(error){console.warn('Back button error:',error);// في حالة فشل → ارجع يدويًا\nnavigate(-1);}};// إضافة الـ listener\nCapacitorApp.addListener('backButton',handleBackButton).then(listener=>{backListener=listener;});// تنظيف\nreturn()=>{var _backListener;(_backListener=backListener)===null||_backListener===void 0?void 0:_backListener.remove();};},[navigate]);return null;};// === رندر التطبيق ===\nconst root=ReactDOM.createRoot(document.getElementById('root'));root.render(/*#__PURE__*/_jsx(React.StrictMode,{children:/*#__PURE__*/_jsxs(BrowserRouter,{children:[/*#__PURE__*/_jsx(BackButtonHandler,{}),/*#__PURE__*/_jsx(App,{})]})}));","map":{"version":3,"names":["React","useEffect","ReactDOM","BrowserRouter","useNavigate","App","CapacitorApp","jsx","_jsx","jsxs","_jsxs","injectToastStyles","document","getElementById","style","createElement","id","textContent","head","appendChild","showToast","message","oldToast","remove","toast","cssText","body","setTimeout","parentNode","opacity","BackButtonHandler","navigate","lastBackPress","backListener","handleBackButton","_CapacitorApp$canGoBa","canGoBack","call","currentPath","window","location","pathname","includes","now","Date","exitApp","replace","error","console","warn","addListener","then","listener","_backListener","root","createRoot","render","StrictMode","children"],"sources":["/root/shose/shoose-1/frontend/src/index.js"],"sourcesContent":["// frontend/src/index.js\nimport React, { useEffect } from 'react';\nimport ReactDOM from 'react-dom/client';\nimport { BrowserRouter, useNavigate } from 'react-router-dom';\nimport { App as CapacitorApp } from '@capacitor/app';\nimport App from './App';\nimport './index.css';\n\n// === إضافة الـ CSS للـ Toast مرة واحدة فقط ===\nconst injectToastStyles = () => {\n  if (document.getElementById('toast-styles')) return;\n\n  const style = document.createElement('style');\n  style.id = 'toast-styles';\n  style.textContent = `\n    @keyframes toastFade {\n      0%, 100% { opacity: 0; transform: translateX(-50%) translateY(10px); }\n      15%, 85% { opacity: 1; transform: translateX(-50%) translateY(0); }\n    }\n  `;\n  document.head.appendChild(style);\n};\ninjectToastStyles();\n\n// === دالة عرض Toast (نظيفة وآمنة) ===\nconst showToast = (message) => {\n  // إزالة أي Toast قديم\n  const oldToast = document.getElementById('app-toast');\n  if (oldToast) oldToast.remove();\n\n  const toast = document.createElement('div');\n  toast.id = 'app-toast';\n  toast.textContent = message;\n  toast.style.cssText = `\n    position: fixed;\n    bottom: 60px;\n    left: 50%;\n    transform: translateX(-50%);\n    background: rgba(0, 0, 0, 0.85);\n    color: white;\n    padding: 12px 24px;\n    border-radius: 8px;\n    font-size: 14px;\n    z-index: 10000;\n    animation: toastFade 2s ease-in-out forwards;\n    pointer-events: none;\n  `;\n  document.body.appendChild(toast);\n\n  // إزالة بعد 2 ثانية\n  setTimeout(() => {\n    if (toast.parentNode) {\n      toast.style.opacity = '0';\n      setTimeout(() => toast.remove(), 300);\n    }\n  }, 2000);\n};\n\n// === مكون التحكم في زر الـ Back ===\nconst BackButtonHandler = () => {\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    let lastBackPress = 0;\n    let backListener = null;\n\n    const handleBackButton = async () => {\n      try {\n        const canGoBack = await CapacitorApp.canGoBack?.();\n        const currentPath = window.location.pathname;\n\n        // لو في الصفحة الرئيسية أو تسجيل الدخول → خروج بضغطتين\n        if (['/', '/login'].includes(currentPath)) {\n          const now = Date.now();\n          if (now - lastBackPress < 2000) {\n            CapacitorApp.exitApp();\n          } else {\n            lastBackPress = now;\n            showToast('اضغط مرة أخرى للخروج');\n          }\n          return;\n        }\n\n        // لو فيه تاريخ → ارجع خطوة واحدة\n        if (canGoBack) {\n          navigate(-1);\n        } else {\n          // لو مفيش تاريخ (نادر) → ارجع للرئيسية\n          navigate('/', { replace: true });\n        }\n      } catch (error) {\n        console.warn('Back button error:', error);\n        // في حالة فشل → ارجع يدويًا\n        navigate(-1);\n      }\n    };\n\n    // إضافة الـ listener\n    CapacitorApp.addListener('backButton', handleBackButton).then((listener) => {\n      backListener = listener;\n    });\n\n    // تنظيف\n    return () => {\n      backListener?.remove();\n    };\n  }, [navigate]);\n\n  return null;\n};\n\n// === رندر التطبيق ===\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <React.StrictMode>\n    <BrowserRouter>\n      <BackButtonHandler />\n      <App />\n    </BrowserRouter>\n  </React.StrictMode>\n);\n"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,SAAS,KAAQ,OAAO,CACxC,MAAO,CAAAC,QAAQ,KAAM,kBAAkB,CACvC,OAASC,aAAa,CAAEC,WAAW,KAAQ,kBAAkB,CAC7D,OAASC,GAAG,GAAI,CAAAC,YAAY,KAAQ,gBAAgB,CACpD,MAAO,CAAAD,GAAG,KAAM,OAAO,CACvB,MAAO,aAAa,CAEpB;AAAA,OAAAE,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBACA,KAAM,CAAAC,iBAAiB,CAAGA,CAAA,GAAM,CAC9B,GAAIC,QAAQ,CAACC,cAAc,CAAC,cAAc,CAAC,CAAE,OAE7C,KAAM,CAAAC,KAAK,CAAGF,QAAQ,CAACG,aAAa,CAAC,OAAO,CAAC,CAC7CD,KAAK,CAACE,EAAE,CAAG,cAAc,CACzBF,KAAK,CAACG,WAAW,mMAKhB,CACDL,QAAQ,CAACM,IAAI,CAACC,WAAW,CAACL,KAAK,CAAC,CAClC,CAAC,CACDH,iBAAiB,CAAC,CAAC,CAEnB;AACA,KAAM,CAAAS,SAAS,CAAIC,OAAO,EAAK,CAC7B;AACA,KAAM,CAAAC,QAAQ,CAAGV,QAAQ,CAACC,cAAc,CAAC,WAAW,CAAC,CACrD,GAAIS,QAAQ,CAAEA,QAAQ,CAACC,MAAM,CAAC,CAAC,CAE/B,KAAM,CAAAC,KAAK,CAAGZ,QAAQ,CAACG,aAAa,CAAC,KAAK,CAAC,CAC3CS,KAAK,CAACR,EAAE,CAAG,WAAW,CACtBQ,KAAK,CAACP,WAAW,CAAGI,OAAO,CAC3BG,KAAK,CAACV,KAAK,CAACW,OAAO,sUAalB,CACDb,QAAQ,CAACc,IAAI,CAACP,WAAW,CAACK,KAAK,CAAC,CAEhC;AACAG,UAAU,CAAC,IAAM,CACf,GAAIH,KAAK,CAACI,UAAU,CAAE,CACpBJ,KAAK,CAACV,KAAK,CAACe,OAAO,CAAG,GAAG,CACzBF,UAAU,CAAC,IAAMH,KAAK,CAACD,MAAM,CAAC,CAAC,CAAE,GAAG,CAAC,CACvC,CACF,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,CAED;AACA,KAAM,CAAAO,iBAAiB,CAAGA,CAAA,GAAM,CAC9B,KAAM,CAAAC,QAAQ,CAAG3B,WAAW,CAAC,CAAC,CAE9BH,SAAS,CAAC,IAAM,CACd,GAAI,CAAA+B,aAAa,CAAG,CAAC,CACrB,GAAI,CAAAC,YAAY,CAAG,IAAI,CAEvB,KAAM,CAAAC,gBAAgB,CAAG,KAAAA,CAAA,GAAY,CACnC,GAAI,KAAAC,qBAAA,CACF,KAAM,CAAAC,SAAS,CAAG,OAAAD,qBAAA,CAAM7B,YAAY,CAAC8B,SAAS,UAAAD,qBAAA,iBAAtBA,qBAAA,CAAAE,IAAA,CAAA/B,YAAyB,CAAC,EAClD,KAAM,CAAAgC,WAAW,CAAGC,MAAM,CAACC,QAAQ,CAACC,QAAQ,CAE5C;AACA,GAAI,CAAC,GAAG,CAAE,QAAQ,CAAC,CAACC,QAAQ,CAACJ,WAAW,CAAC,CAAE,CACzC,KAAM,CAAAK,GAAG,CAAGC,IAAI,CAACD,GAAG,CAAC,CAAC,CACtB,GAAIA,GAAG,CAAGX,aAAa,CAAG,IAAI,CAAE,CAC9B1B,YAAY,CAACuC,OAAO,CAAC,CAAC,CACxB,CAAC,IAAM,CACLb,aAAa,CAAGW,GAAG,CACnBvB,SAAS,CAAC,sBAAsB,CAAC,CACnC,CACA,OACF,CAEA;AACA,GAAIgB,SAAS,CAAE,CACbL,QAAQ,CAAC,CAAC,CAAC,CAAC,CACd,CAAC,IAAM,CACL;AACAA,QAAQ,CAAC,GAAG,CAAE,CAAEe,OAAO,CAAE,IAAK,CAAC,CAAC,CAClC,CACF,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACC,IAAI,CAAC,oBAAoB,CAAEF,KAAK,CAAC,CACzC;AACAhB,QAAQ,CAAC,CAAC,CAAC,CAAC,CACd,CACF,CAAC,CAED;AACAzB,YAAY,CAAC4C,WAAW,CAAC,YAAY,CAAEhB,gBAAgB,CAAC,CAACiB,IAAI,CAAEC,QAAQ,EAAK,CAC1EnB,YAAY,CAAGmB,QAAQ,CACzB,CAAC,CAAC,CAEF;AACA,MAAO,IAAM,KAAAC,aAAA,CACX,CAAAA,aAAA,CAAApB,YAAY,UAAAoB,aAAA,iBAAZA,aAAA,CAAc9B,MAAM,CAAC,CAAC,CACxB,CAAC,CACH,CAAC,CAAE,CAACQ,QAAQ,CAAC,CAAC,CAEd,MAAO,KAAI,CACb,CAAC,CAED;AACA,KAAM,CAAAuB,IAAI,CAAGpD,QAAQ,CAACqD,UAAU,CAAC3C,QAAQ,CAACC,cAAc,CAAC,MAAM,CAAC,CAAC,CACjEyC,IAAI,CAACE,MAAM,cACThD,IAAA,CAACR,KAAK,CAACyD,UAAU,EAAAC,QAAA,cACfhD,KAAA,CAACP,aAAa,EAAAuD,QAAA,eACZlD,IAAA,CAACsB,iBAAiB,GAAE,CAAC,cACrBtB,IAAA,CAACH,GAAG,GAAE,CAAC,EACM,CAAC,CACA,CACpB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}