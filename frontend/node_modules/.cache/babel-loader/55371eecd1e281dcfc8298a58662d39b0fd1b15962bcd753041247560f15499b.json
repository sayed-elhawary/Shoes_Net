{"ast":null,"code":"// frontend/src/App.js\nimport{Routes,Route}from'react-router-dom';import Home from'./pages/Home';import VendorDashboard from'./pages/VendorDashboard';import AdminDashboard from'./pages/AdminDashboard';import Orders from'./pages/Orders';import CreateVendor from'./pages/CreateVendor';import CreateCustomer from'./pages/CreateCustomer';import BlockCustomer from'./pages/BlockCustomer';import Login from'./pages/Login';import VendorProducts from'./pages/VendorProducts';import Vendors from'./pages/Vendors';import Navbar from'./components/Navbar';import PendingCustomers from'./pages/PendingCustomers';import{useState,useEffect}from'react';import{getAuthData,isLoggedIn,clearAuthData}from'./services/authService';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||'http://localhost:5000';function App(){const[isAuthenticated,setIsAuthenticated]=useState(false);const[loading,setLoading]=useState(true);const attemptAutoLogin=async()=>{try{const loggedIn=await isLoggedIn();if(!loggedIn)throw new Error('No saved login');const auth=await getAuthData();// استعادة localStorage (للويب)\nlocalStorage.setItem('token',auth.token);localStorage.setItem('role',auth.role);localStorage.setItem('userId',auth.userId);// اختبار صلاحية التوكن (اختياري لكن موصى)\naxios.defaults.headers.common['Authorization']=\"Bearer \".concat(auth.token);// افترض إن عندك endpoint للتحقق\n// await axios.get(`${API_URL}/api/auth/me`);\nsetIsAuthenticated(true);}catch(err){await clearAuthData();localStorage.clear();}finally{setLoading(false);}};useEffect(()=>{attemptAutoLogin();const handleAuthChange=()=>{setIsAuthenticated(!!localStorage.getItem('token'));};window.addEventListener('authChange',handleAuthChange);window.addEventListener('storage',handleAuthChange);return()=>{window.removeEventListener('authChange',handleAuthChange);window.removeEventListener('storage',handleAuthChange);};},[]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-[#18191a]\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-white text-xl font-bold\",children:\"\\u062C\\u0627\\u0631\\u064A \\u0627\\u0644\\u062A\\u062D\\u0645\\u064A\\u0644...\"})});}return/*#__PURE__*/_jsxs(_Fragment,{children:[isAuthenticated&&/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"/vendor\",element:/*#__PURE__*/_jsx(VendorDashboard,{})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:/*#__PURE__*/_jsx(AdminDashboard,{})}),/*#__PURE__*/_jsx(Route,{path:\"/orders\",element:/*#__PURE__*/_jsx(Orders,{})}),/*#__PURE__*/_jsx(Route,{path:\"/create-vendor\",element:/*#__PURE__*/_jsx(CreateVendor,{})}),/*#__PURE__*/_jsx(Route,{path:\"/create-customer\",element:/*#__PURE__*/_jsx(CreateCustomer,{})}),/*#__PURE__*/_jsx(Route,{path:\"/block-customer\",element:/*#__PURE__*/_jsx(BlockCustomer,{})}),/*#__PURE__*/_jsx(Route,{path:\"/vendors\",element:/*#__PURE__*/_jsx(Vendors,{})}),/*#__PURE__*/_jsx(Route,{path:\"/vendors/:vendorId/products\",element:/*#__PURE__*/_jsx(VendorProducts,{})}),/*#__PURE__*/_jsx(Route,{path:\"/admin/pending-customers\",element:/*#__PURE__*/_jsx(PendingCustomers,{})})]})]});}export default App;","map":{"version":3,"names":["Routes","Route","Home","VendorDashboard","AdminDashboard","Orders","CreateVendor","CreateCustomer","BlockCustomer","Login","VendorProducts","Vendors","Navbar","PendingCustomers","useState","useEffect","getAuthData","isLoggedIn","clearAuthData","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","API_URL","process","env","REACT_APP_API_URL","App","isAuthenticated","setIsAuthenticated","loading","setLoading","attemptAutoLogin","loggedIn","Error","auth","localStorage","setItem","token","role","userId","defaults","headers","common","concat","err","clear","handleAuthChange","getItem","window","addEventListener","removeEventListener","className","children","path","element"],"sources":["/root/shose/app-shose/frontend/src/App.js"],"sourcesContent":["// frontend/src/App.js\nimport { Routes, Route } from 'react-router-dom';\nimport Home from './pages/Home';\nimport VendorDashboard from './pages/VendorDashboard';\nimport AdminDashboard from './pages/AdminDashboard';\nimport Orders from './pages/Orders';\nimport CreateVendor from './pages/CreateVendor';\nimport CreateCustomer from './pages/CreateCustomer';\nimport BlockCustomer from './pages/BlockCustomer';\nimport Login from './pages/Login';\nimport VendorProducts from './pages/VendorProducts';\nimport Vendors from './pages/Vendors';\nimport Navbar from './components/Navbar';\nimport PendingCustomers from './pages/PendingCustomers';\nimport { useState, useEffect } from 'react';\nimport { getAuthData, isLoggedIn, clearAuthData } from './services/authService';\nimport axios from 'axios';\n\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000';\n\nfunction App() {\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  const attemptAutoLogin = async () => {\n    try {\n      const loggedIn = await isLoggedIn();\n      if (!loggedIn) throw new Error('No saved login');\n\n      const auth = await getAuthData();\n\n      // استعادة localStorage (للويب)\n      localStorage.setItem('token', auth.token);\n      localStorage.setItem('role', auth.role);\n      localStorage.setItem('userId', auth.userId);\n\n      // اختبار صلاحية التوكن (اختياري لكن موصى)\n      axios.defaults.headers.common['Authorization'] = `Bearer ${auth.token}`;\n      // افترض إن عندك endpoint للتحقق\n      // await axios.get(`${API_URL}/api/auth/me`);\n\n      setIsAuthenticated(true);\n    } catch (err) {\n      await clearAuthData();\n      localStorage.clear();\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    attemptAutoLogin();\n\n    const handleAuthChange = () => {\n      setIsAuthenticated(!!localStorage.getItem('token'));\n    };\n\n    window.addEventListener('authChange', handleAuthChange);\n    window.addEventListener('storage', handleAuthChange);\n\n    return () => {\n      window.removeEventListener('authChange', handleAuthChange);\n      window.removeEventListener('storage', handleAuthChange);\n    };\n  }, []);\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-[#18191a]\">\n        <div className=\"text-white text-xl font-bold\">جاري التحميل...</div>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      {isAuthenticated && <Navbar />}\n      <Routes>\n        <Route path=\"/\" element={<Home />} />\n        <Route path=\"/login\" element={<Login />} />\n        <Route path=\"/vendor\" element={<VendorDashboard />} />\n        <Route path=\"/admin\" element={<AdminDashboard />} />\n        <Route path=\"/orders\" element={<Orders />} />\n        <Route path=\"/create-vendor\" element={<CreateVendor />} />\n        <Route path=\"/create-customer\" element={<CreateCustomer />} />\n        <Route path=\"/block-customer\" element={<BlockCustomer />} />\n        <Route path=\"/vendors\" element={<Vendors />} />\n        <Route path=\"/vendors/:vendorId/products\" element={<VendorProducts />} />\n        <Route path=\"/admin/pending-customers\" element={<PendingCustomers />} />\n      </Routes>\n    </>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}