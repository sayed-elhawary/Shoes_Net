{"ast":null,"code":"// frontend/src/pages/PendingCustomers.js\nimport React,{useState,useEffect}from'react';import{motion}from'framer-motion';import axios from'axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PendingCustomers=()=>{const[pending,setPending]=useState([]);const[loading,setLoading]=useState(true);const navigate=useNavigate();useEffect(()=>{const token=localStorage.getItem('token');const role=localStorage.getItem('role');if(!token||role!=='admin'){navigate('/login');return;}fetchPending();},[navigate]);const fetchPending=async()=>{try{const res=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/auth/pending-customers\"),{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});setPending(res.data);}catch(err){console.error(err);}finally{setLoading(false);}};const approve=async phone=>{try{await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/auth/approve-customer\"),{phone},{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});setPending(pending.filter(c=>c.phone!==phone));}catch(err){var _err$response,_err$response$data;alert(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'فشل');}};const reject=async phone=>{if(!window.confirm('هل تريد رفض هذا الطلب؟'))return;try{await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/auth/reject-customer\"),{phone},{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});setPending(pending.filter(c=>c.phone!==phone));}catch(err){var _err$response2,_err$response2$data;alert(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||'فشل');}};if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"text-center p-8 text-white\",children:\"\\u062C\\u0627\\u0631\\u064D \\u0627\\u0644\\u062A\\u062D\\u0645\\u064A\\u0644...\"});return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-[#18191a] text-white p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsx(motion.h1,{className:\"text-3xl font-bold text-center mb-8 text-red-400\",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:\"\\u0637\\u0644\\u0628\\u0627\\u062A \\u0627\\u0644\\u062A\\u0633\\u062C\\u064A\\u0644 \\u0627\\u0644\\u0645\\u0639\\u0644\\u0642\\u0629\"}),pending.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-400\",children:\"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u0637\\u0644\\u0628\\u0627\\u062A \\u0645\\u0639\\u0644\\u0642\\u0629\"}):/*#__PURE__*/_jsx(\"div\",{className:\"grid gap-4\",children:pending.map(customer=>/*#__PURE__*/_jsxs(motion.div,{className:\"bg-[#242526] p-6 rounded-xl border border-gray-700 flex justify-between items-center\",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-semibold\",children:customer.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400\",children:customer.phone}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500\",children:[\"\\u062A\\u0627\\u0631\\u064A\\u062E \\u0627\\u0644\\u0637\\u0644\\u0628: \",new Date(customer.createdAt).toLocaleString('ar-EG')]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>approve(customer.phone),className:\"px-4 py-2 bg-green-600 rounded-lg hover:bg-green-700 transition text-sm font-medium\",children:\"\\u0645\\u0648\\u0627\\u0641\\u0642\\u0629\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>reject(customer.phone),className:\"px-4 py-2 bg-red-600 rounded-lg hover:bg-red-700 transition text-sm font-medium\",children:\"\\u0631\\u0641\\u0636\"})]})]},customer._id))})]})});};export default PendingCustomers;","map":{"version":3,"names":["React","useState","useEffect","motion","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","PendingCustomers","pending","setPending","loading","setLoading","navigate","token","localStorage","getItem","role","fetchPending","res","get","concat","process","env","REACT_APP_API_URL","headers","Authorization","data","err","console","error","approve","phone","post","filter","c","_err$response","_err$response$data","alert","response","message","reject","window","confirm","_err$response2","_err$response2$data","className","children","h1","initial","opacity","y","animate","length","map","customer","div","x","exit","name","Date","createdAt","toLocaleString","onClick","_id"],"sources":["/root/shose/app-shose/frontend/src/pages/PendingCustomers.js"],"sourcesContent":["// frontend/src/pages/PendingCustomers.js\nimport React, { useState, useEffect } from 'react';\nimport { motion } from 'framer-motion';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\n\nconst PendingCustomers = () => {\n  const [pending, setPending] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    const role = localStorage.getItem('role');\n    if (!token || role !== 'admin') {\n      navigate('/login');\n      return;\n    }\n    fetchPending();\n  }, [navigate]);\n\n  const fetchPending = async () => {\n    try {\n      const res = await axios.get(`${process.env.REACT_APP_API_URL}/api/auth/pending-customers`, {\n        headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }\n      });\n      setPending(res.data);\n    } catch (err) {\n      console.error(err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const approve = async (phone) => {\n    try {\n      await axios.post(`${process.env.REACT_APP_API_URL}/api/auth/approve-customer`, { phone }, {\n        headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }\n      });\n      setPending(pending.filter(c => c.phone !== phone));\n    } catch (err) {\n      alert(err.response?.data?.message || 'فشل');\n    }\n  };\n\n  const reject = async (phone) => {\n    if (!window.confirm('هل تريد رفض هذا الطلب؟')) return;\n    try {\n      await axios.post(`${process.env.REACT_APP_API_URL}/api/auth/reject-customer`, { phone }, {\n        headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }\n      });\n      setPending(pending.filter(c => c.phone !== phone));\n    } catch (err) {\n      alert(err.response?.data?.message || 'فشل');\n    }\n  };\n\n  if (loading) return <div className=\"text-center p-8 text-white\">جارٍ التحميل...</div>;\n\n  return (\n    <div className=\"min-h-screen bg-[#18191a] text-white p-6\">\n      <div className=\"max-w-4xl mx-auto\">\n        <motion.h1\n          className=\"text-3xl font-bold text-center mb-8 text-red-400\"\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n        >\n          طلبات التسجيل المعلقة\n        </motion.h1>\n\n        {pending.length === 0 ? (\n          <p className=\"text-center text-gray-400\">لا توجد طلبات معلقة</p>\n        ) : (\n          <div className=\"grid gap-4\">\n            {pending.map((customer) => (\n              <motion.div\n                key={customer._id}\n                className=\"bg-[#242526] p-6 rounded-xl border border-gray-700 flex justify-between items-center\"\n                initial={{ opacity: 0, x: -20 }}\n                animate={{ opacity: 1, x: 0 }}\n                exit={{ opacity: 0, x: 20 }}\n              >\n                <div>\n                  <p className=\"text-lg font-semibold\">{customer.name}</p>\n                  <p className=\"text-sm text-gray-400\">{customer.phone}</p>\n                  <p className=\"text-xs text-gray-500\">تاريخ الطلب: {new Date(customer.createdAt).toLocaleString('ar-EG')}</p>\n                </div>\n                <div className=\"flex gap-2\">\n                  <button\n                    onClick={() => approve(customer.phone)}\n                    className=\"px-4 py-2 bg-green-600 rounded-lg hover:bg-green-700 transition text-sm font-medium\"\n                  >\n                    موافقة\n                  </button>\n                  <button\n                    onClick={() => reject(customer.phone)}\n                    className=\"px-4 py-2 bg-red-600 rounded-lg hover:bg-red-700 transition text-sm font-medium\"\n                  >\n                    رفض\n                  </button>\n                </div>\n              </motion.div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default PendingCustomers;\n"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,MAAM,KAAQ,eAAe,CACtC,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,WAAW,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE/C,KAAM,CAAAC,gBAAgB,CAAGA,CAAA,GAAM,CAC7B,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGX,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACY,OAAO,CAAEC,UAAU,CAAC,CAAGb,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAAAc,QAAQ,CAAGV,WAAW,CAAC,CAAC,CAE9BH,SAAS,CAAC,IAAM,CACd,KAAM,CAAAc,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,KAAM,CAAAC,IAAI,CAAGF,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CACzC,GAAI,CAACF,KAAK,EAAIG,IAAI,GAAK,OAAO,CAAE,CAC9BJ,QAAQ,CAAC,QAAQ,CAAC,CAClB,OACF,CACAK,YAAY,CAAC,CAAC,CAChB,CAAC,CAAE,CAACL,QAAQ,CAAC,CAAC,CAEd,KAAM,CAAAK,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAjB,KAAK,CAACkB,GAAG,IAAAC,MAAA,CAAIC,OAAO,CAACC,GAAG,CAACC,iBAAiB,gCAA+B,CACzFC,OAAO,CAAE,CAAEC,aAAa,WAAAL,MAAA,CAAYN,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAG,CACtE,CAAC,CAAC,CACFN,UAAU,CAACS,GAAG,CAACQ,IAAI,CAAC,CACtB,CAAE,MAAOC,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC,CACpB,CAAC,OAAS,CACRhB,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAAmB,OAAO,CAAG,KAAO,CAAAC,KAAK,EAAK,CAC/B,GAAI,CACF,KAAM,CAAA9B,KAAK,CAAC+B,IAAI,IAAAZ,MAAA,CAAIC,OAAO,CAACC,GAAG,CAACC,iBAAiB,+BAA8B,CAAEQ,KAAM,CAAC,CAAE,CACxFP,OAAO,CAAE,CAAEC,aAAa,WAAAL,MAAA,CAAYN,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAG,CACtE,CAAC,CAAC,CACFN,UAAU,CAACD,OAAO,CAACyB,MAAM,CAACC,CAAC,EAAIA,CAAC,CAACH,KAAK,GAAKA,KAAK,CAAC,CAAC,CACpD,CAAE,MAAOJ,GAAG,CAAE,KAAAQ,aAAA,CAAAC,kBAAA,CACZC,KAAK,CAAC,EAAAF,aAAA,CAAAR,GAAG,CAACW,QAAQ,UAAAH,aAAA,kBAAAC,kBAAA,CAAZD,aAAA,CAAcT,IAAI,UAAAU,kBAAA,iBAAlBA,kBAAA,CAAoBG,OAAO,GAAI,KAAK,CAAC,CAC7C,CACF,CAAC,CAED,KAAM,CAAAC,MAAM,CAAG,KAAO,CAAAT,KAAK,EAAK,CAC9B,GAAI,CAACU,MAAM,CAACC,OAAO,CAAC,wBAAwB,CAAC,CAAE,OAC/C,GAAI,CACF,KAAM,CAAAzC,KAAK,CAAC+B,IAAI,IAAAZ,MAAA,CAAIC,OAAO,CAACC,GAAG,CAACC,iBAAiB,8BAA6B,CAAEQ,KAAM,CAAC,CAAE,CACvFP,OAAO,CAAE,CAAEC,aAAa,WAAAL,MAAA,CAAYN,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAG,CACtE,CAAC,CAAC,CACFN,UAAU,CAACD,OAAO,CAACyB,MAAM,CAACC,CAAC,EAAIA,CAAC,CAACH,KAAK,GAAKA,KAAK,CAAC,CAAC,CACpD,CAAE,MAAOJ,GAAG,CAAE,KAAAgB,cAAA,CAAAC,mBAAA,CACZP,KAAK,CAAC,EAAAM,cAAA,CAAAhB,GAAG,CAACW,QAAQ,UAAAK,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAcjB,IAAI,UAAAkB,mBAAA,iBAAlBA,mBAAA,CAAoBL,OAAO,GAAI,KAAK,CAAC,CAC7C,CACF,CAAC,CAED,GAAI7B,OAAO,CAAE,mBAAON,IAAA,QAAKyC,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,wEAAe,CAAK,CAAC,CAErF,mBACE1C,IAAA,QAAKyC,SAAS,CAAC,0CAA0C,CAAAC,QAAA,cACvDxC,KAAA,QAAKuC,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChC1C,IAAA,CAACJ,MAAM,CAAC+C,EAAE,EACRF,SAAS,CAAC,kDAAkD,CAC5DG,OAAO,CAAE,CAAEC,OAAO,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAC,EAAG,CAAE,CAChCC,OAAO,CAAE,CAAEF,OAAO,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAE,CAAE,CAAAJ,QAAA,CAC/B,sHAED,CAAW,CAAC,CAEXtC,OAAO,CAAC4C,MAAM,GAAK,CAAC,cACnBhD,IAAA,MAAGyC,SAAS,CAAC,2BAA2B,CAAAC,QAAA,CAAC,qGAAmB,CAAG,CAAC,cAEhE1C,IAAA,QAAKyC,SAAS,CAAC,YAAY,CAAAC,QAAA,CACxBtC,OAAO,CAAC6C,GAAG,CAAEC,QAAQ,eACpBhD,KAAA,CAACN,MAAM,CAACuD,GAAG,EAETV,SAAS,CAAC,sFAAsF,CAChGG,OAAO,CAAE,CAAEC,OAAO,CAAE,CAAC,CAAEO,CAAC,CAAE,CAAC,EAAG,CAAE,CAChCL,OAAO,CAAE,CAAEF,OAAO,CAAE,CAAC,CAAEO,CAAC,CAAE,CAAE,CAAE,CAC9BC,IAAI,CAAE,CAAER,OAAO,CAAE,CAAC,CAAEO,CAAC,CAAE,EAAG,CAAE,CAAAV,QAAA,eAE5BxC,KAAA,QAAAwC,QAAA,eACE1C,IAAA,MAAGyC,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAEQ,QAAQ,CAACI,IAAI,CAAI,CAAC,cACxDtD,IAAA,MAAGyC,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAEQ,QAAQ,CAACvB,KAAK,CAAI,CAAC,cACzDzB,KAAA,MAAGuC,SAAS,CAAC,uBAAuB,CAAAC,QAAA,EAAC,iEAAa,CAAC,GAAI,CAAAa,IAAI,CAACL,QAAQ,CAACM,SAAS,CAAC,CAACC,cAAc,CAAC,OAAO,CAAC,EAAI,CAAC,EACzG,CAAC,cACNvD,KAAA,QAAKuC,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzB1C,IAAA,WACE0D,OAAO,CAAEA,CAAA,GAAMhC,OAAO,CAACwB,QAAQ,CAACvB,KAAK,CAAE,CACvCc,SAAS,CAAC,qFAAqF,CAAAC,QAAA,CAChG,sCAED,CAAQ,CAAC,cACT1C,IAAA,WACE0D,OAAO,CAAEA,CAAA,GAAMtB,MAAM,CAACc,QAAQ,CAACvB,KAAK,CAAE,CACtCc,SAAS,CAAC,iFAAiF,CAAAC,QAAA,CAC5F,oBAED,CAAQ,CAAC,EACN,CAAC,GAxBDQ,QAAQ,CAACS,GAyBJ,CACb,CAAC,CACC,CACN,EACE,CAAC,CACH,CAAC,CAEV,CAAC,CAED,cAAe,CAAAxD,gBAAgB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}