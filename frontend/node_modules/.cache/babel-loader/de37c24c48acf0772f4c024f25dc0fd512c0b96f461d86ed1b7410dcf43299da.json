{"ast":null,"code":"import _objectSpread from\"/root/shose/app-shose/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useState,useEffect,useRef,useCallback,useLayoutEffect}from'react';import{motion,AnimatePresence}from'framer-motion';import{useNavigate}from'react-router-dom';import axios from'axios';import{Document,Packer,Paragraph,Table,TableCell,TableRow,TextRun,WidthType}from'docx';import{saveAs}from'file-saver';import{io}from'socket.io-client';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Orders=()=>{const[orders,setOrders]=useState([]);const[vendorSearch,setVendorSearch]=useState('');const[phoneSearch,setPhoneSearch]=useState('');const[orderNumberSearch,setOrderNumberSearch]=useState('');const[startDate,setStartDate]=useState('');const[endDate,setEndDate]=useState('');const[statusFilters,setStatusFilters]=useState({rejected:false,shipped:false,delivered:false});const[showUnreadOnly,setShowUnreadOnly]=useState(false);const[selectedMedia,setSelectedMedia]=useState(null);const[error,setError]=useState(null);const[editOrder,setEditOrder]=useState(null);const[editForm,setEditForm]=useState({quantity:1,address:''});const[selectedOrderForMessages,setSelectedOrderForMessages]=useState(null);const[newMessage,setNewMessage]=useState('');const[newImage,setNewImage]=useState(null);const[newImagePreview,setNewImagePreview]=useState(null);const[page,setPage]=useState(1);const[total,setTotal]=useState(0);const[loading,setLoading]=useState(true);const limit=20;const navigate=useNavigate();// Refs\nconst socketRef=useRef(null);const currentOrderIdRef=useRef(null);const messagesContainerRef=useRef(null);const messagesEndRef=useRef(null);// Image preview effect\nuseEffect(()=>{if(newImage){const reader=new FileReader();reader.onloadend=()=>{setNewImagePreview(reader.result);};reader.readAsDataURL(newImage);}else{setNewImagePreview(null);}},[newImage]);// Scroll to bottom - مضمون 100%\nconst scrollToBottom=useCallback(()=>{if(messagesEndRef.current){messagesEndRef.current.scrollIntoView({behavior:'smooth',block:'end'});}else if(messagesContainerRef.current){const container=messagesContainerRef.current;container.scrollTop=container.scrollHeight;}},[]);// تم حذف useLayoutEffect تمامًا — كان هو سبب المشكلة\n// useLayoutEffect كان بيشتغل كل ما الرسائل تتحدث → يرجعك للآخر\n// Scroll فقط عند فتح المحادثة\nuseEffect(()=>{if(selectedOrderForMessages){const timer=setTimeout(()=>{scrollToBottom();},150);return()=>clearTimeout(timer);}},[selectedOrderForMessages,scrollToBottom]);// Socket authentication & connection management\nuseEffect(()=>{const token=localStorage.getItem('token');if(!token){setError('يرجى تسجيل الدخول');navigate('/login');return;}try{const payload=JSON.parse(atob(token.split('.')[1]));socketRef.current=io(process.env.REACT_APP_API_URL,{autoConnect:false});const socket=socketRef.current;socket.connect();socket.emit('authenticate',{userId:payload.id,role:payload.role});socket.on('connect',()=>{console.log('Socket connected successfully');if(currentOrderIdRef.current){socket.emit('joinOrder',currentOrderIdRef.current);}});socket.on('error',err=>{console.error('Socket.IO error:',err);setError(\"\\u062E\\u0637\\u0623 \\u0641\\u064A \\u0627\\u0644\\u0627\\u062A\\u0635\\u0627\\u0644: \".concat(err.message||'غير معروف'));});socket.on('orderJoined',_ref=>{let{orderId}=_ref;console.log(\"Successfully joined order room: \".concat(orderId));});socket.on('disconnect',()=>{console.log('Socket disconnected');});return()=>{if(socket.connected){socket.disconnect();}};}catch(e){console.error('Token decode error:',e);setError('خطأ في التوثيق، يرجى تسجيل الدخول مرة أخرى');localStorage.removeItem('token');localStorage.removeItem('role');localStorage.removeItem('userId');navigate('/login');}},[navigate]);// Fetch orders with full dependencies\nconst fetchOrders=useCallback(()=>{setLoading(true);const token=localStorage.getItem('token');if(!token){setError('يرجى تسجيل الدخول لجلب الطلبات');navigate('/login');return;}let url=\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders\");const params=new URLSearchParams();if(vendorSearch)params.append('vendorName',vendorSearch);if(phoneSearch)params.append('phone',phoneSearch);if(orderNumberSearch)params.append('orderNumber',orderNumberSearch);if(startDate)params.append('startDate',startDate);if(endDate)params.append('endDate',endDate);if(statusFilters.rejected)params.append('status','rejected');if(statusFilters.shipped)params.append('status','shipped');if(statusFilters.delivered)params.append('status','delivered');params.append('page',page);params.append('limit',limit);if(params.toString())url+=\"?\".concat(params.toString());axios.get(url,{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>{console.log('Fetched orders:',res.data);setOrders(res.data.orders||[]);setTotal(res.data.total||0);setError(null);}).catch(err=>{var _err$response,_err$response$data,_err$response2;console.error('Fetch orders error:',err);const errorMessage=((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'خطأ في جلب الطلبات: '+err.message;setError(errorMessage);if(((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.status)===401){setError('غير مصرح: يرجى تسجيل الدخول مرة أخرى');localStorage.removeItem('token');localStorage.removeItem('role');localStorage.removeItem('userId');navigate('/login');}}).finally(()=>{setLoading(false);});},[vendorSearch,phoneSearch,orderNumberSearch,startDate,endDate,statusFilters,page,navigate]);// Trigger fetch on dependency change\nuseEffect(()=>{fetchOrders();},[fetchOrders]);// Messages modal socket handling (full cleanup and real-time updates)\nuseEffect(()=>{if(!selectedOrderForMessages||!socketRef.current){if(currentOrderIdRef.current&&socketRef.current){socketRef.current.emit('leaveOrder',currentOrderIdRef.current);currentOrderIdRef.current=null;}return;}const orderId=selectedOrderForMessages._id;currentOrderIdRef.current=orderId;socketRef.current.emit('joinOrder',orderId);const token=localStorage.getItem('token');// تم تعديل هذا الجزء: تحديث القراءة أولًا + Scroll بعد التحديث\naxios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/\").concat(orderId,\"/markRead\"),{},{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>{setOrders(prevOrders=>prevOrders.map(o=>o._id===orderId?_objectSpread(_objectSpread({},o),{},{unreadCount:0}):o));setSelectedOrderForMessages(prev=>_objectSpread(_objectSpread({},prev),{},{messages:res.data.order.messages||[],unreadCount:0}));// Scroll فقط عند الفتح — تم حذفه من هنا\n}).catch(err=>{console.error('Mark read error:',err);setError('خطأ في تحديث حالة القراءة');});const handleNewMessage=message=>{if(message.orderId!==orderId)return;setSelectedOrderForMessages(prev=>{var _prev$messages;const exists=(_prev$messages=prev.messages)===null||_prev$messages===void 0?void 0:_prev$messages.some(m=>m._id===message._id);if(exists)return prev;const newMessages=[...(prev.messages||[]),message];// Scroll فقط لما ترسل أنت — مش هنا\nreturn _objectSpread(_objectSpread({},prev),{},{messages:newMessages});});if(message.from!==getUserRole()){setOrders(prevOrders=>prevOrders.map(o=>o._id===orderId?_objectSpread(_objectSpread({},o),{},{unreadCount:(o.unreadCount||0)+1}):o));}};const handleMessagesUpdated=data=>{if(data.orderId!==orderId)return;setSelectedOrderForMessages(prev=>_objectSpread(_objectSpread({},prev),{},{messages:data.messages||[],unreadCount:data.messages.filter(msg=>!msg.isRead&&msg.from!==getUserRole()).length}));// Scroll فقط لما ترسل — مش هنا\n};const handleUnreadUpdate=_ref2=>{let{orderId:updatedId,unreadCount}=_ref2;setOrders(prev=>prev.map(o=>o._id===updatedId?_objectSpread(_objectSpread({},o),{},{unreadCount}):o));if(updatedId===orderId){setSelectedOrderForMessages(prev=>_objectSpread(_objectSpread({},prev),{},{unreadCount}));}};const socket=socketRef.current;socket.on('newMessage',handleNewMessage);socket.on('messagesUpdated',handleMessagesUpdated);socket.on('unreadUpdate',handleUnreadUpdate);return()=>{socket.off('newMessage',handleNewMessage);socket.off('messagesUpdated',handleMessagesUpdated);socket.off('unreadUpdate',handleUnreadUpdate);socket.emit('leaveOrder',orderId);currentOrderIdRef.current=null;};},[selectedOrderForMessages]);// Delete order handler\nconst handleDeleteOrder=id=>{if(!window.confirm('هل تريد حذف هذا الطلب؟'))return;const token=localStorage.getItem('token');if(!token){setError('يرجى تسجيل الدخول لتتمكن من حذف الطلبات');navigate('/login');return;}axios.delete(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/\").concat(id),{headers:{Authorization:\"Bearer \".concat(token)}}).then(()=>{setOrders(prev=>prev.filter(o=>o._id!==id));setError(null);alert('تم حذف الطلب بنجاح');}).catch(err=>{var _err$response3,_err$response3$data,_err$response4;const errorMessage=((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.message)||'خطأ في الحذف: '+err.message;setError(errorMessage);if(((_err$response4=err.response)===null||_err$response4===void 0?void 0:_err$response4.status)===401){setError('غير مصرح: يرجى تسجيل الدخول مرة أخرى');localStorage.removeItem('token');localStorage.removeItem('role');localStorage.removeItem('userId');navigate('/login');}});};// Update status handler\nconst handleUpdateStatus=(id,status)=>{const token=localStorage.getItem('token');if(!token){setError('يرجى تسجيل الدخول لتتمكن من تحديث حالة الطلب');navigate('/login');return;}axios.put(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/\").concat(id,\"/status\"),{status},{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>{setOrders(prev=>prev.map(o=>o._id===id?res.data.order:o));setError(null);alert('تم تحديث حالة الطلب بنجاح');}).catch(err=>{var _err$response5,_err$response5$data,_err$response6;const errorMessage=((_err$response5=err.response)===null||_err$response5===void 0?void 0:(_err$response5$data=_err$response5.data)===null||_err$response5$data===void 0?void 0:_err$response5$data.message)||'خطأ في التحديث: '+err.message;setError(errorMessage);if(((_err$response6=err.response)===null||_err$response6===void 0?void 0:_err$response6.status)===401){setError('غير مصرح: يرجى تسجيل الدخول مرة أخرى');localStorage.removeItem('token');localStorage.removeItem('role');localStorage.removeItem('userId');navigate('/login');}});};// Edit order handlers\nconst handleEditOrder=order=>{setEditOrder(order);setEditForm({quantity:order.quantity||1,address:order.address||''});};const handleEditSubmit=()=>{const token=localStorage.getItem('token');if(!token){setError('يرجى تسجيل الدخول لتتمكن من تعديل الطلب');navigate('/login');return;}axios.put(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/\").concat(editOrder._id),editForm,{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>{setOrders(prev=>prev.map(o=>o._id===editOrder._id?res.data.order:o));setEditOrder(null);setEditForm({quantity:1,address:''});setError(null);alert('تم تعديل الطلب بنجاح');}).catch(err=>{var _err$response7,_err$response7$data,_err$response8;const errorMessage=((_err$response7=err.response)===null||_err$response7===void 0?void 0:(_err$response7$data=_err$response7.data)===null||_err$response7$data===void 0?void 0:_err$response7$data.message)||'خطأ في تعديل الطلب: '+err.message;setError(errorMessage);if(((_err$response8=err.response)===null||_err$response8===void 0?void 0:_err$response8.status)===401){setError('غير مصرح: يرجى تسجيل الدخول مرة أخرى');localStorage.removeItem('token');localStorage.removeItem('role');localStorage.removeItem('userId');navigate('/login');}});};// Media handlers\nconst openMedia=media=>{if(media){setSelectedMedia({url:\"\".concat(process.env.REACT_APP_API_URL,\"/Uploads/\").concat(media),type:'image'});}};const closeMedia=()=>setSelectedMedia(null);// Group orders function (full logic preserved)\nconst groupOrders=useCallback((ordersList,role)=>{if(role==='customer')return ordersList;const grouped={};ordersList.forEach(order=>{const key=\"\".concat(order.product._id,\"-\").concat(order.user._id,\"-\").concat(order.address);if(!grouped[key]){grouped[key]=_objectSpread(_objectSpread({},order),{},{quantity:0,orderIds:[],selectedImages:new Set(),messages:[],unreadCount:0});}grouped[key].quantity+=order.quantity;grouped[key].orderIds.push(order._id);grouped[key].messages=grouped[key].messages.concat(order.messages||[]);if(order.selectedImage){grouped[key].selectedImages.add(order.selectedImage);}if(order.messages){const unread=order.messages.filter(msg=>!msg.isRead&&msg.from!==role).length;grouped[key].unreadCount+=unread;}});for(let key in grouped){grouped[key].messages.sort((a,b)=>new Date(a.timestamp)-new Date(b.timestamp));}return Object.values(grouped).map(group=>_objectSpread(_objectSpread({},group),{},{selectedImage:Array.from(group.selectedImages)[0]||'placeholder-image.jpg',isGrouped:group.orderIds.length>1,totalOrders:group.orderIds.length,unreadCount:group.unreadCount}));},[]);// Export to Word (full function preserved)\nconst exportToWord=async()=>{try{const token=localStorage.getItem('token');let url=\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders\");const params=new URLSearchParams();if(vendorSearch)params.append('vendorName',vendorSearch);if(phoneSearch)params.append('phone',phoneSearch);if(orderNumberSearch)params.append('orderNumber',orderNumberSearch);if(startDate)params.append('startDate',startDate);if(endDate)params.append('endDate',endDate);if(statusFilters.rejected)params.append('status','rejected');if(statusFilters.shipped)params.append('status','shipped');if(statusFilters.delivered)params.append('status','delivered');if(params.toString())url+=\"?\".concat(params.toString());const res=await axios.get(url,{headers:{Authorization:\"Bearer \".concat(token)}});const allOrders=res.data.orders||res.data;const grouped=groupOrders(allOrders,getUserRole());const doc=new Document({sections:[{children:[new Paragraph({children:[new TextRun({text:'قائمة الطلبات',size:32,bold:true,rtl:true})],alignment:'right',spacing:{after:200}}),new Table({rows:[new TableRow({children:[new TableCell({children:[new Paragraph({text:'رقم الطلب',rtl:true,bold:true})],width:{size:10,type:WidthType.PERCENTAGE}}),new TableCell({children:[new Paragraph({text:'الصورة',rtl:true,bold:true})],width:{size:12,type:WidthType.PERCENTAGE}}),new TableCell({children:[new Paragraph({text:'العميل',rtl:true,bold:true})],width:{size:12,type:WidthType.PERCENTAGE}}),new TableCell({children:[new Paragraph({text:'رقم الهاتف',rtl:true,bold:true})],width:{size:12,type:WidthType.PERCENTAGE}}),new TableCell({children:[new Paragraph({text:'العنوان',rtl:true,bold:true})],width:{size:15,type:WidthType.PERCENTAGE}}),new TableCell({children:[new Paragraph({text:'المنتج',rtl:true,bold:true})],width:{size:12,type:WidthType.PERCENTAGE}}),new TableCell({children:[new Paragraph({text:'التاجر',rtl:true,bold:true})],width:{size:12,type:WidthType.PERCENTAGE}}),new TableCell({children:[new Paragraph({text:'تاريخ الطلب',rtl:true,bold:true})],width:{size:12,type:WidthType.PERCENTAGE}}),new TableCell({children:[new Paragraph({text:'الحالة',rtl:true,bold:true})],width:{size:12,type:WidthType.PERCENTAGE}}),new TableCell({children:[new Paragraph({text:'الكمية',rtl:true,bold:true})],width:{size:13,type:WidthType.PERCENTAGE}})]}),...grouped.map(order=>{var _order$user,_order$user2,_order$product,_order$product2,_order$product2$vendo;return new TableRow({children:[new TableCell({children:[new Paragraph({text:(order.orderNumber||'-').toString(),rtl:true})]}),new TableCell({children:[new Paragraph({text:order.selectedImage||'placeholder-image.jpg',rtl:true})]}),new TableCell({children:[new Paragraph({text:((_order$user=order.user)===null||_order$user===void 0?void 0:_order$user.name)||'زائر',rtl:true})]}),new TableCell({children:[new Paragraph({text:((_order$user2=order.user)===null||_order$user2===void 0?void 0:_order$user2.phone)||'-',rtl:true})]}),new TableCell({children:[new Paragraph({text:order.address||'-',rtl:true})]}),new TableCell({children:[new Paragraph({text:((_order$product=order.product)===null||_order$product===void 0?void 0:_order$product.name)||'غير معروف',rtl:true})]}),new TableCell({children:[new Paragraph({text:((_order$product2=order.product)===null||_order$product2===void 0?void 0:(_order$product2$vendo=_order$product2.vendor)===null||_order$product2$vendo===void 0?void 0:_order$product2$vendo.name)||'غير معروف',rtl:true})]}),new TableCell({children:[new Paragraph({text:new Date(order.createdAt).toLocaleDateString('ar-EG')||'-',rtl:true})]}),new TableCell({children:[new Paragraph({text:{pending:'تحت المراجعة',shipped:'جاري الشحن',delivered:'تم التسليم',rejected:'مرفوض'}[order.status]||'غير معروف',rtl:true})]}),new TableCell({children:[new Paragraph({text:order.isGrouped?\"\".concat(order.quantity,\" (\\u0645\\u062C\\u0645\\u0639)\"):order.quantity.toString(),rtl:true})]})]});})],width:{size:100,type:WidthType.PERCENTAGE}})]}]});const blob=await Packer.toBlob(doc);saveAs(blob,'orders.docx');setError(null);}catch(error){console.error('Export to Word error:',error);setError('خطأ في تصدير الـ Word: '+error.message);}};// Send message handler (full with FormData)\nconst handleSendMessage=async e=>{e.preventDefault();e.stopPropagation();const token=localStorage.getItem('token');if(!token){setError('يرجى تسجيل الدخول');navigate('/login');return;}if(!newMessage.trim()&&!newImage){setError('يجب إدخال رسالة أو رفع صورة');return;}const formData=new FormData();if(newMessage.trim())formData.append('text',newMessage.trim());if(newImage)formData.append('image',newImage);try{const res=await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/\").concat(selectedOrderForMessages._id,\"/message\"),formData,{headers:{Authorization:\"Bearer \".concat(token),'Content-Type':'multipart/form-data'}});setSelectedOrderForMessages(prev=>_objectSpread(_objectSpread({},prev),{},{messages:res.data.order.messages||[]}));setNewMessage('');setNewImage(null);setNewImagePreview(null);setError(null);// Scroll بعد الإرسال فقط\nsetTimeout(()=>{scrollToBottom();},100);}catch(err){var _err$response9,_err$response9$data;const errorMessage=((_err$response9=err.response)===null||_err$response9===void 0?void 0:(_err$response9$data=_err$response9.data)===null||_err$response9$data===void 0?void 0:_err$response9$data.message)||'خطأ في إرسال الرسالة';setError(errorMessage);}};// Messages modal open/close\nconst openMessages=order=>{setSelectedOrderForMessages(order);};const closeMessages=()=>{setSelectedOrderForMessages(null);setNewMessage('');setNewImage(null);setNewImagePreview(null);};// User role getter\nconst getUserRole=()=>{const token=localStorage.getItem('token');if(token){try{const payload=JSON.parse(atob(token.split('.')[1]));return payload.role||'user';}catch(e){console.error('Error decoding token:',e);setError('خطأ في فك تشفير التوكن، يرجى تسجيل الدخول مرة أخرى');localStorage.removeItem('token');localStorage.removeItem('role');localStorage.removeItem('userId');navigate('/login');return'user';}}return'user';};const userRole=getUserRole();// Display orders with filters\nconst rawDisplayOrders=showUnreadOnly?orders.filter(o=>(o.unreadCount||0)>0):orders;const displayOrders=groupOrders(rawDisplayOrders,userRole);// Animation variants (preserved but simplified for performance)\nconst tableVariants={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:0.4,staggerChildren:0.05}}};const rowVariants={hidden:{opacity:0,x:-20},visible:{opacity:1,x:0,transition:{duration:0.3}}};const buttonVariants={hover:{scale:1.05,boxShadow:'0 8px 16px rgba(255,0,0,0.3)'},tap:{scale:0.95}};const modalVariants={hidden:{opacity:0,scale:0.85},visible:{opacity:1,scale:1,transition:{duration:0.25}},exit:{opacity:0,scale:0.85,transition:{duration:0.2}}};return/*#__PURE__*/_jsxs(motion.div,{className:\"min-h-screen flex flex-col items-center bg-[#18191a] p-4 sm:p-6 text-white overflow-x-hidden\",initial:{opacity:0},animate:{opacity:1},transition:{duration:0.5},children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl sm:text-4xl md:text-5xl font-bold mb-8 text-center bg-clip-text text-transparent bg-gradient-to-r from-red-500 to-red-700 drop-shadow-lg\",children:\"\\u0642\\u0627\\u0626\\u0645\\u0629 \\u0627\\u0644\\u0637\\u0644\\u0628\\u0627\\u062A\"}),error&&/*#__PURE__*/_jsxs(motion.div,{className:\"w-full max-w-4xl bg-red-900/90 text-white p-4 rounded-2xl mb-6 text-center font-medium shadow-2xl\",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:0.3},children:[error,/*#__PURE__*/_jsx(\"button\",{onClick:()=>setError(null),className:\"ml-4 text-xl font-bold\",children:\"\\xD7\"})]}),userRole!=='customer'&&/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-7xl mb-8 bg-[#242526] p-6 rounded-2xl shadow-2xl border border-gray-700\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 mb-6\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0627\\u0628\\u062D\\u062B \\u0628\\u0627\\u0633\\u0645 \\u0627\\u0644\\u062A\\u0627\\u062C\\u0631\",value:vendorSearch,onChange:e=>setVendorSearch(e.target.value),className:\"p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 transition\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0627\\u0628\\u062D\\u062B \\u0628\\u0631\\u0642\\u0645 \\u0627\\u0644\\u0647\\u0627\\u062A\\u0641\",value:phoneSearch,onChange:e=>setPhoneSearch(e.target.value),className:\"p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 transition\"}),/*#__PURE__*/_jsx(\"input\",{typeauth:\"text\",placeholder:\"\\u0627\\u0628\\u062D\\u062B \\u0628\\u0631\\u0642\\u0645 \\u0627\\u0644\\u0637\\u0644\\u0628\",value:orderNumberSearch,onChange:e=>setOrderNumberSearch(e.target.value),className:\"p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 transition\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:startDate,onChange:e=>setStartDate(e.target.value),className:\"p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 transition\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:endDate,onChange:e=>setEndDate(e.target.value),className:\"p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 transition\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap items-center gap-4 mb-6\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-300 font-medium\",children:\"\\u0641\\u0644\\u062A\\u0631 \\u0627\\u0644\\u062D\\u0627\\u0644\\u0629:\"}),['rejected','shipped','delivered'].map(status=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 space-x-reverse cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:statusFilters[status],onChange:e=>setStatusFilters(prev=>_objectSpread(_objectSpread({},prev),{},{[status]:e.target.checked})),className:\"w-5 h-5 text-red-600 rounded focus:ring-red-500 accent-red-600\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white\",children:status==='rejected'?'مرفوض':status==='shipped'?'جاري الشحن':'تم التسليم'})]},status)),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 space-x-reverse cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:showUnreadOnly,onChange:e=>setShowUnreadOnly(e.target.checked),className:\"w-5 h-5 text-red-600 rounded focus:ring-red-500 accent-red-600\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white\",children:\"\\u0627\\u0644\\u0637\\u0644\\u0628\\u0627\\u062A \\u0627\\u0644\\u062A\\u064A \\u0628\\u0647\\u0627 \\u0631\\u0633\\u0627\\u0626\\u0644 \\u063A\\u064A\\u0631 \\u0645\\u0642\\u0631\\u0648\\u0621\\u0629 \\u0641\\u0642\\u0637\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-4\",children:[/*#__PURE__*/_jsx(motion.button,{onClick:fetchOrders,className:\"px-8 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-xl text-lg\",variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",children:\"\\u0628\\u062D\\u062B\"}),/*#__PURE__*/_jsx(motion.button,{onClick:exportToWord,className:\"px-8 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-xl text-lg\",variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",children:\"\\u062A\\u0635\\u062F\\u064A\\u0631 \\u0625\\u0644\\u0649 Word\"})]})]}),/*#__PURE__*/_jsxs(AnimatePresence,{mode:\"wait\",children:[loading&&/*#__PURE__*/_jsx(motion.p,{className:\"text-2xl text-gray-400 py-12\",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:\"\\u062C\\u0627\\u0631\\u064A \\u0627\\u0644\\u062A\\u062D\\u0645\\u064A\\u0644...\"},\"loading\"),!loading&&displayOrders.length===0&&/*#__PURE__*/_jsx(motion.p,{className:\"text-2xl text-gray-400 py-12\",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:\"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u0637\\u0644\\u0628\\u0627\\u062A \\u062D\\u0627\\u0644\\u064A\\u0627\\u064B.\"},\"no-orders\"),!loading&&displayOrders.length>0&&/*#__PURE__*/_jsx(motion.div,{className:\"w-full max-w-7xl overflow-x-auto bg-[#242526] rounded-2xl shadow-2xl border border-gray-700\",variants:tableVariants,initial:\"hidden\",animate:\"visible\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-700\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-[#3a3b3c]\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\",children:\"\\u0631\\u0642\\u0645 \\u0627\\u0644\\u0637\\u0644\\u0628\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\",children:\"\\u0627\\u0644\\u0635\\u0648\\u0631\\u0629\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\",children:\"\\u0627\\u0644\\u0639\\u0645\\u064A\\u0644\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\",children:\"\\u0631\\u0642\\u0645 \\u0627\\u0644\\u0647\\u0627\\u062A\\u0641\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\",children:\"\\u0627\\u0644\\u0639\\u0646\\u0648\\u0627\\u0646\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\",children:\"\\u0627\\u0644\\u0645\\u0646\\u062A\\u062C\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\",children:\"\\u0627\\u0644\\u062A\\u0627\\u062C\\u0631\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\",children:\"\\u062A\\u0627\\u0631\\u064A\\u062E \\u0627\\u0644\\u0637\\u0644\\u0628\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\",children:\"\\u0627\\u0644\\u062D\\u0627\\u0644\\u0629\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\",children:\"\\u0627\\u0644\\u0643\\u0645\\u064A\\u0629\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\",children:\"\\u0627\\u0644\\u0631\\u0633\\u0627\\u0626\\u0644 \\u063A\\u064A\\u0631 \\u0627\\u0644\\u0645\\u0642\\u0631\\u0648\\u0621\\u0629\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\",children:\"\\u0625\\u062C\\u0631\\u0627\\u0621\\u0627\\u062A\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-[#242526] divide-y divide-gray-700\",children:displayOrders.map((order,idx)=>{var _order$user3,_order$user4,_order$product3,_order$product4,_order$product4$vendo;return/*#__PURE__*/_jsxs(motion.tr,{className:\"hover:bg-[#3a3b3c] transition duration-200\",variants:rowVariants,children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-4 px-6 text-right text-sm\",children:order.orderNumber||'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-4 px-6 text-center\",children:/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(process.env.REACT_APP_API_URL,\"/Uploads/\").concat(order.selectedImage),alt:\"\\u0635\\u0648\\u0631\\u0629 \\u0627\\u0644\\u0637\\u0644\\u0628\",className:\"w-20 h-20 object-cover rounded-xl mx-auto cursor-pointer shadow-md hover:shadow-xl transition\",onClick:()=>openMedia(order.selectedImage),onError:e=>{e.target.onerror=null;e.target.src=\"\".concat(process.env.REACT_APP_API_URL,\"/Uploads/placeholder-image.jpg\");}})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-4 px-6 text-right font-medium\",children:((_order$user3=order.user)===null||_order$user3===void 0?void 0:_order$user3.name)||'زائر'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-4 px-6 text-right\",children:((_order$user4=order.user)===null||_order$user4===void 0?void 0:_order$user4.phone)||'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-4 px-6 text-right text-ellipsis overflow-hidden max-w-xs\",children:order.address||'-'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-4 px-6 text-right\",children:((_order$product3=order.product)===null||_order$product3===void 0?void 0:_order$product3.name)||'غير معروف'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-4 px-6 text-right\",children:((_order$product4=order.product)===null||_order$product4===void 0?void 0:(_order$product4$vendo=_order$product4.vendor)===null||_order$product4$vendo===void 0?void 0:_order$product4$vendo.name)||'غير معروف'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-4 px-6 text-right\",children:new Date(order.createdAt).toLocaleDateString('ar-EG')}),/*#__PURE__*/_jsx(\"td\",{className:\"py-4 px-6 text-right\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-4 py-2 rounded-full text-xs font-bold \".concat(order.status==='pending'?'bg-yellow-600/30 text-yellow-300 border border-yellow-600':order.status==='shipped'?'bg-blue-600/30 text-blue-300 border border-blue-600':order.status==='delivered'?'bg-green-600/30 text-green-300 border border-green-600':'bg-red-600/30 text-red-300 border border-red-600'),children:{pending:'تحت المراجعة',shipped:'جاري الشحن',delivered:'تم التسليم',rejected:'مرفوض'}[order.status]||'غير معروف'})}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-4 px-6 text-right font-bold text-yellow-400\",children:[order.quantity,\" \",order.isGrouped&&\"(\\u0645\\u062C\\u0645\\u0639 \\u0645\\u0646 \".concat(order.totalOrders,\" \\u0637\\u0644\\u0628)\")]}),/*#__PURE__*/_jsx(\"td\",{className:\"py-4 px-6 text-center\",children:/*#__PURE__*/_jsx(motion.button,{onClick:()=>openMessages(order),className:\"w-12 h-12 rounded-full flex items-center justify-center text-white font-bold shadow-lg text-lg \".concat(order.unreadCount>0?'bg-gradient-to-r from-red-600 to-red-800 animate-pulse':'bg-gradient-to-r from-gray-600 to-gray-800'),variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",children:order.unreadCount>0?order.unreadCount:0})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-4 px-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-end gap-3 flex-wrap\",children:[userRole==='admin'&&!order.isGrouped&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(motion.button,{className:\"px-5 py-2 rounded-xl text-white font-bold bg-gradient-to-r from-blue-600 to-blue-800 shadow-lg\",variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",onClick:()=>handleEditOrder(order),children:\"\\u062A\\u0639\\u062F\\u064A\\u0644\"}),/*#__PURE__*/_jsx(motion.button,{onClick:()=>handleDeleteOrder(order._id),className:\"px-5 py-2 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-lg\",variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",children:\"\\u062D\\u0630\\u0641\"})]}),userRole==='vendor'&&!order.isGrouped&&/*#__PURE__*/_jsxs(motion.select,{value:order.status,onChange:e=>handleUpdateStatus(order._id,e.target.value),className:\"p-3 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm\",variants:buttonVariants,whileHover:\"hover\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"pending\",children:\"\\u062A\\u062D\\u062A \\u0627\\u0644\\u0645\\u0631\\u0627\\u062C\\u0639\\u0629\"}),/*#__PURE__*/_jsx(\"option\",{value:\"shipped\",children:\"\\u062C\\u0627\\u0631\\u064A \\u0627\\u0644\\u0634\\u062D\\u0646\"}),/*#__PURE__*/_jsx(\"option\",{value:\"delivered\",children:\"\\u062A\\u0645 \\u0627\\u0644\\u062A\\u0633\\u0644\\u064A\\u0645\"}),/*#__PURE__*/_jsx(\"option\",{value:\"rejected\",children:\"\\u0645\\u0631\\u0641\\u0648\\u0636\"})]}),userRole==='customer'&&order.status==='pending'&&!order.isGrouped&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(motion.button,{className:\"px-5 py-2 rounded-xl text-white font-bold bg-gradient-to-r from-blue-600 to-blue-800 shadow-lg\",variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",onClick:()=>handleEditOrder(order),children:\"\\u062A\\u0639\\u062F\\u064A\\u0644\"}),/*#__PURE__*/_jsx(motion.button,{onClick:()=>handleDeleteOrder(order._id),className:\"px-5 py-2 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-lg\",variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",children:\"\\u062D\\u0630\\u0641\"})]})]})})]},order.isGrouped?\"group-\".concat(idx):order._id);})})]})},\"table-container\")]}),!loading&&total>limit&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center items-center gap-6 mt-8\",children:[/*#__PURE__*/_jsx(motion.button,{onClick:()=>setPage(prev=>Math.max(1,prev-1)),disabled:page===1,className:\"px-8 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-xl disabled:opacity-50 disabled:cursor-not-allowed text-lg\",variants:buttonVariants,whileHover:page!==1?\"hover\":{},whileTap:page!==1?\"tap\":{},children:\"\\u0627\\u0644\\u0633\\u0627\\u0628\\u0642\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xl text-gray-300\",children:[\"\\u0635\\u0641\\u062D\\u0629 \",page,\" \\u0645\\u0646 \",Math.ceil(total/limit)]}),/*#__PURE__*/_jsx(motion.button,{onClick:()=>setPage(prev=>prev+1),disabled:page*limit>=total,className:\"px-8 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-xl disabled:opacity-50 disabled:cursor-not-allowed text-lg\",variants:buttonVariants,whileHover:page*limit<total?\"hover\":{},whileTap:page*limit<total?\"tap\":{},children:\"\\u0627\\u0644\\u062A\\u0627\\u0644\\u064A\"})]}),/*#__PURE__*/_jsx(AnimatePresence,{children:editOrder&&!editOrder.isGrouped&&/*#__PURE__*/_jsx(motion.div,{className:\"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4\",variants:modalVariants,initial:\"hidden\",animate:\"visible\",exit:\"exit\",onClick:()=>setEditOrder(null),children:/*#__PURE__*/_jsxs(motion.div,{className:\"bg-[#242526] p-8 rounded-2xl shadow-2xl border border-gray-700 w-full max-w-md\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold mb-8 text-right bg-clip-text text-transparent bg-gradient-to-r from-red-500 to-red-700\",children:\"\\u062A\\u0639\\u062F\\u064A\\u0644 \\u0627\\u0644\\u0637\\u0644\\u0628\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"\\u0627\\u0644\\u0643\\u0645\\u064A\\u0629\",value:editForm.quantity,onChange:e=>setEditForm(_objectSpread(_objectSpread({},editForm),{},{quantity:parseInt(e.target.value)||1})),className:\"w-full p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 text-right text-lg\",min:\"1\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0627\\u0644\\u0639\\u0646\\u0648\\u0627\\u0646\",value:editForm.address,onChange:e=>setEditForm(_objectSpread(_objectSpread({},editForm),{},{address:e.target.value})),className:\"w-full p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 text-right text-lg\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4 mt-8\",children:[/*#__PURE__*/_jsx(motion.button,{onClick:handleEditSubmit,className:\"flex-1 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-green-600 to-green-800 shadow-xl text-lg\",variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",children:\"\\u062D\\u0641\\u0638 \\u0627\\u0644\\u062A\\u0639\\u062F\\u064A\\u0644\\u0627\\u062A\"}),/*#__PURE__*/_jsx(motion.button,{onClick:()=>setEditOrder(null),className:\"flex-1 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-xl text-lg\",variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",children:\"\\u0625\\u0644\\u063A\\u0627\\u0621\"})]})]})})}),/*#__PURE__*/_jsx(AnimatePresence,{children:selectedOrderForMessages&&/*#__PURE__*/_jsx(motion.div,{className:\"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4\",variants:modalVariants,initial:\"hidden\",animate:\"visible\",exit:\"exit\",onClick:closeMessages,children:/*#__PURE__*/_jsxs(motion.div,{className:\"bg-[#242526] p-6 sm:p-8 rounded-2xl shadow-2xl border border-gray-700 w-full max-w-2xl max-h-[90vh] flex flex-col\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-3xl font-bold mb-6 text-right bg-clip-text text-transparent bg-gradient-to-r from-red-500 to-red-700\",children:[\"\\u0627\\u0644\\u0631\\u0633\\u0627\\u0626\\u0644 \\u0644\\u0644\\u0637\\u0644\\u0628 #\",selectedOrderForMessages.orderNumber]}),/*#__PURE__*/_jsx(\"div\",{ref:messagesContainerRef,className:\"flex-1 overflow-y-auto mb-6 bg-[#3a3b3c] p-4 rounded-2xl shadow-inner\",style:{scrollBehavior:'smooth'},children:selectedOrderForMessages.messages&&selectedOrderForMessages.messages.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[selectedOrderForMessages.messages.map((msg,index)=>{var _selectedOrderForMess,_selectedOrderForMess2,_selectedOrderForMess3;const isMyMessage=msg.from===userRole;const senderName=msg.from==='vendor'?(_selectedOrderForMess=selectedOrderForMessages.product)===null||_selectedOrderForMess===void 0?void 0:(_selectedOrderForMess2=_selectedOrderForMess.vendor)===null||_selectedOrderForMess2===void 0?void 0:_selectedOrderForMess2.name:((_selectedOrderForMess3=selectedOrderForMessages.user)===null||_selectedOrderForMess3===void 0?void 0:_selectedOrderForMess3.name)||'غير معروف';return/*#__PURE__*/_jsx(\"div\",{className:\"flex \".concat(isMyMessage?'justify-end':'justify-start'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-xs sm:max-w-sm p-4 rounded-2xl shadow-md \".concat(isMyMessage?'bg-gradient-to-r from-red-600 to-red-800 text-white':'bg-gray-700 text-white'),children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-bold text-sm opacity-90\",children:[msg.from==='vendor'?'التاجر':'العميل',\": \",senderName]}),msg.text&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-lg\",children:msg.text}),msg.image&&/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(process.env.REACT_APP_API_URL,\"/Uploads/\").concat(msg.image),alt:\"\\u0635\\u0648\\u0631\\u0629 \\u0627\\u0644\\u0631\\u0633\\u0627\\u0644\\u0629\",className:\"mt-3 w-full max-w-48 object-cover rounded-xl cursor-pointer shadow-lg hover:shadow-xl transition\",onClick:e=>{e.stopPropagation();openMedia(msg.image);},onError:e=>{e.target.onerror=null;e.target.src=\"\".concat(process.env.REACT_APP_API_URL,\"/Uploads/placeholder-image.jpg\");}}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mt-3 text-xs opacity-70\",children:[/*#__PURE__*/_jsx(\"p\",{children:new Date(msg.timestamp).toLocaleString('ar-EG')}),isMyMessage&&/*#__PURE__*/_jsx(\"span\",{children:msg.isRead?'✓✓':msg.isDelivered?'✓':'✓'})]})]})},msg._id||index);}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}):/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-400 text-lg\",children:\"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u0631\\u0633\\u0627\\u0626\\u0644 \\u0628\\u0639\\u062F.\"})}),(userRole==='vendor'||userRole==='customer')&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSendMessage,className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"\\u0627\\u0643\\u062A\\u0628 \\u0631\\u0633\\u0627\\u0644\\u062A\\u0643 \\u0647\\u0646\\u0627...\",value:newMessage,onChange:e=>setNewMessage(e.target.value),className:\"w-full p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 text-right resize-none\",rows:\"4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:e=>setNewImage(e.target.files[0]||null),className:\"text-sm text-gray-300 file:mr-4 file:py-3 file:px-6 file:rounded-xl file:border-0 file:bg-red-600 file:text-white hover:file:bg-red-700\"}),newImagePreview&&/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:newImagePreview,alt:\"\\u0645\\u0639\\u0627\\u064A\\u0646\\u0629\",className:\"w-24 h-24 object-cover rounded-xl shadow-lg\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setNewImage(null);setNewImagePreview(null);},className:\"absolute top-0 right-0 bg-red-800 text-white rounded-full w-8 h-8 flex items-center justify-center text-xl\",children:\"\\xD7\"})]})]}),/*#__PURE__*/_jsx(motion.button,{type:\"submit\",className:\"w-full py-4 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-xl text-lg\",variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",children:\"\\u0625\\u0631\\u0633\\u0627\\u0644 \\u0627\\u0644\\u0631\\u0633\\u0627\\u0644\\u0629\"})]}),/*#__PURE__*/_jsx(motion.button,{onClick:closeMessages,className:\"w-full mt-4 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-gray-700 to-gray-900 shadow-xl text-lg\",variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",children:\"\\u0625\\u063A\\u0644\\u0627\\u0642\"})]})})}),/*#__PURE__*/_jsx(AnimatePresence,{children:selectedMedia&&/*#__PURE__*/_jsx(motion.div,{className:\"fixed inset-0 bg-black/90 flex items-center justify-center z-50 p-4\",variants:modalVariants,initial:\"hidden\",animate:\"visible\",exit:\"exit\",onClick:closeMedia,children:/*#__PURE__*/_jsxs(motion.div,{className:\"relative max-w-4xl max-h-full\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"img\",{src:selectedMedia.url,className:\"max-w-full max-h-full rounded-2xl shadow-2xl\",alt:\"\\u0635\\u0648\\u0631\\u0629 \\u0645\\u0643\\u0628\\u0631\\u0629\",onError:e=>{e.target.onerror=null;e.target.src=\"\".concat(process.env.REACT_APP_API_URL,\"/Uploads/placeholder-image.jpg\");}}),/*#__PURE__*/_jsx(motion.button,{onClick:closeMedia,className:\"absolute top-4 right-4 text-white text-5xl bg-black/70 rounded-full w-14 h-14 flex items-center justify-center shadow-xl hover:bg-black/90 transition\",variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",children:\"\\xD7\"})]})})})]});};export default Orders;","map":{"version":3,"names":["useState","useEffect","useRef","useCallback","useLayoutEffect","motion","AnimatePresence","useNavigate","axios","Document","Packer","Paragraph","Table","TableCell","TableRow","TextRun","WidthType","saveAs","io","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Orders","orders","setOrders","vendorSearch","setVendorSearch","phoneSearch","setPhoneSearch","orderNumberSearch","setOrderNumberSearch","startDate","setStartDate","endDate","setEndDate","statusFilters","setStatusFilters","rejected","shipped","delivered","showUnreadOnly","setShowUnreadOnly","selectedMedia","setSelectedMedia","error","setError","editOrder","setEditOrder","editForm","setEditForm","quantity","address","selectedOrderForMessages","setSelectedOrderForMessages","newMessage","setNewMessage","newImage","setNewImage","newImagePreview","setNewImagePreview","page","setPage","total","setTotal","loading","setLoading","limit","navigate","socketRef","currentOrderIdRef","messagesContainerRef","messagesEndRef","reader","FileReader","onloadend","result","readAsDataURL","scrollToBottom","current","scrollIntoView","behavior","block","container","scrollTop","scrollHeight","timer","setTimeout","clearTimeout","token","localStorage","getItem","payload","JSON","parse","atob","split","process","env","REACT_APP_API_URL","autoConnect","socket","connect","emit","userId","id","role","on","console","log","err","concat","message","_ref","orderId","connected","disconnect","e","removeItem","fetchOrders","url","params","URLSearchParams","append","toString","get","headers","Authorization","then","res","data","catch","_err$response","_err$response$data","_err$response2","errorMessage","response","status","finally","_id","post","prevOrders","map","o","_objectSpread","unreadCount","prev","messages","order","handleNewMessage","_prev$messages","exists","some","m","newMessages","from","getUserRole","handleMessagesUpdated","filter","msg","isRead","length","handleUnreadUpdate","_ref2","updatedId","off","handleDeleteOrder","window","confirm","delete","alert","_err$response3","_err$response3$data","_err$response4","handleUpdateStatus","put","_err$response5","_err$response5$data","_err$response6","handleEditOrder","handleEditSubmit","_err$response7","_err$response7$data","_err$response8","openMedia","media","type","closeMedia","groupOrders","ordersList","grouped","forEach","key","product","user","orderIds","selectedImages","Set","push","selectedImage","add","unread","sort","a","b","Date","timestamp","Object","values","group","Array","isGrouped","totalOrders","exportToWord","allOrders","doc","sections","children","text","size","bold","rtl","alignment","spacing","after","rows","width","PERCENTAGE","_order$user","_order$user2","_order$product","_order$product2","_order$product2$vendo","orderNumber","name","phone","vendor","createdAt","toLocaleDateString","pending","blob","toBlob","handleSendMessage","preventDefault","stopPropagation","trim","formData","FormData","_err$response9","_err$response9$data","openMessages","closeMessages","userRole","rawDisplayOrders","displayOrders","tableVariants","hidden","opacity","y","visible","transition","duration","staggerChildren","rowVariants","x","buttonVariants","hover","scale","boxShadow","tap","modalVariants","exit","div","className","initial","animate","onClick","placeholder","value","onChange","target","typeauth","checked","button","variants","whileHover","whileTap","mode","p","idx","_order$user3","_order$user4","_order$product3","_order$product4","_order$product4$vendo","tr","src","alt","onError","onerror","select","Math","max","disabled","ceil","parseInt","min","ref","style","scrollBehavior","index","_selectedOrderForMess","_selectedOrderForMess2","_selectedOrderForMess3","isMyMessage","senderName","image","toLocaleString","isDelivered","onSubmit","accept","files"],"sources":["/root/shose/app-shose/frontend/src/pages/Orders.js"],"sourcesContent":["import { useState, useEffect, useRef, useCallback, useLayoutEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { Document, Packer, Paragraph, Table, TableCell, TableRow, TextRun, WidthType } from 'docx';\nimport { saveAs } from 'file-saver';\nimport { io } from 'socket.io-client';\n\nconst Orders = () => {\n  const [orders, setOrders] = useState([]);\n  const [vendorSearch, setVendorSearch] = useState('');\n  const [phoneSearch, setPhoneSearch] = useState('');\n  const [orderNumberSearch, setOrderNumberSearch] = useState('');\n  const [startDate, setStartDate] = useState('');\n  const [endDate, setEndDate] = useState('');\n  const [statusFilters, setStatusFilters] = useState({ rejected: false, shipped: false, delivered: false });\n  const [showUnreadOnly, setShowUnreadOnly] = useState(false);\n  const [selectedMedia, setSelectedMedia] = useState(null);\n  const [error, setError] = useState(null);\n  const [editOrder, setEditOrder] = useState(null);\n  const [editForm, setEditForm] = useState({ quantity: 1, address: '' });\n  const [selectedOrderForMessages, setSelectedOrderForMessages] = useState(null);\n  const [newMessage, setNewMessage] = useState('');\n  const [newImage, setNewImage] = useState(null);\n  const [newImagePreview, setNewImagePreview] = useState(null);\n  const [page, setPage] = useState(1);\n  const [total, setTotal] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const limit = 20;\n  const navigate = useNavigate();\n\n  // Refs\n  const socketRef = useRef(null);\n  const currentOrderIdRef = useRef(null);\n  const messagesContainerRef = useRef(null);\n  const messagesEndRef = useRef(null);\n\n  // Image preview effect\n  useEffect(() => {\n    if (newImage) {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setNewImagePreview(reader.result);\n      };\n      reader.readAsDataURL(newImage);\n    } else {\n      setNewImagePreview(null);\n    }\n  }, [newImage]);\n\n  // Scroll to bottom - مضمون 100%\n  const scrollToBottom = useCallback(() => {\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({ behavior: 'smooth', block: 'end' });\n    } else if (messagesContainerRef.current) {\n      const container = messagesContainerRef.current;\n      container.scrollTop = container.scrollHeight;\n    }\n  }, []);\n\n  // تم حذف useLayoutEffect تمامًا — كان هو سبب المشكلة\n  // useLayoutEffect كان بيشتغل كل ما الرسائل تتحدث → يرجعك للآخر\n\n  // Scroll فقط عند فتح المحادثة\n  useEffect(() => {\n    if (selectedOrderForMessages) {\n      const timer = setTimeout(() => {\n        scrollToBottom();\n      }, 150);\n      return () => clearTimeout(timer);\n    }\n  }, [selectedOrderForMessages, scrollToBottom]);\n\n  // Socket authentication & connection management\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      setError('يرجى تسجيل الدخول');\n      navigate('/login');\n      return;\n    }\n    try {\n      const payload = JSON.parse(atob(token.split('.')[1]));\n      socketRef.current = io(process.env.REACT_APP_API_URL, { autoConnect: false });\n      const socket = socketRef.current;\n      socket.connect();\n      socket.emit('authenticate', { userId: payload.id, role: payload.role });\n      socket.on('connect', () => {\n        console.log('Socket connected successfully');\n        if (currentOrderIdRef.current) {\n          socket.emit('joinOrder', currentOrderIdRef.current);\n        }\n      });\n      socket.on('error', (err) => {\n        console.error('Socket.IO error:', err);\n        setError(`خطأ في الاتصال: ${err.message || 'غير معروف'}`);\n      });\n      socket.on('orderJoined', ({ orderId }) => {\n        console.log(`Successfully joined order room: ${orderId}`);\n      });\n      socket.on('disconnect', () => {\n        console.log('Socket disconnected');\n      });\n      return () => {\n        if (socket.connected) {\n          socket.disconnect();\n        }\n      };\n    } catch (e) {\n      console.error('Token decode error:', e);\n      setError('خطأ في التوثيق، يرجى تسجيل الدخول مرة أخرى');\n      localStorage.removeItem('token');\n      localStorage.removeItem('role');\n      localStorage.removeItem('userId');\n      navigate('/login');\n    }\n  }, [navigate]);\n\n  // Fetch orders with full dependencies\n  const fetchOrders = useCallback(() => {\n    setLoading(true);\n    const token = localStorage.getItem('token');\n    if (!token) {\n      setError('يرجى تسجيل الدخول لجلب الطلبات');\n      navigate('/login');\n      return;\n    }\n    let url = `${process.env.REACT_APP_API_URL}/api/orders`;\n    const params = new URLSearchParams();\n    if (vendorSearch) params.append('vendorName', vendorSearch);\n    if (phoneSearch) params.append('phone', phoneSearch);\n    if (orderNumberSearch) params.append('orderNumber', orderNumberSearch);\n    if (startDate) params.append('startDate', startDate);\n    if (endDate) params.append('endDate', endDate);\n    if (statusFilters.rejected) params.append('status', 'rejected');\n    if (statusFilters.shipped) params.append('status', 'shipped');\n    if (statusFilters.delivered) params.append('status', 'delivered');\n    params.append('page', page);\n    params.append('limit', limit);\n    if (params.toString()) url += `?${params.toString()}`;\n    axios\n      .get(url, {\n        headers: { Authorization: `Bearer ${token}` },\n      })\n      .then(res => {\n        console.log('Fetched orders:', res.data);\n        setOrders(res.data.orders || []);\n        setTotal(res.data.total || 0);\n        setError(null);\n      })\n      .catch(err => {\n        console.error('Fetch orders error:', err);\n        const errorMessage = err.response?.data?.message || 'خطأ في جلب الطلبات: ' + err.message;\n        setError(errorMessage);\n        if (err.response?.status === 401) {\n          setError('غير مصرح: يرجى تسجيل الدخول مرة أخرى');\n          localStorage.removeItem('token');\n          localStorage.removeItem('role');\n          localStorage.removeItem('userId');\n          navigate('/login');\n        }\n      })\n      .finally(() => {\n        setLoading(false);\n      });\n  }, [vendorSearch, phoneSearch, orderNumberSearch, startDate, endDate, statusFilters, page, navigate]);\n\n  // Trigger fetch on dependency change\n  useEffect(() => {\n    fetchOrders();\n  }, [fetchOrders]);\n\n  // Messages modal socket handling (full cleanup and real-time updates)\n  useEffect(() => {\n    if (!selectedOrderForMessages || !socketRef.current) {\n      if (currentOrderIdRef.current && socketRef.current) {\n        socketRef.current.emit('leaveOrder', currentOrderIdRef.current);\n        currentOrderIdRef.current = null;\n      }\n      return;\n    }\n    const orderId = selectedOrderForMessages._id;\n    currentOrderIdRef.current = orderId;\n    socketRef.current.emit('joinOrder', orderId);\n    const token = localStorage.getItem('token');\n\n    // تم تعديل هذا الجزء: تحديث القراءة أولًا + Scroll بعد التحديث\n    axios\n      .post(\n        `${process.env.REACT_APP_API_URL}/api/orders/${orderId}/markRead`,\n        {},\n        {\n          headers: { Authorization: `Bearer ${token}` },\n        }\n      )\n      .then(res => {\n        setOrders(prevOrders =>\n          prevOrders.map(o => (o._id === orderId ? { ...o, unreadCount: 0 } : o))\n        );\n        setSelectedOrderForMessages(prev => ({\n          ...prev,\n          messages: res.data.order.messages || [],\n          unreadCount: 0,\n        }));\n        // Scroll فقط عند الفتح — تم حذفه من هنا\n      })\n      .catch(err => {\n        console.error('Mark read error:', err);\n        setError('خطأ في تحديث حالة القراءة');\n      });\n\n    const handleNewMessage = (message) => {\n      if (message.orderId !== orderId) return;\n      setSelectedOrderForMessages(prev => {\n        const exists = prev.messages?.some(m => m._id === message._id);\n        if (exists) return prev;\n        const newMessages = [...(prev.messages || []), message];\n        // Scroll فقط لما ترسل أنت — مش هنا\n        return { ...prev, messages: newMessages };\n      });\n      if (message.from !== getUserRole()) {\n        setOrders(prevOrders =>\n          prevOrders.map(o =>\n            o._id === orderId\n              ? { ...o, unreadCount: (o.unreadCount || 0) + 1 }\n              : o\n          )\n        );\n      }\n    };\n\n    const handleMessagesUpdated = (data) => {\n      if (data.orderId !== orderId) return;\n      setSelectedOrderForMessages(prev => ({\n        ...prev,\n        messages: data.messages || [],\n        unreadCount: data.messages.filter(msg => !msg.isRead && msg.from !== getUserRole()).length,\n      }));\n      // Scroll فقط لما ترسل — مش هنا\n    };\n\n    const handleUnreadUpdate = ({ orderId: updatedId, unreadCount }) => {\n      setOrders(prev =>\n        prev.map(o => (o._id === updatedId ? { ...o, unreadCount } : o))\n      );\n      if (updatedId === orderId) {\n        setSelectedOrderForMessages(prev => ({ ...prev, unreadCount }));\n      }\n    };\n\n    const socket = socketRef.current;\n    socket.on('newMessage', handleNewMessage);\n    socket.on('messagesUpdated', handleMessagesUpdated);\n    socket.on('unreadUpdate', handleUnreadUpdate);\n\n    return () => {\n      socket.off('newMessage', handleNewMessage);\n      socket.off('messagesUpdated', handleMessagesUpdated);\n      socket.off('unreadUpdate', handleUnreadUpdate);\n      socket.emit('leaveOrder', orderId);\n      currentOrderIdRef.current = null;\n    };\n  }, [selectedOrderForMessages]);\n\n  // Delete order handler\n  const handleDeleteOrder = (id) => {\n    if (!window.confirm('هل تريد حذف هذا الطلب؟')) return;\n    const token = localStorage.getItem('token');\n    if (!token) {\n      setError('يرجى تسجيل الدخول لتتمكن من حذف الطلبات');\n      navigate('/login');\n      return;\n    }\n    axios\n      .delete(`${process.env.REACT_APP_API_URL}/api/orders/${id}`, {\n        headers: { Authorization: `Bearer ${token}` },\n      })\n      .then(() => {\n        setOrders(prev => prev.filter(o => o._id !== id));\n        setError(null);\n        alert('تم حذف الطلب بنجاح');\n      })\n      .catch(err => {\n        const errorMessage = err.response?.data?.message || 'خطأ في الحذف: ' + err.message;\n        setError(errorMessage);\n        if (err.response?.status === 401) {\n          setError('غير مصرح: يرجى تسجيل الدخول مرة أخرى');\n          localStorage.removeItem('token');\n          localStorage.removeItem('role');\n          localStorage.removeItem('userId');\n          navigate('/login');\n        }\n      });\n  };\n\n  // Update status handler\n  const handleUpdateStatus = (id, status) => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      setError('يرجى تسجيل الدخول لتتمكن من تحديث حالة الطلب');\n      navigate('/login');\n      return;\n    }\n    axios\n      .put(\n        `${process.env.REACT_APP_API_URL}/api/orders/${id}/status`,\n        { status },\n        {\n          headers: { Authorization: `Bearer ${token}` },\n        }\n      )\n      .then(res => {\n        setOrders(prev => prev.map(o => (o._id === id ? res.data.order : o)));\n        setError(null);\n        alert('تم تحديث حالة الطلب بنجاح');\n      })\n      .catch(err => {\n        const errorMessage = err.response?.data?.message || 'خطأ في التحديث: ' + err.message;\n        setError(errorMessage);\n        if (err.response?.status === 401) {\n          setError('غير مصرح: يرجى تسجيل الدخول مرة أخرى');\n          localStorage.removeItem('token');\n          localStorage.removeItem('role');\n          localStorage.removeItem('userId');\n          navigate('/login');\n        }\n      });\n  };\n\n  // Edit order handlers\n  const handleEditOrder = (order) => {\n    setEditOrder(order);\n    setEditForm({ quantity: order.quantity || 1, address: order.address || '' });\n  };\n\n  const handleEditSubmit = () => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      setError('يرجى تسجيل الدخول لتتمكن من تعديل الطلب');\n      navigate('/login');\n      return;\n    }\n    axios\n      .put(\n        `${process.env.REACT_APP_API_URL}/api/orders/${editOrder._id}`,\n        editForm,\n        {\n          headers: { Authorization: `Bearer ${token}` },\n        }\n      )\n      .then(res => {\n        setOrders(prev => prev.map(o => (o._id === editOrder._id ? res.data.order : o)));\n        setEditOrder(null);\n        setEditForm({ quantity: 1, address: '' });\n        setError(null);\n        alert('تم تعديل الطلب بنجاح');\n      })\n      .catch(err => {\n        const errorMessage = err.response?.data?.message || 'خطأ في تعديل الطلب: ' + err.message;\n        setError(errorMessage);\n        if (err.response?.status === 401) {\n          setError('غير مصرح: يرجى تسجيل الدخول مرة أخرى');\n          localStorage.removeItem('token');\n          localStorage.removeItem('role');\n          localStorage.removeItem('userId');\n          navigate('/login');\n        }\n      });\n  };\n\n  // Media handlers\n  const openMedia = (media) => {\n    if (media) {\n      setSelectedMedia({ url: `${process.env.REACT_APP_API_URL}/Uploads/${media}`, type: 'image' });\n    }\n  };\n  const closeMedia = () => setSelectedMedia(null);\n\n  // Group orders function (full logic preserved)\n  const groupOrders = useCallback((ordersList, role) => {\n    if (role === 'customer') return ordersList;\n    const grouped = {};\n    ordersList.forEach(order => {\n      const key = `${order.product._id}-${order.user._id}-${order.address}`;\n      if (!grouped[key]) {\n        grouped[key] = {\n          ...order,\n          quantity: 0,\n          orderIds: [],\n          selectedImages: new Set(),\n          messages: [],\n          unreadCount: 0,\n        };\n      }\n      grouped[key].quantity += order.quantity;\n      grouped[key].orderIds.push(order._id);\n      grouped[key].messages = grouped[key].messages.concat(order.messages || []);\n      if (order.selectedImage) {\n        grouped[key].selectedImages.add(order.selectedImage);\n      }\n      if (order.messages) {\n        const unread = order.messages.filter(msg => !msg.isRead && msg.from !== role).length;\n        grouped[key].unreadCount += unread;\n      }\n    });\n    for (let key in grouped) {\n      grouped[key].messages.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));\n    }\n    return Object.values(grouped).map(group => ({\n      ...group,\n      selectedImage: Array.from(group.selectedImages)[0] || 'placeholder-image.jpg',\n      isGrouped: group.orderIds.length > 1,\n      totalOrders: group.orderIds.length,\n      unreadCount: group.unreadCount,\n    }));\n  }, []);\n\n  // Export to Word (full function preserved)\n  const exportToWord = async () => {\n    try {\n      const token = localStorage.getItem('token');\n      let url = `${process.env.REACT_APP_API_URL}/api/orders`;\n      const params = new URLSearchParams();\n      if (vendorSearch) params.append('vendorName', vendorSearch);\n      if (phoneSearch) params.append('phone', phoneSearch);\n      if (orderNumberSearch) params.append('orderNumber', orderNumberSearch);\n      if (startDate) params.append('startDate', startDate);\n      if (endDate) params.append('endDate', endDate);\n      if (statusFilters.rejected) params.append('status', 'rejected');\n      if (statusFilters.shipped) params.append('status', 'shipped');\n      if (statusFilters.delivered) params.append('status', 'delivered');\n      if (params.toString()) url += `?${params.toString()}`;\n      const res = await axios.get(url, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      const allOrders = res.data.orders || res.data;\n      const grouped = groupOrders(allOrders, getUserRole());\n      const doc = new Document({\n        sections: [\n          {\n            children: [\n              new Paragraph({\n                children: [\n                  new TextRun({ text: 'قائمة الطلبات', size: 32, bold: true, rtl: true }),\n                ],\n                alignment: 'right',\n                spacing: { after: 200 },\n              }),\n              new Table({\n                rows: [\n                  new TableRow({\n                    children: [\n                      new TableCell({\n                        children: [new Paragraph({ text: 'رقم الطلب', rtl: true, bold: true })],\n                        width: { size: 10, type: WidthType.PERCENTAGE },\n                      }),\n                      new TableCell({\n                        children: [new Paragraph({ text: 'الصورة', rtl: true, bold: true })],\n                        width: { size: 12, type: WidthType.PERCENTAGE },\n                      }),\n                      new TableCell({\n                        children: [new Paragraph({ text: 'العميل', rtl: true, bold: true })],\n                        width: { size: 12, type: WidthType.PERCENTAGE },\n                      }),\n                      new TableCell({\n                        children: [new Paragraph({ text: 'رقم الهاتف', rtl: true, bold: true })],\n                        width: { size: 12, type: WidthType.PERCENTAGE },\n                      }),\n                      new TableCell({\n                        children: [new Paragraph({ text: 'العنوان', rtl: true, bold: true })],\n                        width: { size: 15, type: WidthType.PERCENTAGE },\n                      }),\n                      new TableCell({\n                        children: [new Paragraph({ text: 'المنتج', rtl: true, bold: true })],\n                        width: { size: 12, type: WidthType.PERCENTAGE },\n                      }),\n                      new TableCell({\n                        children: [new Paragraph({ text: 'التاجر', rtl: true, bold: true })],\n                        width: { size: 12, type: WidthType.PERCENTAGE },\n                      }),\n                      new TableCell({\n                        children: [new Paragraph({ text: 'تاريخ الطلب', rtl: true, bold: true })],\n                        width: { size: 12, type: WidthType.PERCENTAGE },\n                      }),\n                      new TableCell({\n                        children: [new Paragraph({ text: 'الحالة', rtl: true, bold: true })],\n                        width: { size: 12, type: WidthType.PERCENTAGE },\n                      }),\n                      new TableCell({\n                        children: [new Paragraph({ text: 'الكمية', rtl: true, bold: true })],\n                        width: { size: 13, type: WidthType.PERCENTAGE },\n                      }),\n                    ],\n                  }),\n                  ...grouped.map(order =>\n                    new TableRow({\n                      children: [\n                        new TableCell({\n                          children: [\n                            new Paragraph({ text: (order.orderNumber || '-').toString(), rtl: true }),\n                          ],\n                        }),\n                        new TableCell({\n                          children: [\n                            new Paragraph({\n                              text: order.selectedImage || 'placeholder-image.jpg',\n                              rtl: true,\n                            }),\n                          ],\n                        }),\n                        new TableCell({\n                          children: [new Paragraph({ text: order.user?.name || 'زائر', rtl: true })],\n                        }),\n                        new TableCell({\n                          children: [new Paragraph({ text: order.user?.phone || '-', rtl: true })],\n                        }),\n                        new TableCell({\n                          children: [new Paragraph({ text: order.address || '-', rtl: true })],\n                        }),\n                        new TableCell({\n                          children: [\n                            new Paragraph({ text: order.product?.name || 'غير معروف', rtl: true }),\n                          ],\n                        }),\n                        new TableCell({\n                          children: [\n                            new Paragraph({\n                              text: order.product?.vendor?.name || 'غير معروف',\n                              rtl: true,\n                            }),\n                          ],\n                        }),\n                        new TableCell({\n                          children: [\n                            new Paragraph({\n                              text: new Date(order.createdAt).toLocaleDateString('ar-EG') || '-',\n                              rtl: true,\n                            }),\n                          ],\n                        }),\n                        new TableCell({\n                          children: [\n                            new Paragraph({\n                              text:\n                                {\n                                  pending: 'تحت المراجعة',\n                                  shipped: 'جاري الشحن',\n                                  delivered: 'تم التسليم',\n                                  rejected: 'مرفوض',\n                                }[order.status] || 'غير معروف',\n                              rtl: true,\n                            }),\n                          ],\n                        }),\n                        new TableCell({\n                          children: [\n                            new Paragraph({\n                              text: order.isGrouped ? `${order.quantity} (مجمع)` : order.quantity.toString(),\n                              rtl: true,\n                            }),\n                          ],\n                        }),\n                      ],\n                    })\n                  ),\n                ],\n                width: { size: 100, type: WidthType.PERCENTAGE },\n              }),\n            ],\n          },\n        ],\n      });\n      const blob = await Packer.toBlob(doc);\n      saveAs(blob, 'orders.docx');\n      setError(null);\n    } catch (error) {\n      console.error('Export to Word error:', error);\n      setError('خطأ في تصدير الـ Word: ' + error.message);\n    }\n  };\n\n  // Send message handler (full with FormData)\n  const handleSendMessage = async (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const token = localStorage.getItem('token');\n    if (!token) {\n      setError('يرجى تسجيل الدخول');\n      navigate('/login');\n      return;\n    }\n    if (!newMessage.trim() && !newImage) {\n      setError('يجب إدخال رسالة أو رفع صورة');\n      return;\n    }\n    const formData = new FormData();\n    if (newMessage.trim()) formData.append('text', newMessage.trim());\n    if (newImage) formData.append('image', newImage);\n    try {\n      const res = await axios.post(\n        `${process.env.REACT_APP_API_URL}/api/orders/${selectedOrderForMessages._id}/message`,\n        formData,\n        {\n          headers: {\n            Authorization: `Bearer ${token}`,\n            'Content-Type': 'multipart/form-data',\n          },\n        }\n      );\n      setSelectedOrderForMessages(prev => ({\n        ...prev,\n        messages: res.data.order.messages || [],\n      }));\n      setNewMessage('');\n      setNewImage(null);\n      setNewImagePreview(null);\n      setError(null);\n      // Scroll بعد الإرسال فقط\n      setTimeout(() => {\n        scrollToBottom();\n      }, 100);\n    } catch (err) {\n      const errorMessage = err.response?.data?.message || 'خطأ في إرسال الرسالة';\n      setError(errorMessage);\n    }\n  };\n\n  // Messages modal open/close\n  const openMessages = (order) => {\n    setSelectedOrderForMessages(order);\n  };\n  const closeMessages = () => {\n    setSelectedOrderForMessages(null);\n    setNewMessage('');\n    setNewImage(null);\n    setNewImagePreview(null);\n  };\n\n  // User role getter\n  const getUserRole = () => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      try {\n        const payload = JSON.parse(atob(token.split('.')[1]));\n        return payload.role || 'user';\n      } catch (e) {\n        console.error('Error decoding token:', e);\n        setError('خطأ في فك تشفير التوكن، يرجى تسجيل الدخول مرة أخرى');\n        localStorage.removeItem('token');\n        localStorage.removeItem('role');\n        localStorage.removeItem('userId');\n        navigate('/login');\n        return 'user';\n      }\n    }\n    return 'user';\n  };\n  const userRole = getUserRole();\n\n  // Display orders with filters\n  const rawDisplayOrders = showUnreadOnly ? orders.filter(o => (o.unreadCount || 0) > 0) : orders;\n  const displayOrders = groupOrders(rawDisplayOrders, userRole);\n\n  // Animation variants (preserved but simplified for performance)\n  const tableVariants = {\n    hidden: { opacity: 0, y: 20 },\n    visible: {\n      opacity: 1,\n      y: 0,\n      transition: { duration: 0.4, staggerChildren: 0.05 },\n    },\n  };\n  const rowVariants = {\n    hidden: { opacity: 0, x: -20 },\n    visible: { opacity: 1, x: 0, transition: { duration: 0.3 } },\n  };\n  const buttonVariants = {\n    hover: { scale: 1.05, boxShadow: '0 8px 16px rgba(255,0,0,0.3)' },\n    tap: { scale: 0.95 },\n  };\n  const modalVariants = {\n    hidden: { opacity: 0, scale: 0.85 },\n    visible: { opacity: 1, scale: 1, transition: { duration: 0.25 } },\n    exit: { opacity: 0, scale: 0.85, transition: { duration: 0.2 } },\n  };\n\n  return (\n    <motion.div\n      className=\"min-h-screen flex flex-col items-center bg-[#18191a] p-4 sm:p-6 text-white overflow-x-hidden\"\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      transition={{ duration: 0.5 }}\n    >\n      {/* Header */}\n      <h1 className=\"text-3xl sm:text-4xl md:text-5xl font-bold mb-8 text-center bg-clip-text text-transparent bg-gradient-to-r from-red-500 to-red-700 drop-shadow-lg\">\n        قائمة الطلبات\n      </h1>\n      {/* Error Display */}\n      {error && (\n        <motion.div\n          className=\"w-full max-w-4xl bg-red-900/90 text-white p-4 rounded-2xl mb-6 text-center font-medium shadow-2xl\"\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          exit={{ opacity: 0, y: -20 }}\n          transition={{ duration: 0.3 }}\n        >\n          {error}\n          <button\n            onClick={() => setError(null)}\n            className=\"ml-4 text-xl font-bold\"\n          >\n            ×\n          </button>\n        </motion.div>\n      )}\n      {/* Filters Section (for non-customer) */}\n      {userRole !== 'customer' && (\n        <div className=\"w-full max-w-7xl mb-8 bg-[#242526] p-6 rounded-2xl shadow-2xl border border-gray-700\">\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 mb-6\">\n            <input\n              type=\"text\"\n              placeholder=\"ابحث باسم التاجر\"\n              value={vendorSearch}\n              onChange={(e) => setVendorSearch(e.target.value)}\n              className=\"p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 transition\"\n            />\n            <input\n              type=\"text\"\n              placeholder=\"ابحث برقم الهاتف\"\n              value={phoneSearch}\n              onChange={(e) => setPhoneSearch(e.target.value)}\n              className=\"p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 transition\"\n            />\n            <input\n              typeauth=\"text\"\n              placeholder=\"ابحث برقم الطلب\"\n              value={orderNumberSearch}\n              onChange={(e) => setOrderNumberSearch(e.target.value)}\n              className=\"p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 transition\"\n            />\n            <input\n              type=\"date\"\n              value={startDate}\n              onChange={(e) => setStartDate(e.target.value)}\n              className=\"p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 transition\"\n            />\n            <input\n              type=\"date\"\n              value={endDate}\n              onChange={(e) => setEndDate(e.target.value)}\n              className=\"p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 transition\"\n            />\n          </div>\n          <div className=\"flex flex-wrap items-center gap-4 mb-6\">\n            <span className=\"text-gray-300 font-medium\">فلتر الحالة:</span>\n            {['rejected', 'shipped', 'delivered'].map(status => (\n              <label key={status} className=\"flex items-center space-x-2 space-x-reverse cursor-pointer\">\n                <input\n                  type=\"checkbox\"\n                  checked={statusFilters[status]}\n                  onChange={(e) => setStatusFilters(prev => ({ ...prev, [status]: e.target.checked }))}\n                  className=\"w-5 h-5 text-red-600 rounded focus:ring-red-500 accent-red-600\"\n                />\n                <span className=\"text-white\">\n                  {status === 'rejected' ? 'مرفوض' : status === 'shipped' ? 'جاري الشحن' : 'تم التسليم'}\n                </span>\n              </label>\n            ))}\n            <label className=\"flex items-center space-x-2 space-x-reverse cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={showUnreadOnly}\n                onChange={(e) => setShowUnreadOnly(e.target.checked)}\n                className=\"w-5 h-5 text-red-600 rounded focus:ring-red-500 accent-red-600\"\n              />\n              <span className=\"text-white\">الطلبات التي بها رسائل غير مقروءة فقط</span>\n            </label>\n          </div>\n          <div className=\"flex flex-wrap gap-4\">\n            <motion.button\n              onClick={fetchOrders}\n              className=\"px-8 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-xl text-lg\"\n              variants={buttonVariants}\n              whileHover=\"hover\"\n              whileTap=\"tap\"\n            >\n              بحث\n            </motion.button>\n            <motion.button\n              onClick={exportToWord}\n              className=\"px-8 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-xl text-lg\"\n              variants={buttonVariants}\n              whileHover=\"hover\"\n              whileTap=\"tap\"\n            >\n              تصدير إلى Word\n            </motion.button>\n          </div>\n        </div>\n      )}\n      {/* Loading / Empty / Table */}\n      <AnimatePresence mode=\"wait\">\n        {loading && (\n          <motion.p\n            key=\"loading\"\n            className=\"text-2xl text-gray-400 py-12\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n          >\n            جاري التحميل...\n          </motion.p>\n        )}\n        {!loading && displayOrders.length === 0 && (\n          <motion.p\n            key=\"no-orders\"\n            className=\"text-2xl text-gray-400 py-12\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n          >\n            لا توجد طلبات حالياً.\n          </motion.p>\n        )}\n        {!loading && displayOrders.length > 0 && (\n          <motion.div\n            key=\"table-container\"\n            className=\"w-full max-w-7xl overflow-x-auto bg-[#242526] rounded-2xl shadow-2xl border border-gray-700\"\n            variants={tableVariants}\n            initial=\"hidden\"\n            animate=\"visible\"\n          >\n            <table className=\"min-w-full divide-y divide-gray-700\">\n              <thead className=\"bg-[#3a3b3c]\">\n                <tr>\n                  <th className=\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\">رقم الطلب</th>\n                  <th className=\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\">الصورة</th>\n                  <th className=\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\">العميل</th>\n                  <th className=\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\">رقم الهاتف</th>\n                  <th className=\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\">العنوان</th>\n                  <th className=\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\">المنتج</th>\n                  <th className=\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\">التاجر</th>\n                  <th className=\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\">تاريخ الطلب</th>\n                  <th className=\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\">الحالة</th>\n                  <th className=\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\">الكمية</th>\n                  <th className=\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\">الرسائل غير المقروءة</th>\n                  <th className=\"py-5 px-6 text-right text-sm font-bold text-gray-300 uppercase tracking-wider\">إجراءات</th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-[#242526] divide-y divide-gray-700\">\n                {displayOrders.map((order, idx) => (\n                  <motion.tr\n                    key={order.isGrouped ? `group-${idx}` : order._id}\n                    className=\"hover:bg-[#3a3b3c] transition duration-200\"\n                    variants={rowVariants}\n                  >\n                    <td className=\"py-4 px-6 text-right text-sm\">{order.orderNumber || '-'}</td>\n                    <td className=\"py-4 px-6 text-center\">\n                      <img\n                        src={`${process.env.REACT_APP_API_URL}/Uploads/${order.selectedImage}`}\n                        alt=\"صورة الطلب\"\n                        className=\"w-20 h-20 object-cover rounded-xl mx-auto cursor-pointer shadow-md hover:shadow-xl transition\"\n                        onClick={() => openMedia(order.selectedImage)}\n                        onError={(e) => {\n                          e.target.onerror = null;\n                          e.target.src = `${process.env.REACT_APP_API_URL}/Uploads/placeholder-image.jpg`;\n                        }}\n                      />\n                    </td>\n                    <td className=\"py-4 px-6 text-right font-medium\">{order.user?.name || 'زائر'}</td>\n                    <td className=\"py-4 px-6 text-right\">{order.user?.phone || '-'}</td>\n                    <td className=\"py-4 px-6 text-right text-ellipsis overflow-hidden max-w-xs\">{order.address || '-'}</td>\n                    <td className=\"py-4 px-6 text-right\">{order.product?.name || 'غير معروف'}</td>\n                    <td className=\"py-4 px-6 text-right\">{order.product?.vendor?.name || 'غير معروف'}</td>\n                    <td className=\"py-4 px-6 text-right\">{new Date(order.createdAt).toLocaleDateString('ar-EG')}</td>\n                    <td className=\"py-4 px-6 text-right\">\n                      <span\n                        className={`px-4 py-2 rounded-full text-xs font-bold ${\n                          order.status === 'pending'\n                            ? 'bg-yellow-600/30 text-yellow-300 border border-yellow-600'\n                            : order.status === 'shipped'\n                            ? 'bg-blue-600/30 text-blue-300 border border-blue-600'\n                            : order.status === 'delivered'\n                            ? 'bg-green-600/30 text-green-300 border border-green-600'\n                            : 'bg-red-600/30 text-red-300 border border-red-600'\n                        }`}\n                      >\n                        {{\n                          pending: 'تحت المراجعة',\n                          shipped: 'جاري الشحن',\n                          delivered: 'تم التسليم',\n                          rejected: 'مرفوض',\n                        }[order.status] || 'غير معروف'}\n                      </span>\n                    </td>\n                    <td className=\"py-4 px-6 text-right font-bold text-yellow-400\">\n                      {order.quantity} {order.isGrouped && `(مجمع من ${order.totalOrders} طلب)`}\n                    </td>\n                    <td className=\"py-4 px-6 text-center\">\n                      <motion.button\n                        onClick={() => openMessages(order)}\n                        className={`w-12 h-12 rounded-full flex items-center justify-center text-white font-bold shadow-lg text-lg ${\n                          order.unreadCount > 0\n                            ? 'bg-gradient-to-r from-red-600 to-red-800 animate-pulse'\n                            : 'bg-gradient-to-r from-gray-600 to-gray-800'\n                        }`}\n                        variants={buttonVariants}\n                        whileHover=\"hover\"\n                        whileTap=\"tap\"\n                      >\n                        {order.unreadCount > 0 ? order.unreadCount : 0}\n                      </motion.button>\n                    </td>\n                    <td className=\"py-4 px-6\">\n                      <div className=\"flex items-center justify-end gap-3 flex-wrap\">\n                        {userRole === 'admin' && !order.isGrouped && (\n                          <>\n                            <motion.button\n                              className=\"px-5 py-2 rounded-xl text-white font-bold bg-gradient-to-r from-blue-600 to-blue-800 shadow-lg\"\n                              variants={buttonVariants}\n                              whileHover=\"hover\"\n                              whileTap=\"tap\"\n                              onClick={() => handleEditOrder(order)}\n                            >\n                              تعديل\n                            </motion.button>\n                            <motion.button\n                              onClick={() => handleDeleteOrder(order._id)}\n                              className=\"px-5 py-2 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-lg\"\n                              variants={buttonVariants}\n                              whileHover=\"hover\"\n                              whileTap=\"tap\"\n                            >\n                              حذف\n                            </motion.button>\n                          </>\n                        )}\n                        {userRole === 'vendor' && !order.isGrouped && (\n                          <motion.select\n                            value={order.status}\n                            onChange={(e) => handleUpdateStatus(order._id, e.target.value)}\n                            className=\"p-3 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm\"\n                            variants={buttonVariants}\n                            whileHover=\"hover\"\n                          >\n                            <option value=\"pending\">تحت المراجعة</option>\n                            <option value=\"shipped\">جاري الشحن</option>\n                            <option value=\"delivered\">تم التسليم</option>\n                            <option value=\"rejected\">مرفوض</option>\n                          </motion.select>\n                        )}\n                        {userRole === 'customer' && order.status === 'pending' && !order.isGrouped && (\n                          <>\n                            <motion.button\n                              className=\"px-5 py-2 rounded-xl text-white font-bold bg-gradient-to-r from-blue-600 to-blue-800 shadow-lg\"\n                              variants={buttonVariants}\n                              whileHover=\"hover\"\n                              whileTap=\"tap\"\n                              onClick={() => handleEditOrder(order)}\n                            >\n                              تعديل\n                            </motion.button>\n                            <motion.button\n                              onClick={() => handleDeleteOrder(order._id)}\n                              className=\"px-5 py-2 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-lg\"\n                              variants={buttonVariants}\n                              whileHover=\"hover\"\n                              whileTap=\"tap\"\n                            >\n                              حذف\n                            </motion.button>\n                          </>\n                        )}\n                      </div>\n                    </td>\n                  </motion.tr>\n                ))}\n              </tbody>\n            </table>\n          </motion.div>\n        )}\n      </AnimatePresence>\n      {/* Pagination */}\n      {!loading && total > limit && (\n        <div className=\"flex justify-center items-center gap-6 mt-8\">\n          <motion.button\n            onClick={() => setPage(prev => Math.max(1, prev - 1))}\n            disabled={page === 1}\n            className=\"px-8 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-xl disabled:opacity-50 disabled:cursor-not-allowed text-lg\"\n            variants={buttonVariants}\n            whileHover={page !== 1 ? \"hover\" : {}}\n            whileTap={page !== 1 ? \"tap\" : {}}\n          >\n            السابق\n          </motion.button>\n          <span className=\"text-xl text-gray-300\">\n            صفحة {page} من {Math.ceil(total / limit)}\n          </span>\n          <motion.button\n            onClick={() => setPage(prev => prev + 1)}\n            disabled={page * limit >= total}\n            className=\"px-8 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-xl disabled:opacity-50 disabled:cursor-not-allowed text-lg\"\n            variants={buttonVariants}\n            whileHover={page * limit < total ? \"hover\" : {}}\n            whileTap={page * limit < total ? \"tap\" : {}}\n          >\n            التالي\n          </motion.button>\n        </div>\n      )}\n      {/* Edit Modal */}\n      <AnimatePresence>\n        {editOrder && !editOrder.isGrouped && (\n          <motion.div\n            className=\"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4\"\n            variants={modalVariants}\n            initial=\"hidden\"\n            animate=\"visible\"\n            exit=\"exit\"\n            onClick={() => setEditOrder(null)}\n          >\n            <motion.div\n              className=\"bg-[#242526] p-8 rounded-2xl shadow-2xl border border-gray-700 w-full max-w-md\"\n              onClick={(e) => e.stopPropagation()}\n            >\n              <h2 className=\"text-3xl font-bold mb-8 text-right bg-clip-text text-transparent bg-gradient-to-r from-red-500 to-red-700\">\n                تعديل الطلب\n              </h2>\n              <div className=\"space-y-6\">\n                <input\n                  type=\"number\"\n                  placeholder=\"الكمية\"\n                  value={editForm.quantity}\n                  onChange={(e) => setEditForm({ ...editForm, quantity: parseInt(e.target.value) || 1 })}\n                  className=\"w-full p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 text-right text-lg\"\n                  min=\"1\"\n                />\n                <input\n                  type=\"text\"\n                  placeholder=\"العنوان\"\n                  value={editForm.address}\n                  onChange={(e) => setEditForm({ ...editForm, address: e.target.value })}\n                  className=\"w-full p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 text-right text-lg\"\n                />\n              </div>\n              <div className=\"flex gap-4 mt-8\">\n                <motion.button\n                  onClick={handleEditSubmit}\n                  className=\"flex-1 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-green-600 to-green-800 shadow-xl text-lg\"\n                  variants={buttonVariants}\n                  whileHover=\"hover\"\n                  whileTap=\"tap\"\n                >\n                  حفظ التعديلات\n                </motion.button>\n                <motion.button\n                  onClick={() => setEditOrder(null)}\n                  className=\"flex-1 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-xl text-lg\"\n                  variants={buttonVariants}\n                  whileHover=\"hover\"\n                  whileTap=\"tap\"\n                >\n                  إلغاء\n                </motion.button>\n              </div>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n      {/* Messages Modal – تم إضافة ref + عنصر وهمي في النهاية */}\n      <AnimatePresence>\n        {selectedOrderForMessages && (\n          <motion.div\n            className=\"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4\"\n            variants={modalVariants}\n            initial=\"hidden\"\n            animate=\"visible\"\n            exit=\"exit\"\n            onClick={closeMessages}\n          >\n            <motion.div\n              className=\"bg-[#242526] p-6 sm:p-8 rounded-2xl shadow-2xl border border-gray-700 w-full max-w-2xl max-h-[90vh] flex flex-col\"\n              onClick={(e) => e.stopPropagation()}\n            >\n              <h2 className=\"text-3xl font-bold mb-6 text-right bg-clip-text text-transparent bg-gradient-to-r from-red-500 to-red-700\">\n                الرسائل للطلب #{selectedOrderForMessages.orderNumber}\n              </h2>\n              {/* الـ Container مع ref */}\n              <div\n                ref={messagesContainerRef}\n                className=\"flex-1 overflow-y-auto mb-6 bg-[#3a3b3c] p-4 rounded-2xl shadow-inner\"\n                style={{ scrollBehavior: 'smooth' }}\n              >\n                {selectedOrderForMessages.messages && selectedOrderForMessages.messages.length > 0 ? (\n                  <div className=\"space-y-4\">\n                    {selectedOrderForMessages.messages.map((msg, index) => {\n                      const isMyMessage = msg.from === userRole;\n                      const senderName = msg.from === 'vendor' ? selectedOrderForMessages.product?.vendor?.name : selectedOrderForMessages.user?.name || 'غير معروف';\n                      return (\n                        <div\n                          key={msg._id || index}\n                          className={`flex ${isMyMessage ? 'justify-end' : 'justify-start'}`}\n                        >\n                          <div\n                            className={`max-w-xs sm:max-w-sm p-4 rounded-2xl shadow-md ${\n                              isMyMessage ? 'bg-gradient-to-r from-red-600 to-red-800 text-white' : 'bg-gray-700 text-white'\n                            }`}\n                          >\n                            <p className=\"font-bold text-sm opacity-90\">\n                              {msg.from === 'vendor' ? 'التاجر' : 'العميل'}: {senderName}\n                            </p>\n                            {msg.text && <p className=\"mt-2 text-lg\">{msg.text}</p>}\n                            {msg.image && (\n                              <img\n                                src={`${process.env.REACT_APP_API_URL}/Uploads/${msg.image}`}\n                                alt=\"صورة الرسالة\"\n                                className=\"mt-3 w-full max-w-48 object-cover rounded-xl cursor-pointer shadow-lg hover:shadow-xl transition\"\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  openMedia(msg.image);\n                                }}\n                                onError={(e) => {\n                                  e.target.onerror = null;\n                                  e.target.src = `${process.env.REACT_APP_API_URL}/Uploads/placeholder-image.jpg`;\n                                }}\n                              />\n                            )}\n                            <div className=\"flex items-center justify-between mt-3 text-xs opacity-70\">\n                              <p>{new Date(msg.timestamp).toLocaleString('ar-EG')}</p>\n                              {isMyMessage && (\n                                <span>\n                                  {msg.isRead ? '✓✓' : msg.isDelivered ? '✓' : '✓'}\n                                </span>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                      );\n                    })}\n                    {/* عنصر وهمي في النهاية للـ Scroll */}\n                    <div ref={messagesEndRef} />\n                  </div>\n                ) : (\n                  <p className=\"text-center text-gray-400 text-lg\">لا توجد رسائل بعد.</p>\n                )}\n              </div>\n              {(userRole === 'vendor' || userRole === 'customer') && (\n                <form onSubmit={handleSendMessage} className=\"space-y-4\">\n                  <textarea\n                    placeholder=\"اكتب رسالتك هنا...\"\n                    value={newMessage}\n                    onChange={(e) => setNewMessage(e.target.value)}\n                    className=\"w-full p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-red-500 text-right resize-none\"\n                    rows=\"4\"\n                  />\n                  <div className=\"flex items-center gap-4\">\n                    <input\n                      type=\"file\"\n                      accept=\"image/*\"\n                      onChange={(e) => setNewImage(e.target.files[0] || null)}\n                      className=\"text-sm text-gray-300 file:mr-4 file:py-3 file:px-6 file:rounded-xl file:border-0 file:bg-red-600 file:text-white hover:file:bg-red-700\"\n                    />\n                    {newImagePreview && (\n                      <div className=\"relative\">\n                        <img src={newImagePreview} alt=\"معاينة\" className=\"w-24 h-24 object-cover rounded-xl shadow-lg\" />\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setNewImage(null);\n                            setNewImagePreview(null);\n                          }}\n                          className=\"absolute top-0 right-0 bg-red-800 text-white rounded-full w-8 h-8 flex items-center justify-center text-xl\"\n                        >\n                          ×\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                  <motion.button\n                    type=\"submit\"\n                    className=\"w-full py-4 rounded-xl text-white font-bold bg-gradient-to-r from-red-600 to-red-800 shadow-xl text-lg\"\n                    variants={buttonVariants}\n                    whileHover=\"hover\"\n                    whileTap=\"tap\"\n                  >\n                    إرسال الرسالة\n                  </motion.button>\n                </form>\n              )}\n              <motion.button\n                onClick={closeMessages}\n                className=\"w-full mt-4 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-gray-700 to-gray-900 shadow-xl text-lg\"\n                variants={buttonVariants}\n                whileHover=\"hover\"\n                whileTap=\"tap\"\n              >\n                إغلاق\n              </motion.button>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n      {/* Media Viewer Modal */}\n      <AnimatePresence>\n        {selectedMedia && (\n          <motion.div\n            className=\"fixed inset-0 bg-black/90 flex items-center justify-center z-50 p-4\"\n            variants={modalVariants}\n            initial=\"hidden\"\n            animate=\"visible\"\n            exit=\"exit\"\n            onClick={closeMedia}\n          >\n            <motion.div className=\"relative max-w-4xl max-h-full\" onClick={(e) => e.stopPropagation()}>\n              <img\n                src={selectedMedia.url}\n                className=\"max-w-full max-h-full rounded-2xl shadow-2xl\"\n                alt=\"صورة مكبرة\"\n                onError={(e) => {\n                  e.target.onerror = null;\n                  e.target.src = `${process.env.REACT_APP_API_URL}/Uploads/placeholder-image.jpg`;\n                }}\n              />\n              <motion.button\n                onClick={closeMedia}\n                className=\"absolute top-4 right-4 text-white text-5xl bg-black/70 rounded-full w-14 h-14 flex items-center justify-center shadow-xl hover:bg-black/90 transition\"\n                variants={buttonVariants}\n                whileHover=\"hover\"\n                whileTap=\"tap\"\n              >\n                ×\n              </motion.button>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </motion.div>\n  );\n};\n\nexport default Orders;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}