{"ast":null,"code":"import _objectSpread from\"/root/shose/app-shose/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// frontend/src/pages/VendorProducts.js\nimport{useState,useEffect,useRef}from'react';import{motion,AnimatePresence}from'framer-motion';import{useParams,Link,useNavigate}from'react-router-dom';import axios from'axios';import{io}from'socket.io-client';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const VendorProducts=()=>{const{vendorId}=useParams();const[products,setProducts]=useState([]);const[filteredProducts,setFilteredProducts]=useState([]);const[filterType,setFilterType]=useState('');const[priceRange,setPriceRange]=useState({min:'',max:''});const[vendorName,setVendorName]=useState('');const[cart,setCart]=useState([]);const[showCartModal,setShowCartModal]=useState(false);const[showOrderForm,setShowOrderForm]=useState(false);const[orderForm,setOrderForm]=useState({address:''});const[selectedMedia,setSelectedMedia]=useState(null);const[currentMediaIndex,setCurrentMediaIndex]=useState({});const[currentMediaType,setCurrentMediaType]=useState({});const[showAddedToCart,setShowAddedToCart]=useState(false);const[error,setError]=useState('');const[previousOrders,setPreviousOrders]=useState([]);const[isSubmitting,setIsSubmitting]=useState(false);const intervalRefs=useRef({});const navigate=useNavigate();// === الرسائل ===\nconst[orders,setOrders]=useState([]);const[selectedOrderForMessages,setSelectedOrderForMessages]=useState(null);const[newMessage,setNewMessage]=useState('');const[newImage,setNewImage]=useState(null);const[newImagePreview,setNewImagePreview]=useState(null);const[showUnreadList,setShowUnreadList]=useState(false);const socketRef=useRef(null);const currentOrderIdRef=useRef(null);const messagesEndRef=useRef(null);// === Toast ===\nconst showToast=function(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'success';setError(type==='error'?message:'');if(type==='success'){setShowAddedToCart(true);setTimeout(()=>setShowAddedToCart(false),2000);}};// === Image preview effect ===\nuseEffect(()=>{if(newImage){const reader=new FileReader();reader.onloadend=()=>setNewImagePreview(reader.result);reader.readAsDataURL(newImage);}else{setNewImagePreview(null);}},[newImage]);// === Scroll to bottom ===\nconst scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};// === دالة جلب المنتجات (تُستخدم في كل الحالات) ===\nconst fetchProducts=()=>{const token=localStorage.getItem('token');if(!token)return;axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/products/vendor/\").concat(vendorId),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>{var _sorted$,_sorted$$vendor;const approved=res.data.filter(p=>p.approved);// ترتيب حسب updatedAt تنازليًا\nconst sorted=[...approved].sort((a,b)=>new Date(b.updatedAt)-new Date(a.updatedAt));setProducts(sorted);setFilteredProducts(sorted);setVendorName(((_sorted$=sorted[0])===null||_sorted$===void 0?void 0:(_sorted$$vendor=_sorted$.vendor)===null||_sorted$$vendor===void 0?void 0:_sorted$$vendor.name)||'تاجر غير معروف');const initialIndexes=sorted.reduce((acc,p)=>_objectSpread(_objectSpread({},acc),{},{[p._id]:0}),{});const initialTypes=sorted.reduce((acc,p)=>{var _p$videos;return _objectSpread(_objectSpread({},acc),{},{[p._id]:((_p$videos=p.videos)===null||_p$videos===void 0?void 0:_p$videos.length)>0?'video':'image'});},{});setCurrentMediaIndex(initialIndexes);setCurrentMediaType(initialTypes);setError('');}).catch(err=>{var _err$response,_err$response$data,_err$response2;showToast(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'خطأ في جلب المنتجات','error');if(((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.status)===401){localStorage.clear();navigate('/login');}});};// === جلب المنتجات + التحقق من الـ Token ===\nuseEffect(()=>{const token=localStorage.getItem('token');const role=localStorage.getItem('role');const userId=localStorage.getItem('userId');if(!token||!['admin','vendor','customer'].includes(role)){showToast('غير مصرح','error');navigate('/login');return;}fetchProducts();if(role==='customer'){const saved=localStorage.getItem('cart');if(saved)setCart(JSON.parse(saved));}if(role==='customer'&&userId){axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/user/\").concat(userId),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>setPreviousOrders(res.data)).catch(()=>{});}},[vendorId,navigate]);// === Socket.IO connection & product updates ===\nuseEffect(()=>{const token=localStorage.getItem('token');if(!token)return;try{const payload=JSON.parse(atob(token.split('.')[1]));socketRef.current=io(process.env.REACT_APP_API_URL,{autoConnect:false});const socket=socketRef.current;socket.connect();socket.emit('authenticate',{userId:payload.id,role:payload.role});socket.on('productUpdated',updatedProduct=>{if(updatedProduct.vendor._id!==vendorId&&updatedProduct.vendor!==vendorId)return;setProducts(prev=>{const exists=prev.some(p=>p._id===updatedProduct._id);const newList=exists?prev.map(p=>p._id===updatedProduct._id?updatedProduct:p):[updatedProduct,...prev.filter(p=>p._id!==updatedProduct._id)];return newList.sort((a,b)=>new Date(b.updatedAt)-new Date(a.updatedAt));});setFilteredProducts(prev=>{const exists=prev.some(p=>p._id===updatedProduct._id);const newList=exists?prev.map(p=>p._id===updatedProduct._id?updatedProduct:p):[updatedProduct,...prev.filter(p=>p._id!==updatedProduct._id)];let filtered=newList.filter(p=>p.approved&&(p.vendor._id===vendorId||p.vendor===vendorId));if(filterType){filtered=filtered.filter(p=>p.type===filterType);}if(priceRange.min||priceRange.max){const min=parseFloat(priceRange.min)||0;const max=parseFloat(priceRange.max)||Infinity;filtered=filtered.filter(p=>{const pairPrice=p.price/p.quantityPerCarton;return pairPrice>=min&&pairPrice<=max;});}return filtered.sort((a,b)=>new Date(b.updatedAt)-new Date(a.updatedAt));});});socket.on('productDeleted',_ref=>{let{_id}=_ref;setProducts(prev=>prev.filter(p=>p._id!==_id));setFilteredProducts(prev=>prev.filter(p=>p._id!==_id));});socket.on('connect',()=>{console.log('Socket reconnected in VendorProducts');fetchProducts();if(currentOrderIdRef.current){socket.emit('joinOrder',currentOrderIdRef.current);}});socket.on('error',err=>{showToast(\"\\u062E\\u0637\\u0623 \\u0641\\u064A \\u0627\\u0644\\u0627\\u062A\\u0635\\u0627\\u0644: \".concat(err.message||'غير معروف'),'error');});return()=>{if(socket.connected)socket.disconnect();};}catch(e){showToast('خطأ في التوثيق','error');localStorage.clear();navigate('/login');}},[navigate,vendorId,filterType,priceRange]);// === Fetch unread messages ===\nconst fetchUnreadOrders=()=>{const token=localStorage.getItem('token');if(!token)return;axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders?unreadOnly=true\"),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>setOrders(res.data.orders||[])).catch(err=>{var _err$response3;if(((_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.status)===401){localStorage.clear();navigate('/login');}});};useEffect(()=>{fetchUnreadOrders();},[]);// === Messages socket handling ===\nuseEffect(()=>{if(!selectedOrderForMessages||!socketRef.current){if(currentOrderIdRef.current&&socketRef.current){socketRef.current.emit('leaveOrder',currentOrderIdRef.current);currentOrderIdRef.current=null;}return;}const orderId=selectedOrderForMessages._id;currentOrderIdRef.current=orderId;socketRef.current.emit('joinOrder',orderId);const token=localStorage.getItem('token');axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/\").concat(orderId,\"/markRead\"),{},{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>{setOrders(prev=>prev.map(o=>o._id===orderId?_objectSpread(_objectSpread({},o),{},{unreadCount:0}):o));setSelectedOrderForMessages(prev=>_objectSpread(_objectSpread({},prev),{},{messages:res.data.order.messages||[],unreadCount:0}));}).catch(()=>{});const handleNewMessage=message=>{if(message.orderId!==orderId)return;setSelectedOrderForMessages(prev=>{var _prev$messages;const exists=(_prev$messages=prev.messages)===null||_prev$messages===void 0?void 0:_prev$messages.some(m=>m._id===message._id);if(exists)return prev;return _objectSpread(_objectSpread({},prev),{},{messages:[...(prev.messages||[]),message]});});if(message.from!==getUserRole()){setOrders(prev=>prev.map(o=>o._id===orderId?_objectSpread(_objectSpread({},o),{},{unreadCount:(o.unreadCount||0)+1}):o));}};const socket=socketRef.current;socket.on('newMessage',handleNewMessage);socket.on('messagesUpdated',data=>{if(data.orderId!==orderId)return;setSelectedOrderForMessages(prev=>_objectSpread(_objectSpread({},prev),{},{messages:data.messages||[],unreadCount:data.messages.filter(m=>!m.isRead&&m.from!==getUserRole()).length}));});socket.on('unreadUpdate',_ref2=>{let{orderId:updatedId,unreadCount}=_ref2;setOrders(prev=>prev.map(o=>o._id===updatedId?_objectSpread(_objectSpread({},o),{},{unreadCount}):o));if(updatedId===orderId){setSelectedOrderForMessages(prev=>_objectSpread(_objectSpread({},prev),{},{unreadCount}));}});return()=>{socket.off('newMessage',handleNewMessage);socket.emit('leaveOrder',orderId);currentOrderIdRef.current=null;};},[selectedOrderForMessages]);// === Send message ===\nconst handleSendMessage=async e=>{e.preventDefault();e.stopPropagation();const token=localStorage.getItem('token');if(!token||!newMessage.trim()&&!newImage){showToast('يجب إدخال رسالة أو رفع صورة','error');return;}const formData=new FormData();if(newMessage.trim())formData.append('text',newMessage.trim());if(newImage)formData.append('image',newImage);try{const res=await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/\").concat(selectedOrderForMessages._id,\"/message\"),formData,{headers:{Authorization:\"Bearer \".concat(token),'Content-Type':'multipart/form-data'}});setSelectedOrderForMessages(prev=>_objectSpread(_objectSpread({},prev),{},{messages:res.data.order.messages||[]}));setNewMessage('');setNewImage(null);setNewImagePreview(null);scrollToBottom();}catch(err){var _err$response4,_err$response4$data;showToast(((_err$response4=err.response)===null||_err$response4===void 0?void 0:(_err$response4$data=_err$response4.data)===null||_err$response4$data===void 0?void 0:_err$response4$data.message)||'خطأ في إرسال الرسالة','error');}};const openMessages=order=>{setSelectedOrderForMessages(order);setShowUnreadList(false);};const closeMessages=()=>{setSelectedOrderForMessages(null);setNewMessage('');setNewImage(null);setNewImagePreview(null);};const getUserRole=()=>{const token=localStorage.getItem('token');if(token){try{const payload=JSON.parse(atob(token.split('.')[1]));return payload.role||'user';}catch(e){localStorage.clear();navigate('/login');return'user';}}return'user';};const userRole=getUserRole();// === تصفية المنتجات ===\nuseEffect(()=>{let filtered=products.filter(p=>p.vendor._id===vendorId||p.vendor===vendorId);if(filterType){filtered=filtered.filter(p=>p.type===filterType);}if(priceRange.min||priceRange.max){const min=parseFloat(priceRange.min)||0;const max=parseFloat(priceRange.max)||Infinity;filtered=filtered.filter(p=>{const pairPrice=p.price/p.quantityPerCarton;return pairPrice>=min&&pairPrice<=max;});}setFilteredProducts(filtered.sort((a,b)=>new Date(b.updatedAt)-new Date(a.updatedAt)));},[filterType,priceRange,products,vendorId]);// === تدوير الصور تلقائيًا ===\nuseEffect(()=>{products.forEach(p=>{var _p$images;const totalImages=((_p$images=p.images)===null||_p$images===void 0?void 0:_p$images.length)||0;if(totalImages>1&&(!p.videos||p.videos.length===0)){clearInterval(intervalRefs.current[p._id]);intervalRefs.current[p._id]=setInterval(()=>{setCurrentMediaIndex(prev=>_objectSpread(_objectSpread({},prev),{},{[p._id]:(prev[p._id]+1)%totalImages}));setCurrentMediaType(prev=>_objectSpread(_objectSpread({},prev),{},{[p._id]:'image'}));},3000);}});return()=>Object.values(intervalRefs.current).forEach(clearInterval);},[products]);// === حفظ السلة ===\nuseEffect(()=>{if(localStorage.getItem('role')==='customer'){localStorage.setItem('cart',JSON.stringify(cart));}},[cart]);const addToCart=product=>{var _product$videos;const type=currentMediaType[product._id]||'image';if(type==='video'){showToast('يرجى اختيار صورة','error');return;}const imgIndex=(currentMediaIndex[product._id]||0)-(((_product$videos=product.videos)===null||_product$videos===void 0?void 0:_product$videos.length)||0);const selectedImage=product.images[imgIndex]||'placeholder-image.jpg';setCart(prev=>{const exists=prev.find(i=>i.product._id===product._id&&i.selectedImage===selectedImage);if(exists){return prev.map(i=>i.product._id===product._id&&i.selectedImage===selectedImage?_objectSpread(_objectSpread({},i),{},{quantity:i.quantity+1}):i);}return[...prev,{product,quantity:1,selectedImage}];});showToast('تمت الإضافة إلى السلة');};const updateCartQuantity=(id,img,qty)=>{if(qty<1)return;setCart(prev=>prev.map(i=>i.product._id===id&&i.selectedImage===img?_objectSpread(_objectSpread({},i),{},{quantity:qty}):i));};const removeFromCart=(id,img)=>{setCart(prev=>prev.filter(i=>!(i.product._id===id&&i.selectedImage===img)));};const handleOrderSubmit=()=>{if(isSubmitting||!orderForm.address)return;const token=localStorage.getItem('token');const userId=localStorage.getItem('userId');if(!token||!userId)return navigate('/login');let confirmSubmit=true;if(previousOrders.length>0){confirmSubmit=window.confirm('أنت طلبت الطلب مرة، هل تريد تأكيد طلبه مرة أخرى؟');}if(!confirmSubmit)return;setIsSubmitting(true);const promises=cart.map(item=>axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders\"),{product:item.product._id,vendor:item.product.vendor._id||item.product.vendor,quantity:item.quantity,user:userId,address:orderForm.address,selectedImage:item.selectedImage},{headers:{Authorization:\"Bearer \".concat(token)}}));Promise.all(promises).then(()=>{showToast('تم إنشاء الطلبات بنجاح');setCart([]);setShowOrderForm(false);setOrderForm({address:''});axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/orders/user/\").concat(userId),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>setPreviousOrders(res.data));}).catch(err=>{var _err$response5,_err$response5$data,_err$response6;showToast(((_err$response5=err.response)===null||_err$response5===void 0?void 0:(_err$response5$data=_err$response5.data)===null||_err$response5$data===void 0?void 0:_err$response5$data.message)||'خطأ في تقديم الطلب','error');if(((_err$response6=err.response)===null||_err$response6===void 0?void 0:_err$response6.status)===401){localStorage.clear();navigate('/login');}}).finally(()=>setIsSubmitting(false));};const openMedia=(media,type)=>{setSelectedMedia({url:\"\".concat(process.env.REACT_APP_API_URL,\"/Uploads/\").concat(media),type});};const closeMedia=()=>setSelectedMedia(null);const handlePrevMedia=(id,p)=>{var _p$videos2,_p$images2;const total=(((_p$videos2=p.videos)===null||_p$videos2===void 0?void 0:_p$videos2.length)||0)+(((_p$images2=p.images)===null||_p$images2===void 0?void 0:_p$images2.length)||0);setCurrentMediaIndex(prev=>{const next=(prev[id]-1+total)%total;setCurrentMediaType(t=>{var _p$videos3;return _objectSpread(_objectSpread({},t),{},{[id]:next<(((_p$videos3=p.videos)===null||_p$videos3===void 0?void 0:_p$videos3.length)||0)?'video':'image'});});return _objectSpread(_objectSpread({},prev),{},{[id]:next});});clearInterval(intervalRefs.current[id]);};const handleNextMedia=(id,p)=>{var _p$videos4,_p$images3;const total=(((_p$videos4=p.videos)===null||_p$videos4===void 0?void 0:_p$videos4.length)||0)+(((_p$images3=p.images)===null||_p$images3===void 0?void 0:_p$images3.length)||0);setCurrentMediaIndex(prev=>{const next=(prev[id]+1)%total;setCurrentMediaType(t=>{var _p$videos5;return _objectSpread(_objectSpread({},t),{},{[id]:next<(((_p$videos5=p.videos)===null||_p$videos5===void 0?void 0:_p$videos5.length)||0)?'video':'image'});});return _objectSpread(_objectSpread({},prev),{},{[id]:next});});clearInterval(intervalRefs.current[id]);};// === الأنيميشن ===\nconst cardVariants={hidden:{opacity:0,y:30,scale:0.95},visible:{opacity:1,y:0,scale:1,transition:{duration:0.7,ease:[0.22,1,0.36,1]}},hover:{scale:1.03,boxShadow:'0 12px 24px rgba(0, 0, 0, 0.2)'}};const buttonVariants={hover:{scale:1.05},tap:{scale:0.95}};const modalVariants={hidden:{opacity:0,scale:0.85},visible:{opacity:1,scale:1}};const toastVariants={hidden:{opacity:0,x:50},visible:{opacity:1,x:0},exit:{opacity:0,x:50}};const role=localStorage.getItem('role');const isCustomer=role==='customer';const totalUnread=orders.reduce((acc,o)=>acc+(o.unreadCount||0),0);const cartCount=cart.reduce((a,i)=>a+i.quantity,0);const openMessagesFromFloating=()=>{if(orders.length===1){openMessages(orders[0]);}else{setShowUnreadList(true);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-[#18191a] text-white p-4 relative overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"absolute inset-0 opacity-10\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-0 left-0 w-96 h-96 bg-purple-900 rounded-full blur-3xl animate-pulse\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-0 right-0 w-80 h-80 bg-purple-800 rounded-full blur-3xl animate-pulse delay-700\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative z-10 w-full max-w-7xl mx-auto\",children:[/*#__PURE__*/_jsxs(motion.div,{className:\"flex flex-col items-center mb-8\",initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:0.8},children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-3xl md:text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-purple-600\",children:[\"\\u0645\\u0646\\u062A\\u062C\\u0627\\u062A \\u0627\\u0644\\u062A\\u0627\\u062C\\u0631: \",vendorName]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-purple-300 text-lg mt-1\",children:\"\\u0627\\u0644\\u0645\\u0646\\u062A\\u062C\\u0627\\u062A \\u0627\\u0644\\u0645\\u062A\\u0627\\u062D\\u0629\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row justify-between items-center mb-8 gap-4\",children:[/*#__PURE__*/_jsxs(motion.select,{value:filterType,onChange:e=>setFilterType(e.target.value),className:\"p-3 rounded-xl bg-[#3a3b3c]/60 backdrop-blur-md border border-gray-600 text-white focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-500/30\",whileHover:{scale:1.03},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u0627\\u0644\\u0643\\u0644\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u0631\\u062C\\u0627\\u0644\\u064A\",children:\"\\u0631\\u062C\\u0627\\u0644\\u064A\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u062D\\u0631\\u064A\\u0645\\u064A\",children:\"\\u062D\\u0631\\u064A\\u0645\\u064A\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u0623\\u0637\\u0641\\u0627\\u0644\",children:\"\\u0623\\u0637\\u0641\\u0627\\u0644\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"\\u0645\\u0646 (\\u062C\\u0648\\u0632)\",value:priceRange.min,onChange:e=>setPriceRange(prev=>_objectSpread(_objectSpread({},prev),{},{min:e.target.value})),className:\"p-3 w-24 rounded-xl bg-[#3a3b3c]/60 border border-gray-600 text-white placeholder:text-gray-400 focus:outline-none focus:border-purple-500\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-400\",children:\"\\u0625\\u0644\\u0649\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"\\u0625\\u0644\\u0649 (\\u062C\\u0648\\u0632)\",value:priceRange.max,onChange:e=>setPriceRange(prev=>_objectSpread(_objectSpread({},prev),{},{max:e.target.value})),className:\"p-3 w-24 rounded-xl bg-[#3a3b3c]/60 border border-gray-600 text-white placeholder:text-gray-400 focus:outline-none focus:border-purple-500\"})]}),isCustomer&&/*#__PURE__*/_jsxs(motion.button,{onClick:()=>setShowCartModal(true),className:\"relative px-4 py-3 rounded-xl bg-gradient-to-r from-purple-600 to-purple-700 shadow-lg hover:from-purple-700 hover:to-purple-800 flex items-center gap-2\",variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-6 w-6\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z\"})}),cartCount>0&&/*#__PURE__*/_jsx(\"span\",{className:\"absolute -top-2 -right-2 bg-purple-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center\",children:cartCount})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\",children:filteredProducts.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"col-span-full text-center text-gray-400 text-xl\",children:\"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u0645\\u0646\\u062A\\u062C\\u0627\\u062A...\"}):filteredProducts.map(product=>{var _product$videos2,_product$images,_product$videos3,_product$videos5,_product$images2;return/*#__PURE__*/_jsxs(motion.div,{className:\"bg-[#242526]/80 backdrop-blur-xl rounded-2xl shadow-2xl border border-gray-700/50 overflow-hidden\",variants:cardVariants,initial:\"hidden\",whileInView:\"visible\",viewport:{once:true},whileHover:\"hover\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative aspect-square bg-[#3a3b3c]\",children:[currentMediaType[product._id]==='video'&&((_product$videos2=product.videos)===null||_product$videos2===void 0?void 0:_product$videos2.length)>0?/*#__PURE__*/_jsx(\"video\",{src:\"\".concat(process.env.REACT_APP_API_URL,\"/Uploads/\").concat(product.videos[currentMediaIndex[product._id]]),controls:true,className:\"w-full h-full object-contain\",onClick:()=>openMedia(product.videos[currentMediaIndex[product._id]],'video')}):((_product$images=product.images)===null||_product$images===void 0?void 0:_product$images.length)>0?/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(process.env.REACT_APP_API_URL,\"/Uploads/\").concat(product.images[(currentMediaIndex[product._id]||0)-(((_product$videos3=product.videos)===null||_product$videos3===void 0?void 0:_product$videos3.length)||0)]),alt:product.name,className:\"w-full h-full object-contain\",onClick:()=>{var _product$videos4;return openMedia(product.images[(currentMediaIndex[product._id]||0)-(((_product$videos4=product.videos)===null||_product$videos4===void 0?void 0:_product$videos4.length)||0)],'image');}}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full bg-[#3a3b3c] flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-500\",children:\"\\u0628\\u062F\\u0648\\u0646 \\u0635\\u0648\\u0631\\u0629\"})}),(((_product$videos5=product.videos)===null||_product$videos5===void 0?void 0:_product$videos5.length)||0)+(((_product$images2=product.images)===null||_product$images2===void 0?void 0:_product$images2.length)||0)>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-3 left-1/2 transform -translate-x-1/2 flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handlePrevMedia(product._id,product),className:\"bg-black/50 text-white p-2 rounded-full backdrop-blur-sm hover:bg-black/70 transition\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-6 w-6\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M15 19l-7-7 7-7\"})})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleNextMedia(product._id,product),className:\"bg-black/50 text-white p-2 rounded-full backdrop-blur-sm hover:bg-black/70 transition\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-6 w-6\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 5l7 7-7 7\"})})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-5 space-y-2 text-right\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-purple-600\",children:product.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-300 space-y-1\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0627\\u0644\\u0646\\u0648\\u0639: \",product.type]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0633\\u0639\\u0631 \\u0627\\u0644\\u0643\\u0631\\u062A\\u0648\\u0646\\u0629: \",product.price,\" \\u062C\\u0646\\u064A\\u0647\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0633\\u0639\\u0631 \\u0627\\u0644\\u062C\\u0648\\u0632: \",(product.price/product.quantityPerCarton).toFixed(2),\" \\u062C\\u0646\\u064A\\u0647\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0627\\u0644\\u0643\\u0631\\u062A\\u0648\\u0646\\u0629: \",product.quantityPerCarton,\" \\u062C\\u0648\\u0632\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0627\\u0644\\u0645\\u0635\\u0646\\u0639: \",product.manufacturer]})]}),isCustomer&&/*#__PURE__*/_jsx(motion.button,{onClick:()=>addToCart(product),className:\"w-full mt-4 py-3 rounded-xl text-white font-bold bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 shadow-lg\",variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",children:\"\\u0625\\u0636\\u0627\\u0641\\u0629 \\u0625\\u0644\\u0649 \\u0627\\u0644\\u0633\\u0644\\u0629\"})]})]},product._id);})})]}),/*#__PURE__*/_jsx(AnimatePresence,{children:showAddedToCart&&/*#__PURE__*/_jsx(motion.div,{className:\"fixed top-6 right-6 bg-green-600 text-white px-5 py-3 rounded-full shadow-xl flex items-center gap-2 z-50\",variants:toastVariants,initial:\"hidden\",animate:\"visible\",exit:\"hidden\",children:/*#__PURE__*/_jsx(\"span\",{children:\"\\u062A\\u0645\\u062A \\u0627\\u0644\\u0625\\u0636\\u0627\\u0641\\u0629\"})})}),/*#__PURE__*/_jsx(AnimatePresence,{children:showCartModal&&isCustomer&&/*#__PURE__*/_jsx(motion.div,{className:\"fixed inset-0 bg-black/80 flex items-center justify-center z-50\",variants:modalVariants,initial:\"hidden\",animate:\"visible\",exit:\"hidden\",onClick:()=>setShowCartModal(false),children:/*#__PURE__*/_jsxs(motion.div,{className:\"bg-[#242526]/90 backdrop-blur-xl p-8 rounded-3xl shadow-2xl border border-gray-700 w-full max-w-lg\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-purple-600 mb-6 text-right\",children:\"\\u0627\\u0644\\u0633\\u0644\\u0629\"}),cart.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-400\",children:\"\\u0627\\u0644\\u0633\\u0644\\u0629 \\u0641\\u0627\\u0631\\u063A\\u0629\"}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4 max-h-96 overflow-y-auto\",children:cart.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between gap-4 p-3 bg-[#3a3b3c]/50 rounded-xl\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(process.env.REACT_APP_API_URL,\"/Uploads/\").concat(item.selectedImage),alt:\"\",className:\"w-16 h-16 object-cover rounded-lg\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:item.product.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-400\",children:[\"\\u0633\\u0639\\u0631 \\u0627\\u0644\\u0643\\u0631\\u062A\\u0648\\u0646\\u0629: \",item.product.price,\" \\u062C\\u0646\\u064A\\u0647\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"1\",value:item.quantity,onChange:e=>updateCartQuantity(item.product._id,item.selectedImage,parseInt(e.target.value)),className:\"w-16 p-2 bg-[#3a3b3c] rounded text-center\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeFromCart(item.product._id,item.selectedImage),className:\"text-red-400 hover:text-red-300\",children:\"\\xD7\"})]})]},\"\".concat(item.product._id,\"-\").concat(item.selectedImage)))}),cart.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 mt-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowCartModal(false);setShowOrderForm(true);},className:\"flex-1 py-3 rounded-xl bg-gradient-to-r from-green-600 to-green-700 text-white font-bold\",children:\"\\u0637\\u0644\\u0628\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCartModal(false),className:\"flex-1 py-3 rounded-xl bg-gradient-to-r from-red-600 to-red-700 text-white font-bold\",children:\"\\u0625\\u063A\\u0644\\u0627\\u0642\"})]})]})})}),/*#__PURE__*/_jsx(AnimatePresence,{children:showOrderForm&&isCustomer&&/*#__PURE__*/_jsx(motion.div,{className:\"fixed inset-0 bg-black/80 flex items-center justify-center z-50\",variants:modalVariants,initial:\"hidden\",animate:\"visible\",exit:\"hidden\",onClick:()=>setShowOrderForm(false),children:/*#__PURE__*/_jsxs(motion.div,{className:\"bg-[#242526]/90 backdrop-blur-xl p-8 rounded-3xl shadow-2xl border border-gray-700 w-full max-w-md\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-purple-600 mb-6 text-right\",children:\"\\u0625\\u062F\\u062E\\u0627\\u0644 \\u0627\\u0644\\u0639\\u0646\\u0648\\u0627\\u0646\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0627\\u0644\\u0639\\u0646\\u0648\\u0627\\u0646\",value:orderForm.address,onChange:e=>setOrderForm({address:e.target.value}),className:\"w-full p-4 mb-6 bg-[#3a3b3c]/60 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-500/30\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleOrderSubmit,disabled:isSubmitting,className:\"flex-1 py-3 rounded-xl bg-gradient-to-r from-green-600 to-green-700 text-white font-bold disabled:opacity-70\",children:isSubmitting?'جاري...':'إرسال'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowOrderForm(false),className:\"flex-1 py-3 rounded-xl bg-gradient-to-r from-red-600 to-red-700 text-white font-bold\",children:\"\\u0625\\u0644\\u063A\\u0627\\u0621\"})]})]})})}),/*#__PURE__*/_jsx(AnimatePresence,{children:selectedMedia&&/*#__PURE__*/_jsx(motion.div,{className:\"fixed inset-0 bg-black/90 flex items-center justify-center z-50\",variants:modalVariants,initial:\"hidden\",animate:\"visible\",exit:\"hidden\",onClick:closeMedia,children:/*#__PURE__*/_jsxs(motion.div,{className:\"relative max-w-4xl max-h-screen p-4\",onClick:e=>e.stopPropagation(),children:[selectedMedia.type==='image'?/*#__PURE__*/_jsx(\"img\",{src:selectedMedia.url,alt:\"\",className:\"max-w-full max-h-screen rounded-2xl shadow-2xl\"}):/*#__PURE__*/_jsx(\"video\",{src:selectedMedia.url,controls:true,autoPlay:true,className:\"max-w-full max-h-screen rounded-2xl shadow-2xl\"}),/*#__PURE__*/_jsx(\"button\",{onClick:closeMedia,className:\"absolute top-4 right-4 bg-red-600 text-white w-10 h-10 rounded-full flex items-center justify-center text-xl shadow-lg hover:bg-red-700\",children:\"\\xD7\"})]})})}),/*#__PURE__*/_jsx(AnimatePresence,{children:selectedOrderForMessages&&/*#__PURE__*/_jsx(motion.div,{className:\"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4\",variants:modalVariants,initial:\"hidden\",animate:\"visible\",exit:\"hidden\",onClick:closeMessages,children:/*#__PURE__*/_jsxs(motion.div,{className:\"bg-[#242526] p-6 sm:p-8 rounded-2xl shadow-2xl border border-gray-700 w-full max-w-2xl max-h-[90vh] flex flex-col\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-3xl font-bold mb-6 text-right bg-clip-text text-transparent bg-gradient-to-r from-purple-500 to-purple-700\",children:[\"\\u0627\\u0644\\u0631\\u0633\\u0627\\u0626\\u0644 \\u0644\\u0644\\u0637\\u0644\\u0628 #\",selectedOrderForMessages.orderNumber]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-y-auto mb-6 bg-[#3a3b3c] p-4 rounded-2xl shadow-inner\",children:[selectedOrderForMessages.messages&&selectedOrderForMessages.messages.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:selectedOrderForMessages.messages.map((msg,index)=>{var _selectedOrderForMess,_selectedOrderForMess2,_selectedOrderForMess3;const isMyMessage=msg.from===userRole;const senderName=msg.from==='vendor'?(_selectedOrderForMess=selectedOrderForMessages.product)===null||_selectedOrderForMess===void 0?void 0:(_selectedOrderForMess2=_selectedOrderForMess.vendor)===null||_selectedOrderForMess2===void 0?void 0:_selectedOrderForMess2.name:((_selectedOrderForMess3=selectedOrderForMessages.user)===null||_selectedOrderForMess3===void 0?void 0:_selectedOrderForMess3.name)||'غير معروف';return/*#__PURE__*/_jsx(\"div\",{className:\"flex \".concat(isMyMessage?'justify-end':'justify-start'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-xs sm:max-w-sm p-4 rounded-2xl shadow-md \".concat(isMyMessage?'bg-gradient-to-r from-purple-600 to-purple-800 text-white':'bg-gray-700 text-white'),children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-bold text-sm opacity-90\",children:[msg.from==='vendor'?'التاجر':'العميل',\": \",senderName]}),msg.text&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-lg\",children:msg.text}),msg.image&&/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(process.env.REACT_APP_API_URL,\"/Uploads/\").concat(msg.image),alt:\"\\u0635\\u0648\\u0631\\u0629 \\u0627\\u0644\\u0631\\u0633\\u0627\\u0644\\u0629\",className:\"mt-3 w-full max-w-48 object-cover rounded-xl cursor-pointer shadow-lg hover:shadow-xl transition\",onClick:e=>{e.stopPropagation();openMedia(msg.image,'image');}}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mt-3 text-xs opacity-70\",children:[/*#__PURE__*/_jsx(\"p\",{children:new Date(msg.timestamp).toLocaleString('ar-EG')}),isMyMessage&&/*#__PURE__*/_jsx(\"span\",{children:msg.isRead?'Seen':msg.isDelivered?'Delivered':'Sent'})]})]})},msg._id||index);})}):/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-400 text-lg\",children:\"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u0631\\u0633\\u0627\\u0626\\u0644 \\u0628\\u0639\\u062F.\"}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),(userRole==='vendor'||userRole==='customer')&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSendMessage,className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"\\u0627\\u0643\\u062A\\u0628 \\u0631\\u0633\\u0627\\u0644\\u062A\\u0643 \\u0647\\u0646\\u0627...\",value:newMessage,onChange:e=>setNewMessage(e.target.value),className:\"w-full p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500 text-right resize-none\",rows:\"4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:e=>setNewImage(e.target.files[0]||null),className:\"text-sm text-gray-300 file:mr-4 file:py-3 file:px-6 file:rounded-xl file:border-0 file:bg-purple-600 file:text-white hover:file:bg-purple-700\"}),newImagePreview&&/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:newImagePreview,alt:\"\\u0645\\u0639\\u0627\\u064A\\u0646\\u0629\",className:\"w-24 h-24 object-cover rounded-xl shadow-lg\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setNewImage(null);setNewImagePreview(null);},className:\"absolute top-0 right-0 bg-red-800 text-white rounded-full w-8 h-8 flex items-center justify-center text-xl\",children:\"\\xD7\"})]})]}),/*#__PURE__*/_jsx(motion.button,{type:\"submit\",className:\"w-full py-4 rounded-xl text-white font-bold bg-gradient-to-r from-purple-600 to-purple-800 shadow-xl text-lg\",variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",children:\"\\u0625\\u0631\\u0633\\u0627\\u0644 \\u0627\\u0644\\u0631\\u0633\\u0627\\u0644\\u0629\"})]}),/*#__PURE__*/_jsx(motion.button,{onClick:closeMessages,className:\"w-full mt-4 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-gray-700 to-gray-900 shadow-xl text-lg\",variants:buttonVariants,whileHover:\"hover\",whileTap:\"tap\",children:\"\\u0625\\u063A\\u0644\\u0627\\u0642\"})]})})}),(userRole==='customer'||userRole==='vendor')&&totalUnread>0&&/*#__PURE__*/_jsx(motion.div,{className:\"fixed bottom-6 right-6 z-40 block md:hidden\",initial:{scale:0},animate:{scale:1},transition:{type:\"spring\",stiffness:300},children:/*#__PURE__*/_jsxs(\"button\",{onClick:openMessagesFromFloating,className:\"relative w-16 h-16 bg-gradient-to-r from-purple-600 to-purple-700 rounded-full shadow-2xl flex items-center justify-center text-white hover:from-purple-700 hover:to-purple-800 transition-all\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-8 w-8\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\"})}),totalUnread>0&&/*#__PURE__*/_jsx(\"span\",{className:\"absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold rounded-full w-7 h-7 flex items-center justify-center animate-pulse\",children:totalUnread>99?'99+':totalUnread})]})}),/*#__PURE__*/_jsx(AnimatePresence,{children:showUnreadList&&/*#__PURE__*/_jsx(motion.div,{className:\"fixed inset-0 bg-black/70 z-50 flex items-end justify-center p-4\",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>setShowUnreadList(false),children:/*#__PURE__*/_jsxs(motion.div,{className:\"bg-[#242526] w-full max-w-md rounded-t-3xl shadow-2xl p-6 max-h-[80vh] overflow-y-auto\",initial:{y:100},animate:{y:0},exit:{y:100},onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-purple-400 mb-4 text-center\",children:\"\\u0627\\u0644\\u0631\\u0633\\u0627\\u0626\\u0644 \\u063A\\u064A\\u0631 \\u0627\\u0644\\u0645\\u0642\\u0631\\u0648\\u0621\\u0629\"}),orders.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:orders.map(order=>{var _order$product;return/*#__PURE__*/_jsxs(\"div\",{onClick:()=>openMessages(order),className:\"p-4 bg-gray-800 rounded-xl cursor-pointer hover:bg-gray-700 transition\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-bold text-purple-300\",children:[\"\\u0637\\u0644\\u0628 #\",order.orderNumber]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-300\",children:[\"\\u0627\\u0644\\u0645\\u0646\\u062A\\u062C: \",(_order$product=order.product)===null||_order$product===void 0?void 0:_order$product.name]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-red-400 mt-1\",children:[\"\\u063A\\u064A\\u0631 \\u0645\\u0642\\u0631\\u0648\\u0621: \",order.unreadCount]})]},order._id);})}):/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-400\",children:\"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u0631\\u0633\\u0627\\u0626\\u0644 \\u063A\\u064A\\u0631 \\u0645\\u0642\\u0631\\u0648\\u0621\\u0629\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowUnreadList(false),className:\"w-full mt-6 py-3 bg-red-600 text-white rounded-xl font-bold\",children:\"\\u0625\\u063A\\u0644\\u0627\\u0642\"})]})})})]});};export default VendorProducts;","map":{"version":3,"names":["useState","useEffect","useRef","motion","AnimatePresence","useParams","Link","useNavigate","axios","io","jsx","_jsx","jsxs","_jsxs","VendorProducts","vendorId","products","setProducts","filteredProducts","setFilteredProducts","filterType","setFilterType","priceRange","setPriceRange","min","max","vendorName","setVendorName","cart","setCart","showCartModal","setShowCartModal","showOrderForm","setShowOrderForm","orderForm","setOrderForm","address","selectedMedia","setSelectedMedia","currentMediaIndex","setCurrentMediaIndex","currentMediaType","setCurrentMediaType","showAddedToCart","setShowAddedToCart","error","setError","previousOrders","setPreviousOrders","isSubmitting","setIsSubmitting","intervalRefs","navigate","orders","setOrders","selectedOrderForMessages","setSelectedOrderForMessages","newMessage","setNewMessage","newImage","setNewImage","newImagePreview","setNewImagePreview","showUnreadList","setShowUnreadList","socketRef","currentOrderIdRef","messagesEndRef","showToast","message","type","arguments","length","undefined","setTimeout","reader","FileReader","onloadend","result","readAsDataURL","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","fetchProducts","token","localStorage","getItem","get","concat","process","env","REACT_APP_API_URL","headers","Authorization","then","res","_sorted$","_sorted$$vendor","approved","data","filter","p","sorted","sort","a","b","Date","updatedAt","vendor","name","initialIndexes","reduce","acc","_objectSpread","_id","initialTypes","_p$videos","videos","catch","err","_err$response","_err$response$data","_err$response2","response","status","clear","role","userId","includes","saved","JSON","parse","payload","atob","split","autoConnect","socket","connect","emit","id","on","updatedProduct","prev","exists","some","newList","map","filtered","parseFloat","Infinity","pairPrice","price","quantityPerCarton","_ref","console","log","connected","disconnect","e","fetchUnreadOrders","_err$response3","orderId","post","o","unreadCount","messages","order","handleNewMessage","_prev$messages","m","from","getUserRole","isRead","_ref2","updatedId","off","handleSendMessage","preventDefault","stopPropagation","trim","formData","FormData","append","_err$response4","_err$response4$data","openMessages","closeMessages","userRole","forEach","_p$images","totalImages","images","clearInterval","setInterval","Object","values","setItem","stringify","addToCart","product","_product$videos","imgIndex","selectedImage","find","i","quantity","updateCartQuantity","img","qty","removeFromCart","handleOrderSubmit","confirmSubmit","window","confirm","promises","item","user","Promise","all","_err$response5","_err$response5$data","_err$response6","finally","openMedia","media","url","closeMedia","handlePrevMedia","_p$videos2","_p$images2","total","next","t","_p$videos3","handleNextMedia","_p$videos4","_p$images3","_p$videos5","cardVariants","hidden","opacity","y","scale","visible","transition","duration","ease","hover","boxShadow","buttonVariants","tap","modalVariants","toastVariants","x","exit","isCustomer","totalUnread","cartCount","openMessagesFromFloating","className","children","div","initial","animate","select","value","onChange","target","whileHover","placeholder","button","onClick","variants","whileTap","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","_product$videos2","_product$images","_product$videos3","_product$videos5","_product$images2","whileInView","viewport","once","src","controls","alt","_product$videos4","toFixed","manufacturer","parseInt","disabled","autoPlay","orderNumber","msg","index","_selectedOrderForMess","_selectedOrderForMess2","_selectedOrderForMess3","isMyMessage","senderName","text","image","timestamp","toLocaleString","isDelivered","ref","onSubmit","rows","accept","files","stiffness","_order$product"],"sources":["/root/shose/app-shose/frontend/src/pages/VendorProducts.js"],"sourcesContent":["// frontend/src/pages/VendorProducts.js\nimport { useState, useEffect, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { useParams, Link, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { io } from 'socket.io-client';\n\nconst VendorProducts = () => {\n  const { vendorId } = useParams();\n  const [products, setProducts] = useState([]);\n  const [filteredProducts, setFilteredProducts] = useState([]);\n  const [filterType, setFilterType] = useState('');\n  const [priceRange, setPriceRange] = useState({ min: '', max: '' });\n  const [vendorName, setVendorName] = useState('');\n  const [cart, setCart] = useState([]);\n  const [showCartModal, setShowCartModal] = useState(false);\n  const [showOrderForm, setShowOrderForm] = useState(false);\n  const [orderForm, setOrderForm] = useState({ address: '' });\n  const [selectedMedia, setSelectedMedia] = useState(null);\n  const [currentMediaIndex, setCurrentMediaIndex] = useState({});\n  const [currentMediaType, setCurrentMediaType] = useState({});\n  const [showAddedToCart, setShowAddedToCart] = useState(false);\n  const [error, setError] = useState('');\n  const [previousOrders, setPreviousOrders] = useState([]);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const intervalRefs = useRef({});\n  const navigate = useNavigate();\n\n  // === الرسائل ===\n  const [orders, setOrders] = useState([]);\n  const [selectedOrderForMessages, setSelectedOrderForMessages] = useState(null);\n  const [newMessage, setNewMessage] = useState('');\n  const [newImage, setNewImage] = useState(null);\n  const [newImagePreview, setNewImagePreview] = useState(null);\n  const [showUnreadList, setShowUnreadList] = useState(false);\n  const socketRef = useRef(null);\n  const currentOrderIdRef = useRef(null);\n  const messagesEndRef = useRef(null);\n\n  // === Toast ===\n  const showToast = (message, type = 'success') => {\n    setError(type === 'error' ? message : '');\n    if (type === 'success') {\n      setShowAddedToCart(true);\n      setTimeout(() => setShowAddedToCart(false), 2000);\n    }\n  };\n\n  // === Image preview effect ===\n  useEffect(() => {\n    if (newImage) {\n      const reader = new FileReader();\n      reader.onloadend = () => setNewImagePreview(reader.result);\n      reader.readAsDataURL(newImage);\n    } else {\n      setNewImagePreview(null);\n    }\n  }, [newImage]);\n\n  // === Scroll to bottom ===\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  // === دالة جلب المنتجات (تُستخدم في كل الحالات) ===\n  const fetchProducts = () => {\n    const token = localStorage.getItem('token');\n    if (!token) return;\n\n    axios\n      .get(`${process.env.REACT_APP_API_URL}/api/products/vendor/${vendorId}`, {\n        headers: { Authorization: `Bearer ${token}` },\n      })\n      .then(res => {\n        const approved = res.data.filter(p => p.approved);\n\n        // ترتيب حسب updatedAt تنازليًا\n        const sorted = [...approved].sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt));\n\n        setProducts(sorted);\n        setFilteredProducts(sorted);\n        setVendorName(sorted[0]?.vendor?.name || 'تاجر غير معروف');\n\n        const initialIndexes = sorted.reduce((acc, p) => ({ ...acc, [p._id]: 0 }), {});\n        const initialTypes = sorted.reduce((acc, p) => ({\n          ...acc,\n          [p._id]: p.videos?.length > 0 ? 'video' : 'image'\n        }), {});\n        setCurrentMediaIndex(initialIndexes);\n        setCurrentMediaType(initialTypes);\n        setError('');\n      })\n      .catch(err => {\n        showToast(err.response?.data?.message || 'خطأ في جلب المنتجات', 'error');\n        if (err.response?.status === 401) {\n          localStorage.clear();\n          navigate('/login');\n        }\n      });\n  };\n\n  // === جلب المنتجات + التحقق من الـ Token ===\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    const role = localStorage.getItem('role');\n    const userId = localStorage.getItem('userId');\n\n    if (!token || !['admin', 'vendor', 'customer'].includes(role)) {\n      showToast('غير مصرح', 'error');\n      navigate('/login');\n      return;\n    }\n\n    fetchProducts();\n\n    if (role === 'customer') {\n      const saved = localStorage.getItem('cart');\n      if (saved) setCart(JSON.parse(saved));\n    }\n\n    if (role === 'customer' && userId) {\n      axios\n        .get(`${process.env.REACT_APP_API_URL}/api/orders/user/${userId}`, {\n          headers: { Authorization: `Bearer ${token}` },\n        })\n        .then(res => setPreviousOrders(res.data))\n        .catch(() => {});\n    }\n  }, [vendorId, navigate]);\n\n  // === Socket.IO connection & product updates ===\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (!token) return;\n\n    try {\n      const payload = JSON.parse(atob(token.split('.')[1]));\n      socketRef.current = io(process.env.REACT_APP_API_URL, { autoConnect: false });\n      const socket = socketRef.current;\n      socket.connect();\n      socket.emit('authenticate', { userId: payload.id, role: payload.role });\n\n      socket.on('productUpdated', (updatedProduct) => {\n        if (updatedProduct.vendor._id !== vendorId && updatedProduct.vendor !== vendorId) return;\n\n        setProducts(prev => {\n          const exists = prev.some(p => p._id === updatedProduct._id);\n          const newList = exists\n            ? prev.map(p => (p._id === updatedProduct._id ? updatedProduct : p))\n            : [updatedProduct, ...prev.filter(p => p._id !== updatedProduct._id)];\n          return newList.sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt));\n        });\n\n        setFilteredProducts(prev => {\n          const exists = prev.some(p => p._id === updatedProduct._id);\n          const newList = exists\n            ? prev.map(p => (p._id === updatedProduct._id ? updatedProduct : p))\n            : [updatedProduct, ...prev.filter(p => p._id !== updatedProduct._id)];\n\n          let filtered = newList.filter(p => p.approved && (p.vendor._id === vendorId || p.vendor === vendorId));\n\n          if (filterType) {\n            filtered = filtered.filter(p => p.type === filterType);\n          }\n          if (priceRange.min || priceRange.max) {\n            const min = parseFloat(priceRange.min) || 0;\n            const max = parseFloat(priceRange.max) || Infinity;\n            filtered = filtered.filter(p => {\n              const pairPrice = p.price / p.quantityPerCarton;\n              return pairPrice >= min && pairPrice <= max;\n            });\n          }\n          return filtered.sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt));\n        });\n      });\n\n      socket.on('productDeleted', ({ _id }) => {\n        setProducts(prev => prev.filter(p => p._id !== _id));\n        setFilteredProducts(prev => prev.filter(p => p._id !== _id));\n      });\n\n      socket.on('connect', () => {\n        console.log('Socket reconnected in VendorProducts');\n        fetchProducts();\n        if (currentOrderIdRef.current) {\n          socket.emit('joinOrder', currentOrderIdRef.current);\n        }\n      });\n\n      socket.on('error', (err) => {\n        showToast(`خطأ في الاتصال: ${err.message || 'غير معروف'}`, 'error');\n      });\n\n      return () => {\n        if (socket.connected) socket.disconnect();\n      };\n    } catch (e) {\n      showToast('خطأ في التوثيق', 'error');\n      localStorage.clear();\n      navigate('/login');\n    }\n  }, [navigate, vendorId, filterType, priceRange]);\n\n  // === Fetch unread messages ===\n  const fetchUnreadOrders = () => {\n    const token = localStorage.getItem('token');\n    if (!token) return;\n    axios\n      .get(`${process.env.REACT_APP_API_URL}/api/orders?unreadOnly=true`, {\n        headers: { Authorization: `Bearer ${token}` },\n      })\n      .then(res => setOrders(res.data.orders || []))\n      .catch(err => {\n        if (err.response?.status === 401) {\n          localStorage.clear();\n          navigate('/login');\n        }\n      });\n  };\n\n  useEffect(() => {\n    fetchUnreadOrders();\n  }, []);\n\n  // === Messages socket handling ===\n  useEffect(() => {\n    if (!selectedOrderForMessages || !socketRef.current) {\n      if (currentOrderIdRef.current && socketRef.current) {\n        socketRef.current.emit('leaveOrder', currentOrderIdRef.current);\n        currentOrderIdRef.current = null;\n      }\n      return;\n    }\n\n    const orderId = selectedOrderForMessages._id;\n    currentOrderIdRef.current = orderId;\n    socketRef.current.emit('joinOrder', orderId);\n\n    const token = localStorage.getItem('token');\n    axios\n      .post(\n        `${process.env.REACT_APP_API_URL}/api/orders/${orderId}/markRead`,\n        {},\n        { headers: { Authorization: `Bearer ${token}` } }\n      )\n      .then(res => {\n        setOrders(prev => prev.map(o => (o._id === orderId ? { ...o, unreadCount: 0 } : o)));\n        setSelectedOrderForMessages(prev => ({\n          ...prev,\n          messages: res.data.order.messages || [],\n          unreadCount: 0,\n        }));\n      })\n      .catch(() => {});\n\n    const handleNewMessage = (message) => {\n      if (message.orderId !== orderId) return;\n      setSelectedOrderForMessages(prev => {\n        const exists = prev.messages?.some(m => m._id === message._id);\n        if (exists) return prev;\n        return { ...prev, messages: [...(prev.messages || []), message] };\n      });\n      if (message.from !== getUserRole()) {\n        setOrders(prev => prev.map(o =>\n          o._id === orderId ? { ...o, unreadCount: (o.unreadCount || 0) + 1 } : o\n        ));\n      }\n    };\n\n    const socket = socketRef.current;\n    socket.on('newMessage', handleNewMessage);\n    socket.on('messagesUpdated', (data) => {\n      if (data.orderId !== orderId) return;\n      setSelectedOrderForMessages(prev => ({\n        ...prev,\n        messages: data.messages || [],\n        unreadCount: data.messages.filter(m => !m.isRead && m.from !== getUserRole()).length,\n      }));\n    });\n    socket.on('unreadUpdate', ({ orderId: updatedId, unreadCount }) => {\n      setOrders(prev => prev.map(o => (o._id === updatedId ? { ...o, unreadCount } : o)));\n      if (updatedId === orderId) {\n        setSelectedOrderForMessages(prev => ({ ...prev, unreadCount }));\n      }\n    });\n\n    return () => {\n      socket.off('newMessage', handleNewMessage);\n      socket.emit('leaveOrder', orderId);\n      currentOrderIdRef.current = null;\n    };\n  }, [selectedOrderForMessages]);\n\n  // === Send message ===\n  const handleSendMessage = async (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const token = localStorage.getItem('token');\n    if (!token || (!newMessage.trim() && !newImage)) {\n      showToast('يجب إدخال رسالة أو رفع صورة', 'error');\n      return;\n    }\n    const formData = new FormData();\n    if (newMessage.trim()) formData.append('text', newMessage.trim());\n    if (newImage) formData.append('image', newImage);\n    try {\n      const res = await axios.post(\n        `${process.env.REACT_APP_API_URL}/api/orders/${selectedOrderForMessages._id}/message`,\n        formData,\n        { headers: { Authorization: `Bearer ${token}`, 'Content-Type': 'multipart/form-data' } }\n      );\n      setSelectedOrderForMessages(prev => ({ ...prev, messages: res.data.order.messages || [] }));\n      setNewMessage('');\n      setNewImage(null);\n      setNewImagePreview(null);\n      scrollToBottom();\n    } catch (err) {\n      showToast(err.response?.data?.message || 'خطأ في إرسال الرسالة', 'error');\n    }\n  };\n\n  const openMessages = (order) => {\n    setSelectedOrderForMessages(order);\n    setShowUnreadList(false);\n  };\n  const closeMessages = () => {\n    setSelectedOrderForMessages(null);\n    setNewMessage('');\n    setNewImage(null);\n    setNewImagePreview(null);\n  };\n\n  const getUserRole = () => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      try {\n        const payload = JSON.parse(atob(token.split('.')[1]));\n        return payload.role || 'user';\n      } catch (e) {\n        localStorage.clear();\n        navigate('/login');\n        return 'user';\n      }\n    }\n    return 'user';\n  };\n  const userRole = getUserRole();\n\n  // === تصفية المنتجات ===\n  useEffect(() => {\n    let filtered = products.filter(p => p.vendor._id === vendorId || p.vendor === vendorId);\n    if (filterType) {\n      filtered = filtered.filter(p => p.type === filterType);\n    }\n    if (priceRange.min || priceRange.max) {\n      const min = parseFloat(priceRange.min) || 0;\n      const max = parseFloat(priceRange.max) || Infinity;\n      filtered = filtered.filter(p => {\n        const pairPrice = p.price / p.quantityPerCarton;\n        return pairPrice >= min && pairPrice <= max;\n      });\n    }\n    setFilteredProducts(filtered.sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt)));\n  }, [filterType, priceRange, products, vendorId]);\n\n  // === تدوير الصور تلقائيًا ===\n  useEffect(() => {\n    products.forEach(p => {\n      const totalImages = p.images?.length || 0;\n      if (totalImages > 1 && (!p.videos || p.videos.length === 0)) {\n        clearInterval(intervalRefs.current[p._id]);\n        intervalRefs.current[p._id] = setInterval(() => {\n          setCurrentMediaIndex(prev => ({\n            ...prev,\n            [p._id]: (prev[p._id] + 1) % totalImages\n          }));\n          setCurrentMediaType(prev => ({ ...prev, [p._id]: 'image' }));\n        }, 3000);\n      }\n    });\n    return () => Object.values(intervalRefs.current).forEach(clearInterval);\n  }, [products]);\n\n  // === حفظ السلة ===\n  useEffect(() => {\n    if (localStorage.getItem('role') === 'customer') {\n      localStorage.setItem('cart', JSON.stringify(cart));\n    }\n  }, [cart]);\n\n  const addToCart = (product) => {\n    const type = currentMediaType[product._id] || 'image';\n    if (type === 'video') {\n      showToast('يرجى اختيار صورة', 'error');\n      return;\n    }\n    const imgIndex = (currentMediaIndex[product._id] || 0) - (product.videos?.length || 0);\n    const selectedImage = product.images[imgIndex] || 'placeholder-image.jpg';\n    setCart(prev => {\n      const exists = prev.find(i => i.product._id === product._id && i.selectedImage === selectedImage);\n      if (exists) {\n        return prev.map(i =>\n          i.product._id === product._id && i.selectedImage === selectedImage\n            ? { ...i, quantity: i.quantity + 1 }\n            : i\n        );\n      }\n      return [...prev, { product, quantity: 1, selectedImage }];\n    });\n    showToast('تمت الإضافة إلى السلة');\n  };\n\n  const updateCartQuantity = (id, img, qty) => {\n    if (qty < 1) return;\n    setCart(prev => prev.map(i => i.product._id === id && i.selectedImage === img ? { ...i, quantity: qty } : i));\n  };\n\n  const removeFromCart = (id, img) => {\n    setCart(prev => prev.filter(i => !(i.product._id === id && i.selectedImage === img)));\n  };\n\n  const handleOrderSubmit = () => {\n    if (isSubmitting || !orderForm.address) return;\n    const token = localStorage.getItem('token');\n    const userId = localStorage.getItem('userId');\n    if (!token || !userId) return navigate('/login');\n\n    let confirmSubmit = true;\n    if (previousOrders.length > 0) {\n      confirmSubmit = window.confirm('أنت طلبت الطلب مرة، هل تريد تأكيد طلبه مرة أخرى؟');\n    }\n    if (!confirmSubmit) return;\n\n    setIsSubmitting(true);\n    const promises = cart.map(item =>\n      axios.post(\n        `${process.env.REACT_APP_API_URL}/api/orders`,\n        {\n          product: item.product._id,\n          vendor: item.product.vendor._id || item.product.vendor,\n          quantity: item.quantity,\n          user: userId,\n          address: orderForm.address,\n          selectedImage: item.selectedImage\n        },\n        { headers: { Authorization: `Bearer ${token}` } }\n      )\n    );\n\n    Promise.all(promises)\n      .then(() => {\n        showToast('تم إنشاء الطلبات بنجاح');\n        setCart([]);\n        setShowOrderForm(false);\n        setOrderForm({ address: '' });\n        axios.get(`${process.env.REACT_APP_API_URL}/api/orders/user/${userId}`, {\n          headers: { Authorization: `Bearer ${token}` }\n        }).then(res => setPreviousOrders(res.data));\n      })\n      .catch(err => {\n        showToast(err.response?.data?.message || 'خطأ في تقديم الطلب', 'error');\n        if (err.response?.status === 401) {\n          localStorage.clear();\n          navigate('/login');\n        }\n      })\n      .finally(() => setIsSubmitting(false));\n  };\n\n  const openMedia = (media, type) => {\n    setSelectedMedia({ url: `${process.env.REACT_APP_API_URL}/Uploads/${media}`, type });\n  };\n  const closeMedia = () => setSelectedMedia(null);\n\n  const handlePrevMedia = (id, p) => {\n    const total = (p.videos?.length || 0) + (p.images?.length || 0);\n    setCurrentMediaIndex(prev => {\n      const next = (prev[id] - 1 + total) % total;\n      setCurrentMediaType(t => ({ ...t, [id]: next < (p.videos?.length || 0) ? 'video' : 'image' }));\n      return { ...prev, [id]: next };\n    });\n    clearInterval(intervalRefs.current[id]);\n  };\n\n  const handleNextMedia = (id, p) => {\n    const total = (p.videos?.length || 0) + (p.images?.length || 0);\n    setCurrentMediaIndex(prev => {\n      const next = (prev[id] + 1) % total;\n      setCurrentMediaType(t => ({ ...t, [id]: next < (p.videos?.length || 0) ? 'video' : 'image' }));\n      return { ...prev, [id]: next };\n    });\n    clearInterval(intervalRefs.current[id]);\n  };\n\n  // === الأنيميشن ===\n  const cardVariants = {\n    hidden: { opacity: 0, y: 30, scale: 0.95 },\n    visible: { opacity: 1, y: 0, scale: 1, transition: { duration: 0.7, ease: [0.22, 1, 0.36, 1] } },\n    hover: { scale: 1.03, boxShadow: '0 12px 24px rgba(0, 0, 0, 0.2)' }\n  };\n  const buttonVariants = { hover: { scale: 1.05 }, tap: { scale: 0.95 } };\n  const modalVariants = { hidden: { opacity: 0, scale: 0.85 }, visible: { opacity: 1, scale: 1 } };\n  const toastVariants = { hidden: { opacity: 0, x: 50 }, visible: { opacity: 1, x: 0 }, exit: { opacity: 0, x: 50 } };\n\n  const role = localStorage.getItem('role');\n  const isCustomer = role === 'customer';\n  const totalUnread = orders.reduce((acc, o) => acc + (o.unreadCount || 0), 0);\n  const cartCount = cart.reduce((a, i) => a + i.quantity, 0);\n\n  const openMessagesFromFloating = () => {\n    if (orders.length === 1) {\n      openMessages(orders[0]);\n    } else {\n      setShowUnreadList(true);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-[#18191a] text-white p-4 relative overflow-hidden\">\n      {/* خلفية موف ناعمة */}\n      <div className=\"absolute inset-0 opacity-10\">\n        <div className=\"absolute top-0 left-0 w-96 h-96 bg-purple-900 rounded-full blur-3xl animate-pulse\" />\n        <div className=\"absolute bottom-0 right-0 w-80 h-80 bg-purple-800 rounded-full blur-3xl animate-pulse delay-700\" />\n      </div>\n\n      <div className=\"relative z-10 w-full max-w-7xl mx-auto\">\n        {/* === العنوان === */}\n        <motion.div\n          className=\"flex flex-col items-center mb-8\"\n          initial={{ opacity: 0, y: -30 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.8 }}\n        >\n          <h1 className=\"text-3xl md:text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-purple-600\">\n            منتجات التاجر: {vendorName}\n          </h1>\n          <p className=\"text-purple-300 text-lg mt-1\">المنتجات المتاحة</p>\n        </motion.div>\n\n        {/* === الفلتر + السلة === */}\n        <div className=\"flex flex-col sm:flex-row justify-between items-center mb-8 gap-4\">\n          <motion.select\n            value={filterType}\n            onChange={e => setFilterType(e.target.value)}\n            className=\"p-3 rounded-xl bg-[#3a3b3c]/60 backdrop-blur-md border border-gray-600 text-white focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-500/30\"\n            whileHover={{ scale: 1.03 }}\n          >\n            <option value=\"\">الكل</option>\n            <option value=\"رجالي\">رجالي</option>\n            <option value=\"حريمي\">حريمي</option>\n            <option value=\"أطفال\">أطفال</option>\n          </motion.select>\n\n          <div className=\"flex items-center gap-2\">\n            <input\n              type=\"number\"\n              placeholder=\"من (جوز)\"\n              value={priceRange.min}\n              onChange={e => setPriceRange(prev => ({ ...prev, min: e.target.value }))}\n              className=\"p-3 w-24 rounded-xl bg-[#3a3b3c]/60 border border-gray-600 text-white placeholder:text-gray-400 focus:outline-none focus:border-purple-500\"\n            />\n            <span className=\"text-gray-400\">إلى</span>\n            <input\n              type=\"number\"\n              placeholder=\"إلى (جوز)\"\n              value={priceRange.max}\n              onChange={e => setPriceRange(prev => ({ ...prev, max: e.target.value }))}\n              className=\"p-3 w-24 rounded-xl bg-[#3a3b3c]/60 border border-gray-600 text-white placeholder:text-gray-400 focus:outline-none focus:border-purple-500\"\n            />\n          </div>\n\n          {isCustomer && (\n            <motion.button\n              onClick={() => setShowCartModal(true)}\n              className=\"relative px-4 py-3 rounded-xl bg-gradient-to-r from-purple-600 to-purple-700 shadow-lg hover:from-purple-700 hover:to-purple-800 flex items-center gap-2\"\n              variants={buttonVariants}\n              whileHover=\"hover\"\n              whileTap=\"tap\"\n            >\n              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z\" />\n              </svg>\n              {cartCount > 0 && (\n                <span className=\"absolute -top-2 -right-2 bg-purple-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center\">\n                  {cartCount}\n                </span>\n              )}\n            </motion.button>\n          )}\n        </div>\n\n        {/* === المنتجات === */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n          {filteredProducts.length === 0 ? (\n            <p className=\"col-span-full text-center text-gray-400 text-xl\">لا توجد منتجات...</p>\n          ) : (\n            filteredProducts.map(product => (\n              <motion.div\n                key={product._id}\n                className=\"bg-[#242526]/80 backdrop-blur-xl rounded-2xl shadow-2xl border border-gray-700/50 overflow-hidden\"\n                variants={cardVariants}\n                initial=\"hidden\"\n                whileInView=\"visible\"\n                viewport={{ once: true }}\n                whileHover=\"hover\"\n              >\n                <div className=\"relative aspect-square bg-[#3a3b3c]\">\n                  {currentMediaType[product._id] === 'video' && product.videos?.length > 0 ? (\n                    <video\n                      src={`${process.env.REACT_APP_API_URL}/Uploads/${product.videos[currentMediaIndex[product._id]]}`}\n                      controls\n                      className=\"w-full h-full object-contain\"\n                      onClick={() => openMedia(product.videos[currentMediaIndex[product._id]], 'video')}\n                    />\n                  ) : product.images?.length > 0 ? (\n                    <img\n                      src={`${process.env.REACT_APP_API_URL}/Uploads/${product.images[(currentMediaIndex[product._id] || 0) - (product.videos?.length || 0)]}`}\n                      alt={product.name}\n                      className=\"w-full h-full object-contain\"\n                      onClick={() => openMedia(product.images[(currentMediaIndex[product._id] || 0) - (product.videos?.length || 0)], 'image')}\n                    />\n                  ) : (\n                    <div className=\"w-full h-full bg-[#3a3b3c] flex items-center justify-center\">\n                      <span className=\"text-gray-500\">بدون صورة</span>\n                    </div>\n                  )}\n                  {(product.videos?.length || 0) + (product.images?.length || 0) > 1 && (\n                    <div className=\"absolute bottom-3 left-1/2 transform -translate-x-1/2 flex gap-3\">\n                      <button onClick={() => handlePrevMedia(product._id, product)} className=\"bg-black/50 text-white p-2 rounded-full backdrop-blur-sm hover:bg-black/70 transition\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\n                        </svg>\n                      </button>\n                      <button onClick={() => handleNextMedia(product._id, product)} className=\"bg-black/50 text-white p-2 rounded-full backdrop-blur-sm hover:bg-black/70 transition\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n                        </svg>\n                      </button>\n                    </div>\n                  )}\n                </div>\n                <div className=\"p-5 space-y-2 text-right\">\n                  <h2 className=\"text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-purple-600\">\n                    {product.name}\n                  </h2>\n                  <div className=\"text-sm text-gray-300 space-y-1\">\n                    <p>النوع: {product.type}</p>\n                    <p>سعر الكرتونة: {product.price} جنيه</p>\n                    <p>سعر الجوز: {(product.price / product.quantityPerCarton).toFixed(2)} جنيه</p>\n                    <p>الكرتونة: {product.quantityPerCarton} جوز</p>\n                    <p>المصنع: {product.manufacturer}</p>\n                  </div>\n                  {isCustomer && (\n                    <motion.button\n                      onClick={() => addToCart(product)}\n                      className=\"w-full mt-4 py-3 rounded-xl text-white font-bold bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 shadow-lg\"\n                      variants={buttonVariants}\n                      whileHover=\"hover\"\n                      whileTap=\"tap\"\n                    >\n                      إضافة إلى السلة\n                    </motion.button>\n                  )}\n                </div>\n              </motion.div>\n            ))\n          )}\n        </div>\n      </div>\n\n      {/* === Toast === */}\n      <AnimatePresence>\n        {showAddedToCart && (\n          <motion.div\n            className=\"fixed top-6 right-6 bg-green-600 text-white px-5 py-3 rounded-full shadow-xl flex items-center gap-2 z-50\"\n            variants={toastVariants}\n            initial=\"hidden\"\n            animate=\"visible\"\n            exit=\"hidden\"\n          >\n            <span>تمت الإضافة</span>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* === مودال السلة === */}\n      <AnimatePresence>\n        {showCartModal && isCustomer && (\n          <motion.div className=\"fixed inset-0 bg-black/80 flex items-center justify-center z-50\" variants={modalVariants} initial=\"hidden\" animate=\"visible\" exit=\"hidden\" onClick={() => setShowCartModal(false)}>\n            <motion.div className=\"bg-[#242526]/90 backdrop-blur-xl p-8 rounded-3xl shadow-2xl border border-gray-700 w-full max-w-lg\" onClick={e => e.stopPropagation()}>\n              <h2 className=\"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-purple-600 mb-6 text-right\">السلة</h2>\n              {cart.length === 0 ? <p className=\"text-center text-gray-400\">السلة فارغة</p> : (\n                <div className=\"space-y-4 max-h-96 overflow-y-auto\">\n                  {cart.map(item => (\n                    <div key={`${item.product._id}-${item.selectedImage}`} className=\"flex items-center justify-between gap-4 p-3 bg-[#3a3b3c]/50 rounded-xl\">\n                      <img src={`${process.env.REACT_APP_API_URL}/Uploads/${item.selectedImage}`} alt=\"\" className=\"w-16 h-16 object-cover rounded-lg\" />\n                      <div className=\"text-right flex-1\">\n                        <p className=\"font-semibold\">{item.product.name}</p>\n                        <p className=\"text-sm text-gray-400\">سعر الكرتونة: {item.product.price} جنيه</p>\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <input type=\"number\" min=\"1\" value={item.quantity} onChange={e => updateCartQuantity(item.product._id, item.selectedImage, parseInt(e.target.value))} className=\"w-16 p-2 bg-[#3a3b3c] rounded text-center\" />\n                        <button onClick={() => removeFromCart(item.product._id, item.selectedImage)} className=\"text-red-400 hover:text-red-300\">×</button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n              {cart.length > 0 && (\n                <div className=\"flex gap-3 mt-6\">\n                  <button onClick={() => { setShowCartModal(false); setShowOrderForm(true); }} className=\"flex-1 py-3 rounded-xl bg-gradient-to-r from-green-600 to-green-700 text-white font-bold\">طلب</button>\n                  <button onClick={() => setShowCartModal(false)} className=\"flex-1 py-3 rounded-xl bg-gradient-to-r from-red-600 to-red-700 text-white font-bold\">إغلاق</button>\n                </div>\n              )}\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* === مودال الطلب === */}\n      <AnimatePresence>\n        {showOrderForm && isCustomer && (\n          <motion.div className=\"fixed inset-0 bg-black/80 flex items-center justify-center z-50\" variants={modalVariants} initial=\"hidden\" animate=\"visible\" exit=\"hidden\" onClick={() => setShowOrderForm(false)}>\n            <motion.div className=\"bg-[#242526]/90 backdrop-blur-xl p-8 rounded-3xl shadow-2xl border border-gray-700 w-full max-w-md\" onClick={e => e.stopPropagation()}>\n              <h2 className=\"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-purple-600 mb-6 text-right\">إدخال العنوان</h2>\n              <input type=\"text\" placeholder=\"العنوان\" value={orderForm.address} onChange={e => setOrderForm({ address: e.target.value })} className=\"w-full p-4 mb-6 bg-[#3a3b3c]/60 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-500/30\" />\n              <div className=\"flex gap-3\">\n                <button onClick={handleOrderSubmit} disabled={isSubmitting} className=\"flex-1 py-3 rounded-xl bg-gradient-to-r from-green-600 to-green-700 text-white font-bold disabled:opacity-70\">\n                  {isSubmitting ? 'جاري...' : 'إرسال'}\n                </button>\n                <button onClick={() => setShowOrderForm(false)} className=\"flex-1 py-3 rounded-xl bg-gradient-to-r from-red-600 to-red-700 text-white font-bold\">إلغاء</button>\n              </div>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* === مودال الوسائط === */}\n      <AnimatePresence>\n        {selectedMedia && (\n          <motion.div className=\"fixed inset-0 bg-black/90 flex items-center justify-center z-50\" variants={modalVariants} initial=\"hidden\" animate=\"visible\" exit=\"hidden\" onClick={closeMedia}>\n            <motion.div className=\"relative max-w-4xl max-h-screen p-4\" onClick={e => e.stopPropagation()}>\n              {selectedMedia.type === 'image' ? (\n                <img src={selectedMedia.url} alt=\"\" className=\"max-w-full max-h-screen rounded-2xl shadow-2xl\" />\n              ) : (\n                <video src={selectedMedia.url} controls autoPlay className=\"max-w-full max-h-screen rounded-2xl shadow-2xl\" />\n              )}\n              <button onClick={closeMedia} className=\"absolute top-4 right-4 bg-red-600 text-white w-10 h-10 rounded-full flex items-center justify-center text-xl shadow-lg hover:bg-red-700\">×</button>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* === مودال الرسائل === */}\n      <AnimatePresence>\n        {selectedOrderForMessages && (\n          <motion.div\n            className=\"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4\"\n            variants={modalVariants}\n            initial=\"hidden\"\n            animate=\"visible\"\n            exit=\"hidden\"\n            onClick={closeMessages}\n          >\n            <motion.div\n              className=\"bg-[#242526] p-6 sm:p-8 rounded-2xl shadow-2xl border border-gray-700 w-full max-w-2xl max-h-[90vh] flex flex-col\"\n              onClick={(e) => e.stopPropagation()}\n            >\n              <h2 className=\"text-3xl font-bold mb-6 text-right bg-clip-text text-transparent bg-gradient-to-r from-purple-500 to-purple-700\">\n                الرسائل للطلب #{selectedOrderForMessages.orderNumber}\n              </h2>\n              <div className=\"flex-1 overflow-y-auto mb-6 bg-[#3a3b3c] p-4 rounded-2xl shadow-inner\">\n                {selectedOrderForMessages.messages && selectedOrderForMessages.messages.length > 0 ? (\n                  <div className=\"space-y-4\">\n                    {selectedOrderForMessages.messages.map((msg, index) => {\n                      const isMyMessage = msg.from === userRole;\n                      const senderName = msg.from === 'vendor' ? selectedOrderForMessages.product?.vendor?.name : selectedOrderForMessages.user?.name || 'غير معروف';\n                      return (\n                        <div key={msg._id || index} className={`flex ${isMyMessage ? 'justify-end' : 'justify-start'}`}>\n                          <div className={`max-w-xs sm:max-w-sm p-4 rounded-2xl shadow-md ${isMyMessage ? 'bg-gradient-to-r from-purple-600 to-purple-800 text-white' : 'bg-gray-700 text-white'}`}>\n                            <p className=\"font-bold text-sm opacity-90\">\n                              {msg.from === 'vendor' ? 'التاجر' : 'العميل'}: {senderName}\n                            </p>\n                            {msg.text && <p className=\"mt-2 text-lg\">{msg.text}</p>}\n                            {msg.image && (\n                              <img\n                                src={`${process.env.REACT_APP_API_URL}/Uploads/${msg.image}`}\n                                alt=\"صورة الرسالة\"\n                                className=\"mt-3 w-full max-w-48 object-cover rounded-xl cursor-pointer shadow-lg hover:shadow-xl transition\"\n                                onClick={(e) => { e.stopPropagation(); openMedia(msg.image, 'image'); }}\n                              />\n                            )}\n                            <div className=\"flex items-center justify-between mt-3 text-xs opacity-70\">\n                              <p>{new Date(msg.timestamp).toLocaleString('ar-EG')}</p>\n                              {isMyMessage && (\n                                <span>{msg.isRead ? 'Seen' : msg.isDelivered ? 'Delivered' : 'Sent'}</span>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                ) : (\n                  <p className=\"text-center text-gray-400 text-lg\">لا توجد رسائل بعد.</p>\n                )}\n                <div ref={messagesEndRef} />\n              </div>\n              {(userRole === 'vendor' || userRole === 'customer') && (\n                <form onSubmit={handleSendMessage} className=\"space-y-4\">\n                  <textarea\n                    placeholder=\"اكتب رسالتك هنا...\"\n                    value={newMessage}\n                    onChange={(e) => setNewMessage(e.target.value)}\n                    className=\"w-full p-4 rounded-xl bg-[#3a3b3c] text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500 text-right resize-none\"\n                    rows=\"4\"\n                  />\n                  <div className=\"flex items-center gap-4\">\n                    <input\n                      type=\"file\"\n                      accept=\"image/*\"\n                      onChange={(e) => setNewImage(e.target.files[0] || null)}\n                      className=\"text-sm text-gray-300 file:mr-4 file:py-3 file:px-6 file:rounded-xl file:border-0 file:bg-purple-600 file:text-white hover:file:bg-purple-700\"\n                    />\n                    {newImagePreview && (\n                      <div className=\"relative\">\n                        <img src={newImagePreview} alt=\"معاينة\" className=\"w-24 h-24 object-cover rounded-xl shadow-lg\" />\n                        <button\n                          type=\"button\"\n                          onClick={() => { setNewImage(null); setNewImagePreview(null); }}\n                          className=\"absolute top-0 right-0 bg-red-800 text-white rounded-full w-8 h-8 flex items-center justify-center text-xl\"\n                        >\n                          ×\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                  <motion.button\n                    type=\"submit\"\n                    className=\"w-full py-4 rounded-xl text-white font-bold bg-gradient-to-r from-purple-600 to-purple-800 shadow-xl text-lg\"\n                    variants={buttonVariants}\n                    whileHover=\"hover\"\n                    whileTap=\"tap\"\n                  >\n                    إرسال الرسالة\n                  </motion.button>\n                </form>\n              )}\n              <motion.button\n                onClick={closeMessages}\n                className=\"w-full mt-4 py-4 rounded-xl text-white font-bold bg-gradient-to-r from-gray-700 to-gray-900 shadow-xl text-lg\"\n                variants={buttonVariants}\n                whileHover=\"hover\"\n                whileTap=\"tap\"\n              >\n                إغلاق\n              </motion.button>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* === زر الرسائل الثابت === */}\n      {(userRole === 'customer' || userRole === 'vendor') && totalUnread > 0 && (\n        <motion.div className=\"fixed bottom-6 right-6 z-40 block md:hidden\" initial={{ scale: 0 }} animate={{ scale: 1 }} transition={{ type: \"spring\", stiffness: 300 }}>\n          <button onClick={openMessagesFromFloating} className=\"relative w-16 h-16 bg-gradient-to-r from-purple-600 to-purple-700 rounded-full shadow-2xl flex items-center justify-center text-white hover:from-purple-700 hover:to-purple-800 transition-all\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-8 w-8\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\n            </svg>\n            {totalUnread > 0 && (\n              <span className=\"absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold rounded-full w-7 h-7 flex items-center justify-center animate-pulse\">\n                {totalUnread > 99 ? '99+' : totalUnread}\n              </span>\n            )}\n          </button>\n        </motion.div>\n      )}\n\n      {/* === قائمة الطلبات غير المقروءة === */}\n      <AnimatePresence>\n        {showUnreadList && (\n          <motion.div className=\"fixed inset-0 bg-black/70 z-50 flex items-end justify-center p-4\" initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} onClick={() => setShowUnreadList(false)}>\n            <motion.div className=\"bg-[#242526] w-full max-w-md rounded-t-3xl shadow-2xl p-6 max-h-[80vh] overflow-y-auto\" initial={{ y: 100 }} animate={{ y: 0 }} exit={{ y: 100 }} onClick={e => e.stopPropagation()}>\n              <h3 className=\"text-xl font-bold text-purple-400 mb-4 text-center\">الرسائل غير المقروءة</h3>\n              {orders.length > 0 ? (\n                <div className=\"space-y-3\">\n                  {orders.map(order => (\n                    <div key={order._id} onClick={() => openMessages(order)} className=\"p-4 bg-gray-800 rounded-xl cursor-pointer hover:bg-gray-700 transition\">\n                      <p className=\"font-bold text-purple-300\">طلب #{order.orderNumber}</p>\n                      <p className=\"text-sm text-gray-300\">المنتج: {order.product?.name}</p>\n                      <p className=\"text-xs text-red-400 mt-1\">غير مقروء: {order.unreadCount}</p>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <p className=\"text-center text-gray-400\">لا توجد رسائل غير مقروءة</p>\n              )}\n              <button onClick={() => setShowUnreadList(false)} className=\"w-full mt-6 py-3 bg-red-600 text-white rounded-xl font-bold\">\n                إغلاق\n              </button>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n};\n\nexport default VendorProducts;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}